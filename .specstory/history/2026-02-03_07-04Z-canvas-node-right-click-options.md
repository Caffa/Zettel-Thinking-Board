<!-- Generated by SpecStory, Markdown v2.1.0 -->

<!-- cursor Session 11f78eaf-14bc-4cc9-96bb-d1238f42bd03 (2026-02-03 07:04Z) -->

# Canvas node right-click options (2026-02-03 07:04Z)

_**User**_

Focus on the simplest debugging. Right now, when I have my canvas open and I right-click on the node, I do not see any of the options that we wanted to add to the node.

I have given you an image of my test canvas setup and the Blue Note should be able to run a Python file. I should be able to right-click on the orange note, to get the option to run the entire chain but it does not have our options.

Find a way to test if we can even affect the canvas right now 


---

_**Agent (model default, mode Agent)**_


Searching the codebase for how we register canvas context-menu (right-click) options and hook into the canvas.
`</think>`



---

<tool-use data-tool-type="unknown" data-tool-name="ripgrep_raw_search">
<details>
<summary>Tool use: **ripgrep_raw_search**</summary>


Parameters:

```json
{
  "pattern": "context|right.?click|menu|canvas",
  "path": "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src",
  "caseInsensitive": true
}
```
Result:

```json
{
  "success": {
    "pattern": "context|right.?click|menu|canvas",
    "path": "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src",
    "outputMode": "content",
    "workspaceResults": {
      "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board": {
        "content": {
          "matches": [
            {
              "file": "src/canvas/types.test.ts",
              "matches": [
                {
                  "lineNumber": 14,
                  "content": "import type { CanvasData } from \"./types\";"
                },
                {
                  "lineNumber": 73,
                  "content": "\t\tconst data: CanvasData = {"
                },
                {
                  "lineNumber": 92,
                  "content": "\t\tconst data: CanvasData = {"
                },
                {
                  "lineNumber": 102,
                  "content": "\t\tconst data: CanvasData = {"
                },
                {
                  "lineNumber": 116,
                  "content": "\t\tconst data: CanvasData = {"
                },
                {
                  "lineNumber": 126,
                  "content": "\t\tconst data: CanvasData = {"
                },
                {
                  "lineNumber": 133,
                  "content": "\t\tconst data: CanvasData = { nodes: [], edges: [] };"
                },
                {
                  "lineNumber": 142,
                  "content": "\t\tconst data: CanvasData = { nodes: [], edges: [] };"
                },
                {
                  "lineNumber": 148,
                  "content": "\t\tconst data: CanvasData = {"
                },
                {
                  "lineNumber": 158,
                  "content": "\t\tconst data: CanvasData = {"
                }
              ]
            },
            {
              "file": "src/canvas/types.ts",
              "matches": [
                {
                  "lineNumber": 2,
                  "content": "\tAllCanvasNodeData,"
                },
                {
                  "lineNumber": 3,
                  "content": "\tCanvasData,"
                },
                {
                  "lineNumber": 4,
                  "content": "\tCanvasEdgeData,"
                },
                {
                  "lineNumber": 5,
                  "content": "\tCanvasFileData,"
                },
                {
                  "lineNumber": 6,
                  "content": "\tCanvasNodeData,"
                },
                {
                  "lineNumber": 7,
                  "content": "\tCanvasTextData,"
                },
                {
                  "lineNumber": 8,
                  "content": "} from \"obsidian/canvas\";"
                },
                {
                  "lineNumber": 9,
                  "content": "import type {CanvasColor, NodeRole, ZettelPluginSettings} from \"../settings\";"
                },
                {
                  "lineNumber": 11,
                  "content": "export type {AllCanvasNodeData, CanvasData, CanvasEdgeData, CanvasFileData, CanvasNodeData, CanvasTextData};"
                },
                {
                  "lineNumber": 14,
                  "content": "export function normalizeColor(c: CanvasColor | undefined): string {"
                },
                {
                  "lineNumber": 22,
                  "content": "export function getNodeRole(node: { color?: CanvasColor }, settings: ZettelPluginSettings): NodeRole | null {"
                },
                {
                  "lineNumber": 28,
                  "content": "\t\tconst settingColor = normalizeColor(settings[key] as CanvasColor | undefined);"
                },
                {
                  "lineNumber": 48,
                  "content": "\tedge: CanvasEdgeData;"
                },
                {
                  "lineNumber": 53,
                  "content": "export function getIncomingEdgesWithLabels(nodeId: string, data: CanvasData): IncomingEdgeInfo[] {"
                },
                {
                  "lineNumber": 71,
                  "content": "export function getParentIdsSortedByY(nodeId: string, data: CanvasData): string[] {"
                },
                {
                  "lineNumber": 85,
                  "content": "/** Get node by id from canvas data. */"
                },
                {
                  "lineNumber": 86,
                  "content": "export function getNodeById(data: CanvasData, id: string): AllCanvasNodeData | undefined {"
                },
                {
                  "lineNumber": 91,
                  "content": "export function isTextNode(node: AllCanvasNodeData): node is CanvasTextData {"
                },
                {
                  "lineNumber": 92,
                  "content": "\treturn (node as CanvasTextData).type === \"text\";"
                },
                {
                  "lineNumber": 96,
                  "content": "export function isFileNode(node: AllCanvasNodeData): node is CanvasFileData {"
                },
                {
                  "lineNumber": 97,
                  "content": "\treturn (node as CanvasFileData).type === \"file\";"
                },
                {
                  "lineNumber": 101,
                  "content": "export function getTextNodeContent(node: CanvasTextData): string {"
                },
                {
                  "lineNumber": 106,
                  "content": "export function getFileNodePath(node: CanvasFileData): string {"
                },
                {
                  "lineNumber": 115,
                  "content": "\tdata: CanvasData,"
                },
                {
                  "lineNumber": 121,
                  "content": "\tconst greenColor = normalizeColor(settings.colorGreen as CanvasColor | undefined);"
                }
              ]
            },
            {
              "file": "src/engine/runner.ts",
              "matches": [
                {
                  "lineNumber": 10,
                  "content": "\tloadCanvasData,"
                },
                {
                  "lineNumber": 11,
                  "content": "\tsaveCanvasData,"
                },
                {
                  "lineNumber": 12,
                  "content": "} from \"../canvas/nodes\";"
                },
                {
                  "lineNumber": 13,
                  "content": "import type {AllCanvasNodeData, CanvasData, CanvasEdgeData} from \"../canvas/types\";"
                },
                {
                  "lineNumber": 18,
                  "content": "} from \"../canvas/types\";"
                },
                {
                  "lineNumber": 19,
                  "content": "import type {LiveCanvas} from \"./canvasApi\";"
                },
                {
                  "lineNumber": 20,
                  "content": "import {getKernelForCanvas} from \"./kernelManager\";"
                },
                {
                  "lineNumber": 23,
                  "content": "\tgetCanvasKey,"
                },
                {
                  "lineNumber": 32,
                  "content": "function getRootIds(data: CanvasData): string[] {"
                },
                {
                  "lineNumber": 38,
                  "content": "function canReach(data: CanvasData, fromId: string, toId: string): boolean {"
                },
                {
                  "lineNumber": 54,
                  "content": "function topologicalOrderToTarget(data: CanvasData, targetId: string): string[] {"
                },
                {
                  "lineNumber": 92,
                  "content": "/** Build concatenated context, template with {{var:name}} substituted, and per-edge mode. */"
                },
                {
                  "lineNumber": 94,
                  "content": "\tcanvasKey: string,"
                },
                {
                  "lineNumber": 96,
                  "content": "\tincoming: { parentId: string; edge: CanvasEdgeData; variableName: string }[]"
                },
                {
                  "lineNumber": 101,
                  "content": "\t\tconst r = getNodeResult(canvasKey, parentId);"
                },
                {
                  "lineNumber": 130,
                  "content": "/** Update edge labels to show inject vs concatenate, then refresh view (if setData) and save canvas. */"
                },
                {
                  "lineNumber": 133,
                  "content": "\tcanvasFilePath: string,"
                },
                {
                  "lineNumber": 134,
                  "content": "\tdata: CanvasData,"
                },
                {
                  "lineNumber": 137,
                  "content": "\tliveCanvas: LiveCanvas | null"
                },
                {
                  "lineNumber": 154,
                  "content": "\tliveCanvas?.setData?.(data);"
                },
                {
                  "lineNumber": 155,
                  "content": "\tawait saveCanvasData(vault, canvasFilePath, data);"
                },
                {
                  "lineNumber": 158,
                  "content": "/** Run a single node: get input + parent context (concatenate or {{var:name}}), call LLM or Python, store result. */"
                },
                {
                  "lineNumber": 162,
                  "content": "\tcanvasKey: string,"
                },
                {
                  "lineNumber": 163,
                  "content": "\tcanvasFilePath: string,"
                },
                {
                  "lineNumber": 164,
                  "content": "\tdata: CanvasData,"
                },
                {
                  "lineNumber": 166,
                  "content": "\tliveCanvas: LiveCanvas | null"
                },
                {
                  "lineNumber": 175,
                  "content": "\t\t\tsetNodeResult(canvasKey, nodeId, content);"
                },
                {
                  "lineNumber": 183,
                  "content": "\t\tcanvasKey,"
                },
                {
                  "lineNumber": 193,
                  "content": "\t\tsetNodeResult(canvasKey, nodeId, result);"
                },
                {
                  "lineNumber": 194,
                  "content": "\t\tif (liveCanvas) createGreenNode(liveCanvas, node, result);"
                },
                {
                  "lineNumber": 195,
                  "content": "\t\tawait updateEdgeLabelsAndSave(app.vault, canvasFilePath, data, nodeId, edgeModes, liveCanvas);"
                },
                {
                  "lineNumber": 201,
                  "content": "\t\tsetNodeResult(canvasKey, nodeId, result);"
                },
                {
                  "lineNumber": 202,
                  "content": "\t\tif (liveCanvas) createGreenNode(liveCanvas, node, result);"
                },
                {
                  "lineNumber": 203,
                  "content": "\t\tawait updateEdgeLabelsAndSave(app.vault, canvasFilePath, data, nodeId, edgeModes, liveCanvas);"
                },
                {
                  "lineNumber": 207,
                  "content": "\t\tconst kernel = getKernelForCanvas(canvasKey, settings.pythonPath);"
                },
                {
                  "lineNumber": 209,
                  "content": "\t\tsetNodeResult(canvasKey, nodeId, result);"
                },
                {
                  "lineNumber": 210,
                  "content": "\t\tif (liveCanvas) createGreenNode(liveCanvas, node, result);"
                },
                {
                  "lineNumber": 211,
                  "content": "\t\tawait updateEdgeLabelsAndSave(app.vault, canvasFilePath, data, nodeId, edgeModes, liveCanvas);"
                },
                {
                  "lineNumber": 218,
                  "content": "function createGreenNode(liveCanvas: LiveCanvas, sourceNode: AllCanvasNodeData, text: string): void {"
                },
                {
                  "lineNumber": 223,
                  "content": "\tconst textNode = liveCanvas.createTextNode({"
                },
                {
                  "lineNumber": 230,
                  "content": "\tliveCanvas.addNode(textNode);"
                },
                {
                  "lineNumber": 233,
                  "content": "\tif (liveCanvas.requestSave) liveCanvas.requestSave();"
                },
                {
                  "lineNumber": 240,
                  "content": "\tcanvasFilePath: string,"
                },
                {
                  "lineNumber": 242,
                  "content": "\tliveCanvas: LiveCanvas | null"
                },
                {
                  "lineNumber": 244,
                  "content": "\tconst data = await loadCanvasData(app.vault, canvasFilePath);"
                },
                {
                  "lineNumber": 245,
                  "content": "\tif (!data) return { ok: false, message: \"Could not load canvas data.\" };"
                },
                {
                  "lineNumber": 253,
                  "content": "\t\tif (getNodeResult(getCanvasKey(canvasFilePath), pid) == null) {"
                },
                {
                  "lineNumber": 257,
                  "content": "\tconst canvasKey = getCanvasKey(canvasFilePath);"
                },
                {
                  "lineNumber": 259,
                  "content": "\t\tawait runSingleNode(app, settings, canvasKey, canvasFilePath, data, nodeId, liveCanvas);"
                },
                {
                  "lineNumber": 270,
                  "content": "\tcanvasFilePath: string,"
                },
                {
                  "lineNumber": 272,
                  "content": "\tliveCanvas: LiveCanvas | null"
                },
                {
                  "lineNumber": 274,
                  "content": "\tconst data = await loadCanvasData(app.vault, canvasFilePath);"
                },
                {
                  "lineNumber": 275,
                  "content": "\tif (!data) return { ok: false, message: \"Could not load canvas data.\" };"
                },
                {
                  "lineNumber": 280,
                  "content": "\tconst canvasKey = getCanvasKey(canvasFilePath);"
                },
                {
                  "lineNumber": 283,
                  "content": "\t\t\tawait runSingleNode(app, settings, canvasKey, canvasFilePath, data, nid, liveCanvas);"
                },
                {
                  "lineNumber": 293,
                  "content": "\tdata: CanvasData,"
                },
                {
                  "lineNumber": 296,
                  "content": "\tliveCanvas: LiveCanvas | null"
                },
                {
                  "lineNumber": 298,
                  "content": "\tif (!liveCanvas?.removeNode) return;"
                },
                {
                  "lineNumber": 301,
                  "content": "\tconst nodes = liveCanvas.nodes;"
                },
                {
                  "lineNumber": 304,
                  "content": "\t\tif (node) liveCanvas.removeNode(node);"
                },
                {
                  "lineNumber": 308,
                  "content": "\t\t\t\tliveCanvas.removeNode?.(n);"
                },
                {
                  "lineNumber": 313,
                  "content": "\tif (liveCanvas.requestSave) liveCanvas.requestSave();"
                }
              ]
            },
            {
              "file": "src/engine/canvasApi.ts",
              "matches": [
                {
                  "lineNumber": 1,
                  "content": "/** Minimal interface for live canvas mutations (add text node, remove node, save). */"
                },
                {
                  "lineNumber": 2,
                  "content": "export interface LiveCanvas {"
                },
                {
                  "lineNumber": 14,
                  "content": "\t/** If present, used to refresh canvas after edge label updates (Obsidian canvas view). */"
                }
              ]
            },
            {
              "file": "src/canvas/nodes.ts",
              "matches": [
                {
                  "lineNumber": 2,
                  "content": "import type {AllCanvasNodeData, CanvasData, CanvasFileData, CanvasTextData} from \"obsidian/canvas\";"
                },
                {
                  "lineNumber": 14,
                  "content": "/** Load canvas data from vault by reading the canvas file (JSON). */"
                },
                {
                  "lineNumber": 15,
                  "content": "export async function loadCanvasData(vault: Vault, filePath: string): Promise&lt;CanvasData | null&gt; {"
                },
                {
                  "lineNumber": 18,
                  "content": "\t\tconst data = JSON.parse(raw) as CanvasData;"
                },
                {
                  "lineNumber": 26,
                  "content": "/** Save canvas data to vault (writes the canvas file). */"
                },
                {
                  "lineNumber": 27,
                  "content": "export async function saveCanvasData(vault: Vault, filePath: string, data: CanvasData): Promise&lt;boolean&gt; {"
                },
                {
                  "lineNumber": 39,
                  "content": "\tnode: AllCanvasNodeData,"
                },
                {
                  "lineNumber": 42,
                  "content": "\tif (isTextNode(node)) return getTextNodeContent(node as CanvasTextData);"
                },
                {
                  "lineNumber": 44,
                  "content": "\t\tconst path = getFileNodePath(node as CanvasFileData);"
                },
                {
                  "lineNumber": 71,
                  "content": "export type {CanvasData, AllCanvasNodeData, IncomingEdgeInfo} from \"./types\";"
                }
              ]
            },
            {
              "file": "src/main.ts",
              "matches": [
                {
                  "lineNumber": 1,
                  "content": "import {Menu, Notice, Plugin, WorkspaceLeaf} from \"obsidian\";"
                },
                {
                  "lineNumber": 5,
                  "content": "import {getKernelForCanvas, terminateAllKernels, terminateKernel} from \"./engine/kernelManager\";"
                },
                {
                  "lineNumber": 6,
                  "content": "import {loadCanvasData} from \"./canvas/nodes\";"
                },
                {
                  "lineNumber": 8,
                  "content": "/** Resolve canvas node id from context-menu payload (shape may vary by Obsidian version). */"
                },
                {
                  "lineNumber": 9,
                  "content": "function resolveCanvasNodeId(node: unknown): string | undefined {"
                },
                {
                  "lineNumber": 42,
                  "content": "\t\t\t\t\tconst view = this.getActiveCanvasView();"
                },
                {
                  "lineNumber": 45,
                  "content": "\t\t\t\t\t// Command palette: no node selected; prompt user to use context menu"
                },
                {
                  "lineNumber": 46,
                  "content": "\t\t\t\t\tnew Notice(\"Right-click a node and choose \\\"Run node\\\" to run it.\");"
                },
                {
                  "lineNumber": 55,
                  "content": "\t\t\t\t\tconst view = this.getActiveCanvasView();"
                },
                {
                  "lineNumber": 58,
                  "content": "\t\t\t\t\tnew Notice(\"Right-click a node and choose \\\"Run chain\\\" to run from roots.\");"
                },
                {
                  "lineNumber": 67,
                  "content": "\t\t\t\t\tconst view = this.getActiveCanvasView();"
                },
                {
                  "lineNumber": 70,
                  "content": "\t\t\t\t\tnew Notice(\"Right-click a node and choose \\\"Dismiss output\\\" to remove its output.\");"
                },
                {
                  "lineNumber": 75,
                  "content": "\t\t\t// Canvas node context menu (event \"canvas:node-menu\" is undocumented in Obsidian API)."
                },
                {
                  "lineNumber": 76,
                  "content": "\t\t\t// Defer registration so Obsidian canvas is ready (avoids \"reading '_'\" in app.js)."
                },
                {
                  "lineNumber": 77,
                  "content": "\t\t\tconst registerCanvasNodeMenu = () =&gt; {"
                },
                {
                  "lineNumber": 79,
                  "content": "\t\t\t\t\tconst onCanvasNodeMenu = this.app.workspace.on as ("
                },
                {
                  "lineNumber": 81,
                  "content": "\t\t\t\t\t\tcallback: (menu: Menu, node: unknown) =&gt; void"
                },
                {
                  "lineNumber": 84,
                  "content": "\t\t\t\t\t\tonCanvasNodeMenu(\"canvas:node-menu\", (menu: Menu, node: unknown) =&gt; {"
                },
                {
                  "lineNumber": 85,
                  "content": "\t\t\t\t\t\t\tconst nodeId = resolveCanvasNodeId(node);"
                },
                {
                  "lineNumber": 87,
                  "content": "\t\t\t\t\t\t\tmenu.addItem((item) =&gt;"
                },
                {
                  "lineNumber": 90,
                  "content": "\t\t\t\t\t\t\tmenu.addItem((item) =&gt;"
                },
                {
                  "lineNumber": 93,
                  "content": "\t\t\t\t\t\t\tmenu.addItem((item) =&gt;"
                },
                {
                  "lineNumber": 99,
                  "content": "\t\t\t\t\tconsole.error(\"Zettel Thinking Board: could not register canvas:node-menu.\", e);"
                },
                {
                  "lineNumber": 102,
                  "content": "\t\t\tconst timeoutId = window.setTimeout(registerCanvasNodeMenu, 0);"
                },
                {
                  "lineNumber": 105,
                  "content": "\t\t\t// Terminate kernel when a canvas is closed (one kernel per canvas)"
                },
                {
                  "lineNumber": 106,
                  "content": "\t\t\tlet previousCanvasPaths = new Set&lt;string&gt;();"
                },
                {
                  "lineNumber": 109,
                  "content": "\t\t\t\t\tconst leaves = this.app.workspace.getLeavesOfType(\"canvas\");"
                },
                {
                  "lineNumber": 115,
                  "content": "\t\t\t\t\tfor (const path of previousCanvasPaths) {"
                },
                {
                  "lineNumber": 118,
                  "content": "\t\t\t\t\tpreviousCanvasPaths = openPaths;"
                },
                {
                  "lineNumber": 158,
                  "content": "\t/** Returns the active canvas view if the active leaf is a canvas. */"
                },
                {
                  "lineNumber": 159,
                  "content": "\tgetActiveCanvasView(): { canvas: unknown; file: { path: string } } | null {"
                },
                {
                  "lineNumber": 162,
                  "content": "\t\tconst v = leaf.view as { getViewType?: () =&gt; string; canvas?: unknown; file?: { path: string } };"
                },
                {
                  "lineNumber": 163,
                  "content": "\t\tif (v.getViewType?.() !== \"canvas\") return null;"
                },
                {
                  "lineNumber": 164,
                  "content": "\t\tif (v.canvas == null || v.file == null) return null;"
                },
                {
                  "lineNumber": 165,
                  "content": "\t\treturn { canvas: v.canvas, file: v.file };"
                },
                {
                  "lineNumber": 168,
                  "content": "\t/** Run a single node (call from context menu with node id). */"
                },
                {
                  "lineNumber": 170,
                  "content": "\t\tconst view = this.getActiveCanvasView();"
                },
                {
                  "lineNumber": 172,
                  "content": "\t\tconst liveCanvas = view.canvas as import(\"./engine/canvasApi\").LiveCanvas;"
                },
                {
                  "lineNumber": 173,
                  "content": "\t\tconst result = await runnerRunNode(this.app, this.settings, view.file.path, nodeId, liveCanvas);"
                },
                {
                  "lineNumber": 177,
                  "content": "\t/** Run chain from roots to the given node (call from context menu with node id). */"
                },
                {
                  "lineNumber": 179,
                  "content": "\t\tconst view = this.getActiveCanvasView();"
                },
                {
                  "lineNumber": 181,
                  "content": "\t\tconst liveCanvas = view.canvas as import(\"./engine/canvasApi\").LiveCanvas;"
                },
                {
                  "lineNumber": 182,
                  "content": "\t\tconst result = await runnerRunChain(this.app, this.settings, view.file.path, nodeId, liveCanvas);"
                },
                {
                  "lineNumber": 186,
                  "content": "\t/** Dismiss the Green output node for the given source node (call from context menu with node id). */"
                },
                {
                  "lineNumber": 188,
                  "content": "\t\tconst view = this.getActiveCanvasView();"
                },
                {
                  "lineNumber": 190,
                  "content": "\t\tconst data = await loadCanvasData(this.app.vault, view.file.path);"
                },
                {
                  "lineNumber": 192,
                  "content": "\t\tconst liveCanvas = view.canvas as import(\"./engine/canvasApi\").LiveCanvas;"
                },
                {
                  "lineNumber": 193,
                  "content": "\t\trunnerDismissOutput(data, nodeId, this.settings, liveCanvas);"
                },
                {
                  "lineNumber": 196,
                  "content": "\t/** Get kernel for the active canvas (for side panel to wire obsidian_log). */"
                },
                {
                  "lineNumber": 197,
                  "content": "\tgetKernelForActiveCanvas(): import(\"./engine/pythonKernel\").PythonKernel | null {"
                },
                {
                  "lineNumber": 198,
                  "content": "\t\tconst view = this.getActiveCanvasView();"
                },
                {
                  "lineNumber": 200,
                  "content": "\t\treturn getKernelForCanvas(view.file.path, this.settings.pythonPath);"
                }
              ]
            },
            {
              "file": "src/views/ZettelControlsView.ts",
              "matches": [
                {
                  "lineNumber": 61,
                  "content": "\t\t\t.setDesc(\"Restart the kernel for the active canvas\")"
                },
                {
                  "lineNumber": 64,
                  "content": "\t\t\t\t\tconst view = this.plugin.getActiveCanvasView();"
                },
                {
                  "lineNumber": 66,
                  "content": "\t\t\t\t\t\tnew Notice(\"Open a canvas first.\");"
                },
                {
                  "lineNumber": 70,
                  "content": "\t\t\t\t\tnew Notice(\"Kernel restarted for this canvas.\");"
                },
                {
                  "lineNumber": 113,
                  "content": "\t\t\tconst kernel = this.plugin.getKernelForActiveCanvas();"
                }
              ]
            },
            {
              "file": "src/settings.ts",
              "matches": [
                {
                  "lineNumber": 4,
                  "content": "/** CanvasColor: Obsidian preset '1'..'6' or hex e.g. '#FFA500' */"
                },
                {
                  "lineNumber": 5,
                  "content": "export type CanvasColor = string;"
                },
                {
                  "lineNumber": 12,
                  "content": "\tcolorOrange: CanvasColor;"
                },
                {
                  "lineNumber": 13,
                  "content": "\tcolorPurple: CanvasColor;"
                },
                {
                  "lineNumber": 14,
                  "content": "\tcolorBlue: CanvasColor;"
                },
                {
                  "lineNumber": 15,
                  "content": "\tcolorYellow: CanvasColor;"
                },
                {
                  "lineNumber": 16,
                  "content": "\tcolorGreen: CanvasColor;"
                },
                {
                  "lineNumber": 31,
                  "content": "/** Obsidian canvas preset 1–6: approximate display color and short label for settings UI. */"
                },
                {
                  "lineNumber": 32,
                  "content": "const PRESET_COLORS: { value: CanvasColor; label: string; hex: string }[] = ["
                },
                {
                  "lineNumber": 49,
                  "content": "\tconst current = plugin.settings[key] as CanvasColor;"
                },
                {
                  "lineNumber": 90,
                  "content": "\t\t\t(plugin.settings as unknown as Record&lt;string, CanvasColor&gt;)[key] = customHex.value.trim() || \"#000000\";"
                },
                {
                  "lineNumber": 92,
                  "content": "\t\t\t(plugin.settings as unknown as Record&lt;string, CanvasColor&gt;)[key] = v;"
                },
                {
                  "lineNumber": 110,
                  "content": "\t\t\t(plugin.settings as unknown as Record&lt;string, CanvasColor&gt;)[key] = hex;"
                },
                {
                  "lineNumber": 132,
                  "content": "\t\thint.setText(\"Right-click a node on the canvas and choose Run node or Run chain.\");"
                },
                {
                  "lineNumber": 213,
                  "content": "\t\t\t\"Color for the primary model node on the canvas\""
                },
                {
                  "lineNumber": 220,
                  "content": "\t\t\t\"Color for the secondary model node on the canvas\""
                },
                {
                  "lineNumber": 227,
                  "content": "\t\t\t\"Color for the Python node on the canvas\""
                },
                {
                  "lineNumber": 234,
                  "content": "\t\t\t\"Color for the comment (pass-through) node on the canvas\""
                },
                {
                  "lineNumber": 241,
                  "content": "\t\t\t\"Color for auto-generated output nodes on the canvas\""
                }
              ]
            },
            {
              "file": "src/engine/state.test.ts",
              "matches": [
                {
                  "lineNumber": 3,
                  "content": "\tgetCanvasKey,"
                },
                {
                  "lineNumber": 6,
                  "content": "\tclearCanvasState,"
                },
                {
                  "lineNumber": 10,
                  "content": "\tclearCanvasState(\"/c.md\");"
                },
                {
                  "lineNumber": 11,
                  "content": "\tclearCanvasState(\"/a.md\");"
                },
                {
                  "lineNumber": 12,
                  "content": "\tclearCanvasState(\"/b.md\");"
                },
                {
                  "lineNumber": 13,
                  "content": "\tclearCanvasState(\"/c1.md\");"
                },
                {
                  "lineNumber": 14,
                  "content": "\tclearCanvasState(\"/c2.md\");"
                },
                {
                  "lineNumber": 17,
                  "content": "describe(\"getCanvasKey\", () =&gt; {"
                },
                {
                  "lineNumber": 19,
                  "content": "\t\texpect(getCanvasKey(\"/path/to/canvas.md\")).toBe(\"/path/to/canvas.md\");"
                },
                {
                  "lineNumber": 20,
                  "content": "\t\texpect(getCanvasKey(\"canvas.md\")).toBe(\"canvas.md\");"
                },
                {
                  "lineNumber": 32,
                  "content": "\tit(\"isolates state per canvas key\", () =&gt; {"
                },
                {
                  "lineNumber": 40,
                  "content": "describe(\"clearCanvasState\", () =&gt; {"
                },
                {
                  "lineNumber": 41,
                  "content": "\tit(\"removes all node results for that canvas\", () =&gt; {"
                },
                {
                  "lineNumber": 43,
                  "content": "\t\tclearCanvasState(\"/c.md\");"
                },
                {
                  "lineNumber": 46,
                  "content": "\tit(\"does not affect other canvases\", () =&gt; {"
                },
                {
                  "lineNumber": 49,
                  "content": "\t\tclearCanvasState(\"/c1.md\");"
                }
              ]
            },
            {
              "file": "src/__mocks__/obsidian-canvas.ts",
              "matches": [
                {
                  "lineNumber": 2,
                  "content": " * Minimal obsidian/canvas mock for unit tests. Types are used from node_modules;"
                },
                {
                  "lineNumber": 3,
                  "content": " * this file exists so that any runtime import of \"obsidian/canvas\" resolves."
                },
                {
                  "lineNumber": 5,
                  "content": "export const CanvasData = {};"
                },
                {
                  "lineNumber": 6,
                  "content": "export const CanvasNodeData = {};"
                },
                {
                  "lineNumber": 7,
                  "content": "export const CanvasEdgeData = {};"
                },
                {
                  "lineNumber": 8,
                  "content": "export const CanvasFileData = {};"
                },
                {
                  "lineNumber": 9,
                  "content": "export const CanvasTextData = {};"
                },
                {
                  "lineNumber": 10,
                  "content": "export const AllCanvasNodeData = {};"
                }
              ]
            },
            {
              "file": "src/__mocks__/obsidian.ts",
              "matches": [
                {
                  "lineNumber": 21,
                  "content": "export class Menu {"
                }
              ]
            },
            {
              "file": "src/types.ts",
              "matches": [
                {
                  "lineNumber": 9,
                  "content": "\tgetActiveCanvasView(): { canvas: unknown; file: { path: string } } | null;"
                },
                {
                  "lineNumber": 10,
                  "content": "\tgetKernelForActiveCanvas(): { onLog?: ((line: string) =&gt; void) | undefined; run(code: string, inputText: string): Promise&lt;string&gt;; terminate(): void } | null;"
                }
              ]
            },
            {
              "file": "src/engine/kernelManager.ts",
              "matches": [
                {
                  "lineNumber": 4,
                  "content": "/** One kernel per canvas (key = canvas file path). */"
                },
                {
                  "lineNumber": 7,
                  "content": "export function getKernelForCanvas(canvasKey: string, pythonPath: string): PythonKernel {"
                },
                {
                  "lineNumber": 8,
                  "content": "\tlet k = kernels.get(canvasKey);"
                },
                {
                  "lineNumber": 11,
                  "content": "\t\tkernels.set(canvasKey, k);"
                },
                {
                  "lineNumber": 16,
                  "content": "export function terminateKernel(canvasKey: string): void {"
                },
                {
                  "lineNumber": 17,
                  "content": "\tconst k = kernels.get(canvasKey);"
                },
                {
                  "lineNumber": 20,
                  "content": "\t\tkernels.delete(canvasKey);"
                }
              ]
            },
            {
              "file": "src/engine/state.ts",
              "matches": [
                {
                  "lineNumber": 1,
                  "content": "/** Per-canvas state: NodeID -&gt; last output result string. */"
                },
                {
                  "lineNumber": 2,
                  "content": "const canvasState = new Map&lt;string, Map&lt;string, string&gt;&gt;();"
                },
                {
                  "lineNumber": 4,
                  "content": "function getCanvasState(canvasKey: string): Map&lt;string, string&gt; {"
                },
                {
                  "lineNumber": 5,
                  "content": "\tlet map = canvasState.get(canvasKey);"
                },
                {
                  "lineNumber": 8,
                  "content": "\t\tcanvasState.set(canvasKey, map);"
                },
                {
                  "lineNumber": 13,
                  "content": "export function getNodeResult(canvasKey: string, nodeId: string): string | undefined {"
                },
                {
                  "lineNumber": 14,
                  "content": "\treturn getCanvasState(canvasKey).get(nodeId);"
                },
                {
                  "lineNumber": 17,
                  "content": "export function setNodeResult(canvasKey: string, nodeId: string, result: string): void {"
                },
                {
                  "lineNumber": 18,
                  "content": "\tgetCanvasState(canvasKey).set(nodeId, result);"
                },
                {
                  "lineNumber": 21,
                  "content": "export function clearCanvasState(canvasKey: string): void {"
                },
                {
                  "lineNumber": 22,
                  "content": "\tcanvasState.delete(canvasKey);"
                },
                {
                  "lineNumber": 25,
                  "content": "/** Canvas key = file path for the canvas file. */"
                },
                {
                  "lineNumber": 26,
                  "content": "export function getCanvasKey(filePath: string): string {"
                }
              ]
            }
          ],
          "totalLines": 233,
          "totalMatchedLines": 233
        }
      }
    }
  }
}
```
Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/main.ts</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/engine/canvasApi.ts</summary>

</details>
</tool-use>

---


Checking Obsidian type definitions for canvas and context-menu events:


---

<tool-use data-tool-type="unknown" data-tool-name="ripgrep_raw_search">
<details>
<summary>Tool use: **ripgrep_raw_search**</summary>


Parameters:

```json
{
  "pattern": "canvas|node-menu|context",
  "path": "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/node_modules/obsidian",
  "glob": "*.d.ts",
  "caseInsensitive": false
}
```
Result:

```json
{
  "success": {
    "pattern": "canvas|node-menu|context",
    "path": "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/node_modules/obsidian",
    "outputMode": "content",
    "workspaceResults": {
      "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board": {
        "content": {
          "matches": [
            {
              "file": "node_modules/obsidian/publish.d.ts",
              "matches": [
                {
                  "lineNumber": 7,
                  "content": "        }, callback: (value: T, key?: string) =&gt; boolean | void, context?: any): boolean;"
                }
              ]
            },
            {
              "file": "node_modules/obsidian/obsidian.d.ts",
              "matches": [
                {
                  "lineNumber": 15,
                  "content": "        }, callback: (value: T, key?: string) =&gt; boolean | void, context?: any): boolean;"
                },
                {
                  "lineNumber": 904,
                  "content": "     * formula in the context of the current Base. For embedded bases, or bases"
                },
                {
                  "lineNumber": 2240,
                  "content": "     * Current suggestion context, containing the result of &#96;onTrigger&#96;."
                },
                {
                  "lineNumber": 2245,
                  "content": "    context: EditorSuggestContext | null;"
                },
                {
                  "lineNumber": 2274,
                  "content": "     * Generate suggestion items based on this context. Can be async, but preferably sync."
                },
                {
                  "lineNumber": 2275,
                  "content": "     * When generating async suggestions, you should pass the context along."
                },
                {
                  "lineNumber": 2279,
                  "content": "    abstract getSuggestions(context: EditorSuggestContext): T[] | Promise&lt;T[]&gt;;"
                },
                {
                  "lineNumber": 2827,
                  "content": " * The context in which a formula is evaluated. In most cases, {@link BasesEntry} is the specific type to use."
                },
                {
                  "lineNumber": 6857,
                  "content": "     * Add a context menu to internal file links."
                },
                {
                  "lineNumber": 6916,
                  "content": "     * Triggered when the user opens the context menu on a file."
                },
                {
                  "lineNumber": 6922,
                  "content": "     * Triggered when the user opens the context menu with multiple files selected in the File Explorer."
                },
                {
                  "lineNumber": 6929,
                  "content": "     * Triggered when the user opens the context menu on an external URL."
                },
                {
                  "lineNumber": 6935,
                  "content": "     * Triggered when the user opens the context menu on an editor."
                }
              ]
            },
            {
              "file": "node_modules/obsidian/canvas.d.ts",
              "matches": [
                {
                  "lineNumber": 9,
                  "content": "/** The overall canvas file's JSON */"
                }
              ]
            }
          ],
          "totalLines": 15,
          "totalMatchedLines": 15
        }
      }
    }
  }
}
```
Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/package.json</summary>

</details>
</tool-use>

---





---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/node_modules/obsidian/canvas.d.ts</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="ripgrep_raw_search">
<details>
<summary>Tool use: **ripgrep_raw_search**</summary>


Parameters:

```json
{
  "pattern": "WorkspaceEvents|on\\(|EventRef|\"canvas",
  "path": "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/node_modules/obsidian/obsidian.d.ts",
  "contextBefore": 0,
  "contextAfter": 0,
  "caseInsensitive": false
}
```
Result:

```json
{
  "success": {
    "pattern": "WorkspaceEvents|on\\(|EventRef|\"canvas",
    "path": "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/node_modules/obsidian/obsidian.d.ts",
    "outputMode": "content",
    "workspaceResults": {
      "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board": {
        "content": {
          "matches": [
            {
              "file": "node_modules/obsidian/obsidian.d.ts",
              "matches": [
                {
                  "lineNumber": 330,
                  "content": "    selectSuggestion(value: T, evt: MouseEvent | KeyboardEvent): void;"
                },
                {
                  "lineNumber": 393,
                  "content": "export function addIcon(iconId: string, svgContent: string): void;"
                },
                {
                  "lineNumber": 1085,
                  "content": "    setIcon(icon: IconName): this;"
                },
                {
                  "lineNumber": 1439,
                  "content": "     *     const sel = editor.getSelection();"
                },
                {
                  "lineNumber": 1540,
                  "content": "    registerEvent(eventRef: EventRef): void;"
                },
                {
                  "lineNumber": 1846,
                  "content": "    addOption(value: string, display: string): this;"
                },
                {
                  "lineNumber": 1998,
                  "content": "    abstract getSelection(): string;"
                },
                {
                  "lineNumber": 2013,
                  "content": "    abstract replaceSelection(replacement: string, origin?: string): void;"
                },
                {
                  "lineNumber": 2038,
                  "content": "    abstract setSelection(anchor: EditorPosition, head?: EditorPosition): void;"
                },
                {
                  "lineNumber": 2104,
                  "content": "    abstract transaction(tx: EditorTransaction, origin?: string): void;"
                },
                {
                  "lineNumber": 2348,
                  "content": "export interface EventRef {"
                },
                {
                  "lineNumber": 2362,
                  "content": "    on(name: string, callback: (...data: unknown[]) =&gt; unknown, ctx?: any): EventRef;"
                },
                {
                  "lineNumber": 2372,
                  "content": "    offref(ref: EventRef): void;"
                },
                {
                  "lineNumber": 2382,
                  "content": "    tryTrigger(evt: EventRef, args: unknown[]): void;"
                },
                {
                  "lineNumber": 2416,
                  "content": "    setIcon(icon: IconName): this;"
                },
                {
                  "lineNumber": 2456,
                  "content": "    promptForDeletion(file: TAbstractFile): Promise&lt;void&gt;;"
                },
                {
                  "lineNumber": 2754,
                  "content": "    canAcceptExtension(extension: string): boolean;"
                },
                {
                  "lineNumber": 2924,
                  "content": "    renderSuggestion(item: FuzzyMatch&lt;T&gt;, el: HTMLElement): void;"
                },
                {
                  "lineNumber": 2929,
                  "content": "    onChooseSuggestion(item: FuzzyMatch&lt;T&gt;, evt: MouseEvent | KeyboardEvent): void;"
                },
                {
                  "lineNumber": 2970,
                  "content": "export function getIcon(iconId: string): SVGSVGElement | null;"
                },
                {
                  "lineNumber": 3217,
                  "content": "    renderSuggestion(value: T, el: HTMLElement): void;"
                },
                {
                  "lineNumber": 3222,
                  "content": "    selectSuggestion(value: T, evt: MouseEvent | KeyboardEvent): void;"
                },
                {
                  "lineNumber": 3244,
                  "content": "    addAction(icon: IconName, title: string, callback: (evt: MouseEvent) =&gt; any): HTMLElement;"
                },
                {
                  "lineNumber": 3578,
                  "content": "    getSelection(): string;"
                },
                {
                  "lineNumber": 3895,
                  "content": "    setNoIcon(): this;"
                },
                {
                  "lineNumber": 3924,
                  "content": "    showAtPosition(position: MenuPositionDef, doc?: Document): this;"
                },
                {
                  "lineNumber": 3962,
                  "content": "    setIcon(icon: IconName | null): this;"
                },
                {
                  "lineNumber": 3996,
                  "content": "    setSection(section: string): this;"
                },
                {
                  "lineNumber": 4082,
                  "content": "    on(name: 'changed', callback: (file: TFile, data: string, cache: CachedMetadata) =&gt; any, ctx?: any): EventRef;"
                },
                {
                  "lineNumber": 4088,
                  "content": "    on(name: 'deleted', callback: (file: TFile, prevCache: CachedMetadata | null) =&gt; any, ctx?: any): EventRef;"
                },
                {
                  "lineNumber": 4095,
                  "content": "    on(name: 'resolve', callback: (file: TFile) =&gt; any, ctx?: any): EventRef;"
                },
                {
                  "lineNumber": 4100,
                  "content": "    on(name: 'resolved', callback: () =&gt; any, ctx?: any): EventRef;"
                },
                {
                  "lineNumber": 4575,
                  "content": "    addRibbonIcon(icon: IconName, title: string, callback: (evt: MouseEvent) =&gt; any): HTMLElement;"
                },
                {
                  "lineNumber": 4656,
                  "content": "    registerEditorExtension(extension: Extension): void;"
                },
                {
                  "lineNumber": 4823,
                  "content": "    abstract renderSuggestion(value: T, el: HTMLElement): void;"
                },
                {
                  "lineNumber": 4828,
                  "content": "    abstract selectSuggestion(value: T, evt: MouseEvent | KeyboardEvent): void;"
                },
                {
                  "lineNumber": 5030,
                  "content": "export function removeIcon(iconId: string): void;"
                },
                {
                  "lineNumber": 5128,
                  "content": "export function requireApiVersion(version: string): boolean;"
                },
                {
                  "lineNumber": 5267,
                  "content": "export function setIcon(parent: HTMLElement, iconId: IconName): void;"
                },
                {
                  "lineNumber": 5342,
                  "content": "    addButton(cb: (component: ButtonComponent) =&gt; any): this;"
                },
                {
                  "lineNumber": 5347,
                  "content": "    addExtraButton(cb: (component: ExtraButtonComponent) =&gt; any): this;"
                },
                {
                  "lineNumber": 5675,
                  "content": "    onNoSuggestion(): void;"
                },
                {
                  "lineNumber": 5680,
                  "content": "    selectSuggestion(value: T, evt: MouseEvent | KeyboardEvent): void;"
                },
                {
                  "lineNumber": 5685,
                  "content": "    selectActiveSuggestion(evt: MouseEvent | KeyboardEvent): void;"
                },
                {
                  "lineNumber": 5695,
                  "content": "    abstract renderSuggestion(value: T, el: HTMLElement): void;"
                },
                {
                  "lineNumber": 5700,
                  "content": "    abstract onChooseSuggestion(item: T, evt: MouseEvent | KeyboardEvent): void;"
                },
                {
                  "lineNumber": 6359,
                  "content": "    on(name: 'create', callback: (file: TAbstractFile) =&gt; any, ctx?: any): EventRef;"
                },
                {
                  "lineNumber": 6365,
                  "content": "    on(name: 'modify', callback: (file: TAbstractFile) =&gt; any, ctx?: any): EventRef;"
                },
                {
                  "lineNumber": 6371,
                  "content": "    on(name: 'delete', callback: (file: TAbstractFile) =&gt; any, ctx?: any): EventRef;"
                },
                {
                  "lineNumber": 6377,
                  "content": "    on(name: 'rename', callback: (file: TAbstractFile, oldPath: string) =&gt; any, ctx?: any): EventRef;"
                },
                {
                  "lineNumber": 6475,
                  "content": "    getIcon(): IconName;"
                },
                {
                  "lineNumber": 6869,
                  "content": "    on(name: 'quick-preview', callback: (file: TFile, data: string) =&gt; any, ctx?: any): EventRef;"
                },
                {
                  "lineNumber": 6875,
                  "content": "    on(name: 'resize', callback: () =&gt; any, ctx?: any): EventRef;"
                },
                {
                  "lineNumber": 6882,
                  "content": "    on(name: 'active-leaf-change', callback: (leaf: WorkspaceLeaf | null) =&gt; any, ctx?: any): EventRef;"
                },
                {
                  "lineNumber": 6889,
                  "content": "    on(name: 'file-open', callback: (file: TFile | null) =&gt; any, ctx?: any): EventRef;"
                },
                {
                  "lineNumber": 6895,
                  "content": "    on(name: 'layout-change', callback: () =&gt; any, ctx?: any): EventRef;"
                },
                {
                  "lineNumber": 6901,
                  "content": "    on(name: 'window-open', callback: (win: WorkspaceWindow, window: Window) =&gt; any, ctx?: any): EventRef;"
                },
                {
                  "lineNumber": 6907,
                  "content": "    on(name: 'window-close', callback: (win: WorkspaceWindow, window: Window) =&gt; any, ctx?: any): EventRef;"
                },
                {
                  "lineNumber": 6913,
                  "content": "    on(name: 'css-change', callback: () =&gt; any, ctx?: any): EventRef;"
                },
                {
                  "lineNumber": 6920,
                  "content": "    on(name: 'file-menu', callback: (menu: Menu, file: TAbstractFile, source: string, leaf?: WorkspaceLeaf) =&gt; any, ctx?: any): EventRef;"
                },
                {
                  "lineNumber": 6926,
                  "content": "    on(name: 'files-menu', callback: (menu: Menu, files: TAbstractFile[], source: string, leaf?: WorkspaceLeaf) =&gt; any, ctx?: any): EventRef;"
                },
                {
                  "lineNumber": 6933,
                  "content": "    on(name: 'url-menu', callback: (menu: Menu, url: string) =&gt; any, ctx?: any): EventRef;"
                },
                {
                  "lineNumber": 6939,
                  "content": "    on(name: 'editor-menu', callback: (menu: Menu, editor: Editor, info: MarkdownView | MarkdownFileInfo) =&gt; any, ctx?: any): EventRef;"
                },
                {
                  "lineNumber": 6945,
                  "content": "    on(name: 'editor-change', callback: (editor: Editor, info: MarkdownView | MarkdownFileInfo) =&gt; any, ctx?: any): EventRef;"
                },
                {
                  "lineNumber": 6954,
                  "content": "    on(name: 'editor-paste', callback: (evt: ClipboardEvent, editor: Editor, info: MarkdownView | MarkdownFileInfo) =&gt; any, ctx?: any): EventRef;"
                },
                {
                  "lineNumber": 6962,
                  "content": "    on(name: 'editor-drop', callback: (evt: DragEvent, editor: Editor, info: MarkdownView | MarkdownFileInfo) =&gt; any, ctx?: any): EventRef;"
                },
                {
                  "lineNumber": 6971,
                  "content": "    on(name: 'quit', callback: (tasks: Tasks) =&gt; any, ctx?: any): EventRef;"
                },
                {
                  "lineNumber": 7131,
                  "content": "    getIcon(): IconName;"
                },
                {
                  "lineNumber": 7145,
                  "content": "    on(name: 'pinned-change', callback: (pinned: boolean) =&gt; any, ctx?: any): EventRef;"
                },
                {
                  "lineNumber": 7149,
                  "content": "    on(name: 'group-change', callback: (group: string) =&gt; any, ctx?: any): EventRef;"
                }
              ]
            }
          ],
          "totalLines": 70,
          "totalMatchedLines": 70
        }
      }
    }
  }
}
```
Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/node_modules/obsidian/obsidian.d.ts</summary>

</details>
</tool-use>

---


Checking whether the event is on the canvas view and searching for the correct event name:


---

<tool-use data-tool-type="search" data-tool-name="web_search">
<details>
            <summary>Tool use: **web_search** • Searched web `undefined` • **1** results</summary>
        
| Title | URL | Chunk |
|-------|-----|-------|
| Web search results for query: Obsidian plugin canvas node context menu event "canvas:node-menu" workspace.on |  | Links:<br/>1. [Context menus](https://docs.obsidian.md/Plugins/User+interface/Context+menus)<br/>2. [GitHub - taboutsafredy/obsidian-canvas-node-screenshot: A node screenshot plugin for Canvas in Obsidian.](https://github.com/taboutsafredy/obsidian-canvas-node-screenshot)<br/>3. [Search code, repositories, users, issues, pull requests...](https://github.com/borolgs/enchanted-canvas)<br/>4. [Events - Developer Documentation](https://docs.obsidian.md/Plugins/Events)<br/>5. [Search code, repositories, users, issues, pull requests...](https://github.com/phibr0/obsidian-extended-context-menu)<br/><br/># Obsidian Canvas Node Context Menu Event<br/><br/>Based on the search results provided, there is **no direct documentation** for a `canvas:node-menu` event in the official Obsidian developer documentation.<br/><br/>However, the Obsidian API does support context menu events through `workspace.on()`. The documented approach for context menus follows this pattern:[1]<br/><br/>```javascript<br/>this.registerEvent(this.app.workspace.on('file-menu', (menu, file) => \{<br/>  menu.addItem((item) => \{<br/>    item.setTitle('Menu Item').onClick(async() => \{<br/>      // Handle click<br/>    \});<br/>  \});<br/>\}));<br/>```<br/><br/>The official documentation mentions `file-menu` and `editor-menu` workspace events,[1] but does not list a `canvas:node-menu` event. If you're looking to add context menu items to canvas nodes, you may need to:<br/><br/>1. Check if `canvas:node-menu` is a custom event available in a specific canvas plugin<br/>2. Look for undocumented workspace events in the Obsidian API<br/>3. Explore community canvas plugins like those referenced in the search results, which may implement their own context menu systems<br/><br/>For reliable implementation, refer to the [official Obsidian events documentation][4] and the [context menus documentation][1]. |

</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="ripgrep_raw_search">
<details>
<summary>Tool use: **ripgrep_raw_search**</summary>


Parameters:

```json
{
  "pattern": "\\.on\\(|Events|event",
  "path": "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/node_modules/obsidian/obsidian.d.ts",
  "contextBefore": 0,
  "contextAfter": 0,
  "caseInsensitive": false
}
```
Result:

```json
{
  "success": {
    "pattern": "\\.on\\(|Events|event",
    "path": "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/node_modules/obsidian/obsidian.d.ts",
    "outputMode": "content",
    "workspaceResults": {
      "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board": {
        "content": {
          "matches": [
            {
              "file": "node_modules/obsidian/obsidian.d.ts",
              "matches": [
                {
                  "lineNumber": 213,
                  "content": "         * @returns destroy - a function to remove the event handler to avoid memory leaks."
                },
                {
                  "lineNumber": 218,
                  "content": "         * @returns destroy - a function to remove the event handler to avoid memory leaks."
                },
                {
                  "lineNumber": 221,
                  "content": "        trigger(eventType: string): void;"
                },
                {
                  "lineNumber": 236,
                  "content": "         * for instanceof checks on UIEvents."
                },
                {
                  "lineNumber": 443,
                  "content": "     * The last known user interaction event, to help commands find out what modifier keys are pressed."
                },
                {
                  "lineNumber": 1536,
                  "content": "     * Registers an event to be detached when unloading"
                },
                {
                  "lineNumber": 1540,
                  "content": "    registerEvent(eventRef: EventRef): void;"
                },
                {
                  "lineNumber": 1542,
                  "content": "     * Registers a DOM event to be detached when unloading"
                },
                {
                  "lineNumber": 1548,
                  "content": "     * Registers a DOM event to be detached when unloading"
                },
                {
                  "lineNumber": 1554,
                  "content": "     * Registers a DOM event to be detached when unloading"
                },
                {
                  "lineNumber": 2356,
                  "content": "export class Events {"
                },
                {
                  "lineNumber": 3094,
                  "content": "     * Whether the &#96;hover-link&#96; event requires the 'Mod' key to be pressed to trigger."
                },
                {
                  "lineNumber": 3273,
                  "content": "     * Push a scope onto the scope stack, setting it as the active scope to handle all key events."
                },
                {
                  "lineNumber": 3287,
                  "content": "     * Checks whether the modifier key is pressed during this event."
                },
                {
                  "lineNumber": 3294,
                  "content": "     * Translates an event into the type of pane that should open."
                },
                {
                  "lineNumber": 3325,
                  "content": " * Return &#96;false&#96; to automatically preventDefault"
                },
                {
                  "lineNumber": 3668,
                  "content": "export interface MarkdownPreviewEvents extends Component {"
                },
                {
                  "lineNumber": 3700,
                  "content": "export class MarkdownPreviewView extends MarkdownRenderer implements MarkdownSubView, MarkdownPreviewEvents {"
                },
                {
                  "lineNumber": 3761,
                  "content": "export abstract class MarkdownRenderer extends MarkdownRenderChild implements MarkdownPreviewEvents, HoverParent {"
                },
                {
                  "lineNumber": 4033,
                  "content": "export class MetadataCache extends Events {"
                },
                {
                  "lineNumber": 4079,
                  "content": "     * You must hook the vault rename event for those."
                },
                {
                  "lineNumber": 4613,
                  "content": "     * Registers a view with the 'Page preview' core plugin as an emitter of the 'hover-link' event."
                },
                {
                  "lineNumber": 5162,
                  "content": " * A scope receives keyboard events and binds callbacks to given hotkeys."
                },
                {
                  "lineNumber": 5173,
                  "content": "     * Add a keymap event handler to this scope."
                },
                {
                  "lineNumber": 5174,
                  "content": "     * @param modifiers - &#96;Mod&#96;, &#96;Ctrl&#96;, &#96;Meta&#96;, &#96;Shift&#96;, or &#96;Alt&#96;. &#96;Mod&#96; translates to &#96;Meta&#96; on macOS and &#96;Ctrl&#96; otherwise. Pass &#96;null&#96; to capture all events matching the &#96;key&#96;, regardless of modifiers."
                },
                {
                  "lineNumber": 5181,
                  "content": "     * Remove an existing keymap event handler."
                },
                {
                  "lineNumber": 6131,
                  "content": "export class Vault extends Events {"
                },
                {
                  "lineNumber": 6355,
                  "content": "     * If you do not wish to receive create events on vault load, register your event handler inside {@link Workspace.onLayoutReady}."
                },
                {
                  "lineNumber": 6557,
                  "content": "export class Workspace extends Events {"
                },
                {
                  "lineNumber": 6941,
                  "content": "     * Triggered when changes to an editor has been applied, either programmatically or from a user event."
                },
                {
                  "lineNumber": 6948,
                  "content": "     * Triggered when the editor receives a paste event."
                },
                {
                  "lineNumber": 6949,
                  "content": "     * Check for &#96;evt.defaultPrevented&#96; before attempting to handle this event, and return if it has been already handled."
                },
                {
                  "lineNumber": 6950,
                  "content": "     * Use &#96;evt.preventDefault()&#96; to indicate that you've handled the event."
                },
                {
                  "lineNumber": 6956,
                  "content": "     * Triggered when the editor receives a drop event."
                },
                {
                  "lineNumber": 6957,
                  "content": "     * Check for &#96;evt.defaultPrevented&#96; before attempting to handle this event, and return if it has been already handled."
                },
                {
                  "lineNumber": 6958,
                  "content": "     * Use &#96;evt.preventDefault()&#96; to indicate that you've handled the event."
                },
                {
                  "lineNumber": 7011,
                  "content": "export abstract class WorkspaceItem extends Events {"
                }
              ]
            }
          ],
          "totalLines": 37,
          "totalMatchedLines": 37
        }
      }
    }
  }
}
```
Status: **completed**


</details>
</tool-use>

---





---

<tool-use data-tool-type="unknown" data-tool-name="web_fetch">
<details>
<summary>Tool use: **web_fetch**</summary>


Parameters:

```json
{
  "url": "https://docs.obsidian.md/Plugins/User+interface/Context+menus"
}
```
Result:

```json
{
  "url": "https://docs.obsidian.md/Plugins/User+interface/Context+menus",
  "markdown": "Context menus - Developer Documentation\n[![](https://publish-01.obsidian.md/access/caa27d6312fe5c26ebc657cc609543be/Assets/obsidian-lockup-docs.svg)](https://docs.obsidian.md/Home)[Developer Documentation](https://docs.obsidian.md/Home)\nPlugins\nGetting started\nGuides\nUser interface\n[About user interface](https://docs.obsidian.md/Plugins/User+interface/About+user+interface)\n[Commands](https://docs.obsidian.md/Plugins/User+interface/Commands)\n[Context menus](https://docs.obsidian.md/Plugins/User+interface/Context+menus)\n[HTML elements](https://docs.obsidian.md/Plugins/User+interface/HTML+elements)\n[Icons](https://docs.obsidian.md/Plugins/User+interface/Icons)\n[Modals](https://docs.obsidian.md/Plugins/User+interface/Modals)\n[Ribbon actions](https://docs.obsidian.md/Plugins/User+interface/Ribbon+actions)\n[Right-to-left](https://docs.obsidian.md/Plugins/User+interface/Right-to-left)\n[Settings](https://docs.obsidian.md/Plugins/User+interface/Settings)\n[Status bar](https://docs.obsidian.md/Plugins/User+interface/Status+bar)\n[Views](https://docs.obsidian.md/Plugins/User+interface/Views)\n[Workspace](https://docs.obsidian.md/Plugins/User+interface/Workspace)\nEditor\nReleasing\n[Events](https://docs.obsidian.md/Plugins/Events)\n[Vault](https://docs.obsidian.md/Plugins/Vault)\nThemes\nReference\n[Developer policies](https://docs.obsidian.md/Developer+policies)\n[Home](https://docs.obsidian.md/Home)\n[![](https://publish-01.obsidian.md/access/caa27d6312fe5c26ebc657cc609543be/Assets/obsidian-lockup-docs.svg)](https://docs.obsidian.md/Home)[Developer Documentation](https://docs.obsidian.md/Home)\n# Context menus\nIf you want to open up a context menu, use[Menu](https://docs.obsidian.md/Reference/TypeScript+API/Menu):\n&#96;&#96;&#96;\n&#96;import{Menu,Notice,Plugin}from'obsidian';exportdefaultclassExamplePluginextendsPlugin{asynconload(){this.addRibbonIcon('dice','Open menu',(event)=&amp;gt;{constmenu=newMenu();menu.addItem((item)=&amp;gt;item.setTitle('Copy').setIcon('documents').onClick(()=&amp;gt;{newNotice('Copied');}));menu.addItem((item)=&amp;gt;item.setTitle('Paste').setIcon('paste').onClick(()=&amp;gt;{newNotice('Pasted');}));menu.showAtMouseEvent(event);});}}&#96;\n&#96;&#96;&#96;\n[showAtMouseEvent()](https://docs.obsidian.md/Reference/TypeScript+API/Menu/showAtMouseEvent)opens the menu where you clicked with the mouse.\nTip\nIf you need more control of where the menu appears, you can use&#96;menu.showAtPosition({ x: 20, y: 20 })&#96;to open the menu at a position relative to the top-left corner of the Obsidian window.\nFor more information on what icons you can use, refer to[Icons](https://docs.obsidian.md/Plugins/User+interface/Icons).\nYou can also add an item to the file menu, or the editor menu, by subscribing to the&#96;file-menu&#96;and&#96;editor-menu&#96;workspace events:\n![context-menu-positions.png](https://publish-01.obsidian.md/access/caa27d6312fe5c26ebc657cc609543be/Assets/context-menu-positions.png)\n&#96;&#96;&#96;\n&#96;import{Notice,Plugin}from'obsidian';exportdefaultclassExamplePluginextendsPlugin{asynconload(){this.registerEvent(this.app.workspace.on('file-menu',(menu,file)=&amp;gt;{menu.addItem((item)=&amp;gt;{item.setTitle('Print file path 👈').setIcon('document').onClick(async()=&amp;gt;{newNotice(file.path);});});}));this.registerEvent(this.app.workspace.on(\"editor-menu\",(menu,editor,view)=&amp;gt;{menu.addItem((item)=&amp;gt;{item.setTitle('Print file path 👈').setIcon('document').onClick(async()=&amp;gt;{newNotice(view.file.path);});});}));}}&#96;\n&#96;&#96;&#96;\nFor more information on handling events, refer to[Events](https://docs.obsidian.md/Plugins/Events).\nContext menus\nNot found\nThis page does not exist\nInteractive graph\nOn this page\n[Powered by Obsidian Publish](https://publish.obsidian.md)"
}
```
User decision: **accepted**

Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="web_fetch">
<details>
<summary>Tool use: **web_fetch**</summary>


Parameters:

```json
{
  "url": "https://docs.obsidian.md/Plugins/Events"
}
```
Result:

```json
{
  "url": "https://docs.obsidian.md/Plugins/Events",
  "markdown": "Events - Developer Documentation\n[![](https://publish-01.obsidian.md/access/caa27d6312fe5c26ebc657cc609543be/Assets/obsidian-lockup-docs.svg)](https://docs.obsidian.md/Home)[Developer Documentation](https://docs.obsidian.md/Home)\nPlugins\nGetting started\nGuides\nUser interface\nEditor\nReleasing\n[Events](https://docs.obsidian.md/Plugins/Events)\n[Vault](https://docs.obsidian.md/Plugins/Vault)\nThemes\nReference\n[Developer policies](https://docs.obsidian.md/Developer+policies)\n[Home](https://docs.obsidian.md/Home)\n[![](https://publish-01.obsidian.md/access/caa27d6312fe5c26ebc657cc609543be/Assets/obsidian-lockup-docs.svg)](https://docs.obsidian.md/Home)[Developer Documentation](https://docs.obsidian.md/Home)\n# Events\nMany of the interfaces in the Obsidian lets you subscribe to events throughout the application, for example when the user makes changes to a file.\nAny registered event handlers need to be detached whenever the plugin unloads. The safest way to make sure this happens is to use the[registerEvent()](https://docs.obsidian.md/Reference/TypeScript+API/Component/registerEvent)method.\n&#96;&#96;&#96;\n&#96;import{Plugin}from'obsidian';exportdefaultclassExamplePluginextendsPlugin{asynconload(){this.registerEvent(this.app.vault.on('create',()=&amp;gt;{console.log('a new file has entered the arena')}));}}&#96;\n&#96;&#96;&#96;\n## Timing events\nIf you want to repeatedly call a function with a fixed delay, use the[&#96;window.setInterval()&#96;](https://developer.mozilla.org/en-US/docs/Web/API/setInterval)function with the[registerInterval()](https://docs.obsidian.md/Reference/TypeScript+API/Component/registerInterval)method.\nThe following example displays the current time in the status bar, updated every second:\n&#96;&#96;&#96;\n&#96;import{moment,Plugin}from'obsidian';exportdefaultclassExamplePluginextendsPlugin{statusBar:HTMLElement;asynconload(){this.statusBar=this.addStatusBarItem();this.updateStatusBar();this.registerInterval(window.setInterval(()=&amp;gt;this.updateStatusBar(),1000));}updateStatusBar(){this.statusBar.setText(moment().format('H:mm:ss'));}}&#96;\n&#96;&#96;&#96;\nDate and time\n[Moment](https://momentjs.com/)is a popular JavaScript library for working with dates and time. Obsidian uses Moment internally, so you don't need to install it yourself. You can import it from the Obsidian API instead:\n&#96;&#96;&#96;\n&#96;import{moment}from'obsidian';&#96;\n&#96;&#96;&#96;\nLinks to this page\n[Context menus](https://docs.obsidian.md/Plugins/User+interface/Context+menus)\nEvents\nNot found\nThis page does not exist\nInteractive graph\nOn this page\nTiming events\n[Powered by Obsidian Publish](https://publish.obsidian.md)"
}
```
User decision: **accepted**

Status: **completed**


</details>
</tool-use>

---


Searching for Canvas view types and how the canvas builds its context menu:


---

<tool-use data-tool-type="unknown" data-tool-name="ripgrep_raw_search">
<details>
<summary>Tool use: **ripgrep_raw_search**</summary>


Parameters:

```json
{
  "pattern": "Canvas|canvas",
  "path": "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/node_modules/obsidian/obsidian.d.ts",
  "contextBefore": 0,
  "contextAfter": 2,
  "caseInsensitive": false
}
```
Result:

```json
{
  "success": {
    "pattern": "Canvas|canvas",
    "path": "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/node_modules/obsidian/obsidian.d.ts",
    "outputMode": "content",
    "workspaceResults": {
      "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board": {
        "content": {}
      }
    }
  }
}
```
Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="search" data-tool-name="web_search">
<details>
            <summary>Tool use: **web_search** • Searched web `undefined` • **1** results</summary>
        
| Title | URL | Chunk |
|-------|-----|-------|
| Web search results for query: Obsidian canvas plugin add context menu to node right click 2024 |  | Links:<br/>1. [Search code, repositories, users, issues, pull requests...](https://github.com/phibr0/obsidian-extended-context-menu)<br/>2. [Search code, repositories, users, issues, pull requests...](https://github.com/kzhovn/obsidian-customizable-menu)<br/>3. [Context menus](https://docs.obsidian.md/Plugins/User+interface/Context+menus)<br/>4. [Search code, repositories, users, issues, pull requests...](https://github.com/borolgs/enchanted-canvas)<br/>5. [Search code, repositories, users, issues, pull requests...](https://github.com/developer-mike/obsidian-advanced-canvas)<br/><br/># Obsidian Canvas Plugin Context Menu Solutions<br/><br/>For adding context menus to canvas nodes on right-click in Obsidian, here are the available options:<br/><br/>## Canvas Enhancement Plugins<br/><br/>**Enchanted Canvas** [4] and **Advanced Canvas** [5] are plugins that extend Obsidian's standard canvas functionality. While the search results don't provide specific details about their context menu implementations, these are active canvas extension plugins that may offer node context menu features.<br/><br/>## General Context Menu Customization<br/><br/>**Customizable Menu** [2] allows you to add commands to Obsidian's right-click context menu with custom icons, though this is broader than canvas-specific functionality.<br/><br/>## Developer Resources<br/><br/>The official Obsidian developer documentation references context menus [3], though the specific documentation page appears incomplete in the search results. For plugin development, the Extended Context Menu project [1] (archived as of June 2022) previously provided an API for creating custom context menus without conflicts, though it's no longer maintained.<br/><br/>**Note:** The search results don't contain specific 2024 documentation or tutorials for implementing context menus on canvas nodes. You may need to check the active plugins' repositories directly or review the Obsidian plugin API documentation for current implementation methods. |

</details>
</tool-use>

---





---

Fetch timed out while retrieving content

---

<tool-use data-tool-type="unknown" data-tool-name="ripgrep_raw_search">
<details>
<summary>Tool use: **ripgrep_raw_search**</summary>


Parameters:

```json
{
  "pattern": "workspace\\.on|\\.on\\(",
  "path": "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/node_modules/obsidian/obsidian.d.ts",
  "contextBefore": 1,
  "contextAfter": 1,
  "caseInsensitive": false
}
```
Result:

```json
{
  "success": {
    "pattern": "workspace\\.on|\\.on\\(",
    "path": "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/node_modules/obsidian/obsidian.d.ts",
    "outputMode": "content",
    "workspaceResults": {
      "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board": {
        "content": {}
      }
    }
  }
}
```
Status: **completed**


</details>
</tool-use>

---


Checking how the Workspace Events class triggers events (to see the event name format):


---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/node_modules/obsidian/obsidian.d.ts</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="ripgrep_raw_search">
<details>
<summary>Tool use: **ripgrep_raw_search**</summary>


Parameters:

```json
{
  "pattern": "\"canvas|'canvas",
  "path": "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board",
  "caseInsensitive": false
}
```
Result:

```json
{
  "success": {
    "pattern": "\"canvas|'canvas",
    "path": "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board",
    "outputMode": "content",
    "workspaceResults": {
      "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board": {
        "content": {
          "matches": [
            {
              "file": "./src/main.ts",
              "matches": [
                {
                  "lineNumber": 75,
                  "content": "\t\t\t// Canvas node context menu (event \"canvas:node-menu\" is undocumented in Obsidian API)."
                },
                {
                  "lineNumber": 84,
                  "content": "\t\t\t\t\t\tonCanvasNodeMenu(\"canvas:node-menu\", (menu: Menu, node: unknown) =&gt; {"
                },
                {
                  "lineNumber": 109,
                  "content": "\t\t\t\t\tconst leaves = this.app.workspace.getLeavesOfType(\"canvas\");"
                },
                {
                  "lineNumber": 163,
                  "content": "\t\tif (v.getViewType?.() !== \"canvas\") return null;"
                }
              ]
            },
            {
              "file": "./src/engine/state.test.ts",
              "matches": [
                {
                  "lineNumber": 20,
                  "content": "\t\texpect(getCanvasKey(\"canvas.md\")).toBe(\"canvas.md\");"
                }
              ]
            }
          ],
          "totalLines": 5,
          "totalMatchedLines": 5
        }
      }
    }
  }
}
```
Status: **completed**


</details>
</tool-use>

---


Adding minimal debug to verify the plugin runs and whether the canvas node menu event fires. Implementing a debug command and targeted logging.


---

<tool-use data-tool-type="task" data-tool-name="todo_write">
<details><summary>Tool use: **todo_write** • Todo List</summary>

- [-] Add debug state and active-leaf-change to verify we detect canvas
- [ ] Add debug command to report canvas active + node-menu-fired state

</details>
</tool-use>

---





---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** • Edit file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/main.ts</summary>

</details>

</tool-use>

---





---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** • Edit file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/main.ts</summary>

</details>

</tool-use>

---





---

<tool-use data-tool-type="search" data-tool-name="web_search">
<details>
            <summary>Tool use: **web_search** • Searched web `undefined` • **1** results</summary>
        
| Title | URL | Chunk |
|-------|-----|-------|
| Web search results for query: Obsidian app.workspace.trigger "canvas" context menu node source code |  | Links:<br/>1. [Search code, repositories, users, issues, pull requests...](https://github.com/obsidianmd/obsidian-api/blob/master/canvas.d.ts)<br/>2. [Context menus](https://docs.obsidian.md/Plugins/User+interface/Context+menus)<br/>3. [Search code, repositories, users, issues, pull requests...](https://github.com/phibr0/obsidian-extended-context-menu)<br/>4. [Workspace - Developer Documentation](https://docs.obsidian.md/Plugins/User+interface/Workspace)<br/>5. [Search code, repositories, users, issues, pull requests...](https://github.com/michaellw/Obsidian-Canvas-Style-Menu)<br/><br/>Based on the search results, I cannot find specific information about the `app.workspace.trigger("canvas")` context menu node source code that you're looking for.<br/><br/>What I can tell you:<br/><br/>The Obsidian API includes canvas type definitions in `canvas.d.ts`[1], which defines data structures for canvas nodes including `CanvasNodeData` and various node types (`CanvasFileData`, `CanvasTextData`, `CanvasLinkData`, `CanvasGroupData`). However, the search results don't show the actual implementation of workspace triggers for canvas context menus.<br/><br/>The Obsidian developer documentation mentions a "Context menus" page[2], but the actual content appears to be unavailable. The Workspace documentation[4] covers general workspace structure but doesn't specifically address canvas context menu triggers.<br/><br/>To find the source code you're looking for, you may need to:<br/>- Check the full `canvas.d.ts` file on GitHub[1] directly<br/>- Look at the Obsidian plugin API repository for workspace event triggers<br/>- Review plugin examples that implement canvas context menus, such as the Canvas Style Menu plugin[5] |

</details>
</tool-use>

---

<tool-use data-tool-type="task" data-tool-name="todo_write">
<details><summary>Tool use: **todo_write** • Todo List</summary>

- [!] Add debug state and active-leaf-change to verify we detect canvas
- [x] Add debug command to report canvas active + node-menu-fired state

</details>
</tool-use>

---





---

<tool-use data-tool-type="unknown" data-tool-name="web_fetch">
<details>
<summary>Tool use: **web_fetch**</summary>


Parameters:

```json
{
  "url": "https://raw.githubusercontent.com/obsidianmd/obsidian-api/master/obsidian.d.ts"
}
```
Additional data:

```json
{
  "reasonForAcceptReject": {
    "type": "outOfWorkspace"
  },
  "blockReason": "outOfWorkspace"
}
```
Result:

```json
{
  "url": "https://raw.githubusercontent.com/obsidianmd/obsidian-api/master/obsidian.d.ts",
  "markdown": "/**\n * This file is automatically generated.\n * Please do not modify or send pull requests for it.\n */\n\nimport { Extension, StateField } from '@codemirror/state';\nimport { EditorView, ViewPlugin } from '@codemirror/view';\nimport * as Moment from 'moment';\n\ndeclare global {\n interface ObjectConstructor {\n isEmpty(object: Record): boolean;\n each (object: {\n [key: string]: T;\n }, callback: (value: T, key?: string) =&gt; boolean | void, context?: any): boolean;\n }\n interface ArrayConstructor {\n combine (arrays: T[][]): T[];\n }\n interface Array {\n first(): T | undefined;\n last(): T | undefined;\n contains(target: T): boolean;\n remove(target: T): void;\n shuffle(): this;\n unique(): T[];\n /**\n *\n * @since 1.4.4\n */\n findLastIndex(predicate: (value: T) =&gt; boolean): number;\n }\n interface Math {\n clamp(value: number, min: number, max: number): number;\n square(value: number): number;\n }\n interface StringConstructor {\n isString(obj: any): obj is string;\n }\n interface String {\n contains(target: string): boolean;\n startsWith(searchString: string, position?: number): boolean;\n endsWith(target: string, length?: number): boolean;\n format(...args: string[]): string;\n }\n interface NumberConstructor {\n isNumber(obj: any): obj is number;\n }\n interface Node {\n detach(): void;\n empty(): void;\n insertAfter (node: T, child: Node | null): T;\n indexOf(other: Node): number;\n setChildrenInPlace(children: Node[]): void;\n appendText(val: string): void;\n /**\n * Cross-window capable instanceof check, a drop-in replacement\n * for instanceof checks on DOM Nodes. Remember to also check\n * for nulls when necessary.\n * @param type\n */\n instanceOf (type: {\n new (): T;\n }): this is T;\n /**\n * The document this node belongs to, or the global document.\n */\n doc: Document;\n /**\n * The window object this node belongs to, or the global window.\n */\n win: Window;\n constructorWin: Window;\n }\n interface Element extends Node {\n getText(): string;\n setText(val: string | DocumentFragment): void;\n addClass(...classes: string[]): void;\n addClasses(classes: string[]): void;\n removeClass(...classes: string[]): void;\n removeClasses(classes: string[]): void;\n toggleClass(classes: string | string[], value: boolean): void;\n hasClass(cls: string): boolean;\n setAttr(qualifiedName: string, value: string | number | boolean | null): void;\n setAttrs(obj: {\n [key: string]: string | number | boolean | null;\n }): void;\n getAttr(qualifiedName: string): string | null;\n matchParent(selector: string, lastParent?: Element): Element | null;\n getCssPropertyValue(property: string, pseudoElement?: string): string;\n isActiveElement(): boolean;\n }\n interface HTMLElement extends Element {\n show(): void;\n hide(): void;\n toggle(show: boolean): void;\n toggleVisibility(visible: boolean): void;\n /**\n * Returns whether this element is shown, when the element is attached to the DOM and\n * none of the parent and ancestor elements are hidden with &#96;display: none&#96;.\n *\n * Exception: Does not work on &#96; &#96; and &#96; &#96;, or on elements with &#96;position: fixed&#96;.\n */\n isShown(): boolean;\n setCssStyles(styles: Partial): void;\n setCssProps(props: Record): void;\n /**\n * Get the inner width of this element without padding.\n */\n readonly innerWidth: number;\n /**\n * Get the inner height of this element without padding.\n */\n readonly innerHeight: number;\n }\n interface SVGElement extends Element {\n setCssStyles(styles: Partial): void;\n setCssProps(props: Record): void;\n }\n function isBoolean(obj: any): obj is boolean;\n function fish(selector: string): HTMLElement | null;\n function fishAll(selector: string): HTMLElement[];\n interface Element extends Node {\n find(selector: string): Element | null;\n findAll(selector: string): HTMLElement[];\n findAllSelf(selector: string): HTMLElement[];\n }\n interface HTMLElement extends Element {\n find(selector: string): HTMLElement;\n findAll(selector: string): HTMLElement[];\n findAllSelf(selector: string): HTMLElement[];\n }\n interface DocumentFragment extends Node, NonElementParentNode, ParentNode {\n find(selector: string): HTMLElement;\n findAll(selector: string): HTMLElement[];\n }\n interface DomElementInfo {\n /**\n * The class to be assigned. Can be a space-separated string or an array of strings.\n */\n cls?: string | string[];\n /**\n * The textContent to be assigned.\n */\n text?: string | DocumentFragment;\n /**\n * HTML attributes to be added.\n */\n attr?: {\n [key: string]: string | number | boolean | null;\n };\n /**\n * HTML title (for hover tooltip).\n */\n title?: string;\n /**\n * The parent element to be assigned to.\n */\n parent?: Node;\n value?: string;\n type?: string;\n prepend?: boolean;\n placeholder?: string;\n href?: string;\n }\n interface SvgElementInfo {\n /**\n * The class to be assigned. Can be a space-separated string or an array of strings.\n */\n cls?: string | string[];\n /**\n * HTML attributes to be added.\n */\n attr?: {\n [key: string]: string | number | boolean | null;\n };\n /**\n * The parent element to be assigned to.\n */\n parent?: Node;\n prepend?: boolean;\n }\n interface Node {\n /**\n * Create an element and append it to this node.\n */\n createEl (tag: K, o?: DomElementInfo | string, callback?: (el: HTMLElementTagNameMap[K]) =&gt; void): HTMLElementTagNameMap[K];\n createDiv(o?: DomElementInfo | string, callback?: (el: HTMLDivElement) =&gt; void): HTMLDivElement;\n createSpan(o?: DomElementInfo | string, callback?: (el: HTMLSpanElement) =&gt; void): HTMLSpanElement;\n createSvg (tag: K, o?: SvgElementInfo | string, callback?: (el: SVGElementTagNameMap[K]) =&gt; void): SVGElementTagNameMap[K];\n }\n function createEl (tag: K, o?: DomElementInfo | string, callback?: (el: HTMLElementTagNameMap[K]) =&gt; void): HTMLElementTagNameMap[K];\n function createDiv(o?: DomElementInfo | string, callback?: (el: HTMLDivElement) =&gt; void): HTMLDivElement;\n function createSpan(o?: DomElementInfo | string, callback?: (el: HTMLSpanElement) =&gt; void): HTMLSpanElement;\n function createSvg (tag: K, o?: SvgElementInfo | string, callback?: (el: SVGElementTagNameMap[K]) =&gt; void): SVGElementTagNameMap[K];\n function createFragment(callback?: (el: DocumentFragment) =&gt; void): DocumentFragment;\n interface EventListenerInfo {\n selector: string;\n listener: Function;\n options?: boolean | AddEventListenerOptions;\n callback: Function;\n }\n interface HTMLElement extends Element {\n _EVENTS?: {\n [K in keyof HTMLElementEventMap]?: EventListenerInfo[];\n };\n on (this: HTMLElement, type: K, selector: string, listener: (this: HTMLElement, ev: HTMLElementEventMap[K], delegateTarget: HTMLElement) =&gt; any, options?: boolean | AddEventListenerOptions): void;\n off (this: HTMLElement, type: K, selector: string, listener: (this: HTMLElement, ev: HTMLElementEventMap[K], delegateTarget: HTMLElement) =&gt; any, options?: boolean | AddEventListenerOptions): void;\n onClickEvent(this: HTMLElement, listener: (this: HTMLElement, ev: MouseEvent) =&gt; any, options?: boolean | AddEventListenerOptions): void;\n /**\n * @param listener - the callback to call when this node is inserted into the DOM.\n * @param once - if true, this will only fire once and then unhook itself.\n * @returns destroy - a function to remove the event handler to avoid memory leaks.\n */\n onNodeInserted(this: HTMLElement, listener: () =&gt; any, once?: boolean): () =&gt; void;\n /**\n * @param listener - the callback to call when this node has been migrated to another window.\n * @returns destroy - a function to remove the event handler to avoid memory leaks.\n */\n onWindowMigrated(this: HTMLElement, listener: (win: Window) =&gt; any): () =&gt; void;\n trigger(eventType: string): void;\n }\n interface Document {\n _EVENTS?: {\n [K in keyof DocumentEventMap]?: EventListenerInfo[];\n };\n on (this: Document, type: K, selector: string, listener: (this: Document, ev: DocumentEventMap[K], delegateTarget: HTMLElement) =&gt; any, options?: boolean | AddEventListenerOptions): void;\n off (this: Document, type: K, selector: string, listener: (this: Document, ev: DocumentEventMap[K], delegateTarget: HTMLElement) =&gt; any, options?: boolean | AddEventListenerOptions): void;\n }\n interface UIEvent extends Event {\n targetNode: Node | null;\n win: Window;\n doc: Document;\n /**\n * Cross-window capable instanceof check, a drop-in replacement\n * for instanceof checks on UIEvents.\n * @param type\n */\n instanceOf (type: {\n new (...data: any[]): T;\n }): this is T;\n }\n interface AjaxOptions {\n method?: 'GET' | 'POST';\n url: string;\n success?: (response: any, req: XMLHttpRequest) =&gt; any;\n error?: (error: any, req: XMLHttpRequest) =&gt; any;\n data?: object | string | ArrayBuffer;\n headers?: Record;\n withCredentials?: boolean;\n req?: XMLHttpRequest;\n }\n function ajax(options: AjaxOptions): void;\n function ajaxPromise(options: AjaxOptions): Promise;\n function ready(fn: () =&gt; any): void;\n function sleep(ms: number): Promise;\n function nextFrame(): Promise;\n /**\n * The actively focused Window object. This is usually the same as &#96;window&#96; but\n * it will be different when using popout windows.\n */\n let activeWindow: Window;\n /**\n * The actively focused Document object. This is usually the same as &#96;document&#96; but\n * it will be different when using popout windows.\n */\n let activeDocument: Document;\n interface Window extends EventTarget, AnimationFrameProvider, GlobalEventHandlers, WindowEventHandlers, WindowLocalStorage, WindowOrWorkerGlobalScope, WindowSessionStorage {\n /**\n * The actively focused Window object. This is usually the same as &#96;window&#96; but\n * it will be different when using popout windows.\n */\n activeWindow: Window;\n /**\n * The actively focused Document object. This is usually the same as &#96;document&#96; but\n * it will be different when using popout windows.\n */\n activeDocument: Document;\n sleep(ms: number): Promise;\n nextFrame(): Promise;\n }\n interface Touch {\n touchType: 'stylus' | 'direct';\n }\n}\n\n/**\n * Attach to an &#96; &#96; element or a &#96; &#96; to add type-ahead\n * support.\n *\n * @public\n * @since 1.4.10\n */\nexport abstract class AbstractInputSuggest extends PopoverSuggest {\n\n /**\n * Limit to the number of elements rendered at once. Set to 0 to disable. Defaults to 100.\n * @public\n * @since 1.4.10\n */\n limit: number;\n /**\n * Accepts an &#96; &#96; text box or a contenteditable div.\n * @public\n */\n constructor(app: App, textInputEl: HTMLInputElement | HTMLDivElement);\n\n /**\n * Sets the value into the input element.\n * @public\n * @since 1.4.10\n */\n setValue(value: string): void;\n /**\n * Gets the value from the input element.\n * @public\n * @since 1.4.10\n */\n getValue(): string;\n\n /**\n * @public\n * @since 1.5.7\n */\n protected abstract getSuggestions(query: string): T[] | Promise;\n /**\n * @public\n * @since 1.6.6\n */\n selectSuggestion(value: T, evt: MouseEvent | KeyboardEvent): void;\n /**\n * Registers a callback to handle when a suggestion is selected by the user.\n * @public\n * @since 1.4.10\n */\n onSelect(callback: (value: T, evt: MouseEvent | KeyboardEvent) =&gt; any): this;\n\n}\n\n/**\n * @public\n * @since 0.9.21\n */\nexport class AbstractTextComponent extends ValueComponent {\n /**\n * @public\n * @since 0.9.7\n */\n inputEl: T;\n\n /**\n * @public\n */\n constructor(inputEl: T);\n /**\n * @public\n * @since 1.2.3\n */\n setDisabled(disabled: boolean): this;\n /**\n * @public\n * @since 0.9.7\n */\n getValue(): string;\n /**\n * @public\n * @since 0.9.7\n */\n setValue(value: string): this;\n /**\n * @public\n * @since 0.9.7\n */\n setPlaceholder(placeholder: string): this;\n /**\n * @public\n * @since 0.9.21\n */\n onChanged(): void;\n /**\n * @public\n * @since 0.9.7\n */\n onChange(callback: (value: string) =&gt; any): this;\n}\n\n/**\n * Adds an icon to the library.\n * @param iconId - the icon ID\n * @param svgContent - the content of the SVG.\n * @public\n */\nexport function addIcon(iconId: string, svgContent: string): void;\n\n/**\n * This is the API version of the app, which follows the release cycle of the desktop app.\n * Example: '0.13.21'\n * @public\n */\nexport let apiVersion: string;\n\n/**\n * @public\n * @since 0.9.7\n */\nexport class App {\n\n /**\n * @public\n * @since 0.9.7\n */\n keymap: Keymap;\n /**\n * @public\n * @since 0.9.7\n */\n scope: Scope;\n\n /**\n * @public\n * @since 0.9.7\n */\n workspace: Workspace;\n\n /**\n * @public\n * @since 0.9.7\n */\n vault: Vault;\n /**\n * @public\n * @since 0.9.7\n */\n metadataCache: MetadataCache;\n\n /**\n * @public\n * @since 0.11.0\n */\n fileManager: FileManager;\n\n /**\n * The last known user interaction event, to help commands find out what modifier keys are pressed.\n * @public\n * @since 0.12.17\n */\n lastEvent: UserEvent | null;\n\n /**\n * @public\n * @since 1.10.0\n */\n renderContext: RenderContext;\n /**\n * @public\n * @since 1.11.4\n */\n secretStorage: SecretStorage;\n\n /**\n * @public\n * @since 1.10.0\n */\n isDarkMode(): boolean;\n\n /**\n * Retrieve value from &#96;localStorage&#96; for this vault.\n * @param key\n * @public\n * @since 1.8.7\n */\n loadLocalStorage(key: string): any | null;\n /**\n * Save vault-specific value to &#96;localStorage&#96;. If data is &#96;null&#96;, the entry will be cleared.\n * @param key\n * @param data value being saved to localStorage. Must be serializable.\n * @public\n * @since 1.8.7\n */\n saveLocalStorage(key: string, data: unknown | null): void;\n\n}\n\n/** @public */\nexport function arrayBufferToBase64(buffer: ArrayBuffer): string;\n\n/** @public */\nexport function arrayBufferToHex(data: ArrayBuffer): string;\n\n/** @public */\nexport function base64ToArrayBuffer(base64: string): ArrayBuffer;\n\n/**\n * @public\n * @since 0.10.3\n */\nexport abstract class BaseComponent {\n /**\n * @public\n * @since 0.10.3\n */\n disabled: boolean;\n /**\n * Facilitates chaining\n * @public\n * @since 0.9.7\n */\n then(cb: (component: this) =&gt; any): this;\n /**\n * @public\n * @since 1.2.3\n */\n setDisabled(disabled: boolean): this;\n}\n\n/**\n * @public\n * @since 1.10.0\n */\nexport interface BaseOption {\n /**\n * @public\n * @since 1.10.0\n */\n key: string;\n /**\n * @public\n * @since 1.10.0\n */\n type: string;\n /**\n * @public\n * @since 1.10.0\n */\n displayName: string;\n /**\n * If provided, the option will be hidden if the function returns true.\n *\n * @public\n * @since 1.10.2\n * @param config - Read-only copy of the current view configuration.\n */\n shouldHide?: (config: BasesViewConfig) =&gt; boolean;\n}\n\n/**\n * Represents the serialized format of a Bases query as stored in a &#96;.base&#96; file.\n *\n * @public\n * @since 1.10.0\n */\nexport interface BasesConfigFile {\n /**\n * @public\n * @since 1.10.0\n */\n filters?: BasesConfigFileFilter;\n\n /**\n * Configuration for properties in this Base.\n *\n * Valid keys for this object currently include:\n *\n * - displayName: string\n *\n * @public\n * @since 1.10.0\n */\n properties?: Record &gt;;\n /**\n * Configuration for formulas used in this Base.\n *\n * Key: Formula property name.\n * Value: Formula string.\n *\n * @public\n * @since 1.10.0\n */\n formulas?: Record;\n /**\n * Configuration for summary formulas used in this Base.\n *\n * Key: Summary formula name.\n * Value: Formula string.\n *\n * @public\n * @since 1.10.0\n */\n summaries?: Record;\n /**\n * Configuration for views used in this Base.\n *\n * @public\n * @since 1.10.0\n */\n views?: BasesConfigFileView[];\n\n}\n\n/**\n * @public\n * @since 1.10.0\n */\nexport type BasesConfigFileFilter = string | {\n /**\n * @public\n * @since 1.10.0\n */\n and: BasesConfigFileFilter[];\n} | {\n /**\n * @public\n * @since 1.10.0\n */\n or: BasesConfigFileFilter[];\n} | {\n /**\n * @public\n * @since 1.10.0\n */\n not: BasesConfigFileFilter[];\n};\n\n/**\n * @public\n * @since 1.10.0\n */\nexport interface BasesConfigFileView {\n /**\n * Unique identifier for the view type. Used to select the correct view renderer.\n *\n * @public\n * @since 1.10.0\n */\n type: string;\n /**\n * Friendly name for this view, displayed in the UI to select between views.\n *\n * @public\n * @since 1.10.0\n */\n name: string;\n /**\n * Additional filters, applied only to this view.\n *\n * @public\n * @since 1.10.0\n */\n filters?: BasesConfigFileFilter;\n /**\n * Configuration for grouping the results of this view.\n *\n * @public\n * @since 1.10.0\n */\n groupBy?: {\n\n };\n /**\n * An ordered list of the properties to display in this view.\n *\n * @public\n * @since 1.10.0\n */\n order?: string[];\n /**\n * Configuration of summaries to display for each property in this view.\n *\n * Key: Property name.\n * Value: Summary formula name.\n *\n * @public\n * @since 1.10.0\n */\n summaries?: Record;\n\n}\n\n/**\n * Represent a single \"row\" or file in a base.\n * @public\n * @since 1.10.0\n */\nexport class BasesEntry implements FormulaContext {\n\n /**\n * @public\n * @since 1.10.0\n */\n file: TFile;\n\n /**\n * Get the value of the property.\n * Note: Errors are returned as {@link ErrorValue}\n * @public\n * @since 1.10.0\n */\n getValue(propertyId: BasesPropertyId): Value | null;\n\n}\n\n/**\n * A group of BasesEntry objects for a given value of the groupBy key.\n * If there are entries in the results which do not have a value for the\n * groupBy key, the key will be the {@link NullValue}.\n * @public\n * @since 1.10.0\n */\nexport class BasesEntryGroup {\n /**\n * The value of the groupBy key for this entry group.\n * @public\n * @since 1.10.0\n */\n key?: Value;\n /**\n * @public\n * @since 1.10.0\n */\n entries: BasesEntry[];\n\n /**\n * @returns true iff this entry group has a non-null key.\n * @public\n * @since 1.10.0\n */\n hasKey(): boolean;\n}\n\n/**\n * A parsed version of the {@link BasesPropertyId}.\n *\n * @public\n * @since 1.10.0\n */\nexport interface BasesProperty {\n /**\n * @public\n * @since 1.10.0\n */\n type: BasesPropertyType;\n /**\n * @public\n * @since 1.10.0\n */\n name: string;\n}\n\n/**\n * The full ID of a property, used in the bases config file. The prefixed\n * {@link BasesPropertyType} disambiguates properties of the same name but from different sources.\n *\n * @public\n * @since 1.10.0\n */\nexport type BasesPropertyId = &#96;${BasesPropertyType}.${string}&#96;;\n\n/**\n * The three valid \"sources\" of a property in a Base.\n *\n * - &#96;note&#96;: Properties from the frontmatter of markdown files in the vault.\n * - &#96;formula&#96;: Properties calculated by evaluating a formula from the base config file.\n * - &#96;file&#96;: Properties inherent to a file, such as the name, extension, size, etc.\n *\n * @public\n * @since 1.10.0\n */\nexport type BasesPropertyType = 'note' | 'formula' | 'file';\n\n/**\n * The BasesQueryResult contains all of the available information from executing the\n * bases query, applying filters, and evaluating formulas. The &#96;data&#96; or &#96;groupedData&#96;\n * should be displayed by your view.\n *\n * @public\n * @since 1.10.0\n */\nexport class BasesQueryResult {\n\n /**\n * An ungrouped version of the data, with user-configured sort and limit applied.\n * Where appropriate, views should support groupBy by using &#96;groupedData&#96; instead of this value.\n *\n * @public\n * @since 1.10.0\n */\n data: BasesEntry[];\n\n /**\n * The data to be rendered, grouped according to the groupBy config.\n * If there is no groupBy configured, returns a single group with an empty key.\n * @public\n * @since 1.10.0\n */\n get groupedData(): BasesEntryGroup[];\n /**\n * Visible properties defined by the user.\n * @public\n * @since 1.10.0\n */\n get properties(): BasesPropertyId[];\n\n /**\n * Applies a summary function to a single property over a set of entries.\n * @public\n * @since 1.10.0\n */\n getSummaryValue(queryController: QueryController, entries: BasesEntry[], prop: BasesPropertyId, summaryKey: string): Value;\n}\n\n/**\n * @public\n * @since 1.10.0\n */\nexport type BasesSortConfig = {\n /**\n * @public\n * @since 1.10.0\n */\n property: BasesPropertyId;\n /**\n * @public\n * @since 1.10.0\n */\n direction: 'ASC' | 'DESC';\n};\n\n/**\n * Plugins can create a class which extends this in order to render a Base.\n * Plugins should create a {@link BaseViewHandlerFactory} function, then call\n * &#96;plugin.registerView&#96; to register the view factory.\n *\n * @public\n * @since 1.10.0\n */\nexport abstract class BasesView extends Component {\n /**\n * The type ID of this view\n * @public\n * @since 1.10.0\n */\n abstract type: string;\n /**\n * @public\n * @since 1.10.0\n */\n app: App;\n\n /**\n * The config object for this view.\n * @public\n * @since 1.10.0\n */\n config: BasesViewConfig;\n /**\n * All available properties from the dataset.\n * @public\n * @since 1.10.0\n */\n allProperties: BasesPropertyId[];\n /**\n * The most recent output from executing the bases query, applying filters, and evaluating formulas.\n * This object will be replaced with a new result set when changes to the vault or Bases config occur,\n * so views should not keep a reference to it. Also note the contained BasesEntry objects will be recreated.\n * @public\n * @since 1.10.0\n */\n data: BasesQueryResult;\n\n /**\n * @public\n * @since 1.10.0\n */\n protected constructor(controller: QueryController);\n /**\n * Called when there is new data for the query. This view should rerender with the updated data.\n * @public\n * @since 1.10.0\n */\n abstract onDataUpdated(): void;\n\n /**\n * Display the new note menu for a file with the provided filename and optionally a function to modify the frontmatter.\n * @public\n * @since 1.10.2\n */\n createFileForView(baseFileName?: string, frontmatterProcessor?: (frontmatter: any) =&gt; void): Promise;\n\n}\n\n/**\n * The in-memory representation of a single entry in the \"views\" section of a Bases file.\n * Contains settings and configuration options set by the user from the toolbar menus and view options.\n * @public\n * @since 1.10.0\n */\nexport class BasesViewConfig {\n\n /**\n * User-friendly name for this view.\n * @public\n * @since 1.10.0\n */\n name: string;\n\n /**\n * Retrieve the user-configured value of options exposed in &#96;BasesViewRegistration.options&#96;.\n * @public\n * @since 1.10.0\n */\n get(key: string): unknown;\n /**\n * Retrieve a user-configured value from the config, converting it to a BasesPropertyId.\n * Returns null if the requested key is not present in the config, or if the value is invalid.\n * @public\n * @since 1.10.0\n */\n getAsPropertyId(key: string): BasesPropertyId | null;\n /**\n * Retrieve a user-configured value from the config, evaluating it as a\n * formula in the context of the current Base. For embedded bases, or bases\n * in the sidebar, this means evaluating the formula against the currently\n * active file.\n *\n * @public\n * @returns the Value result from evaluating the formula, or NullValue if the formula is invalid, or the key is not present.\n * @since 1.10.2\n */\n getEvaluatedFormula(view: BasesView, key: string): Value;\n /**\n * Store configuration data for the view. Views should prefer &#96;BasesViewRegistration.options&#96;\n * to allow users to configure options where appropriate.\n * @public\n * @since 1.10.0\n */\n set(key: string, value: any | null): void;\n /**\n * Ordered list of properties to display in this view.\n * In a table, these can be interpreted as the list of visible columns.\n * Order is configured by the user through the properties toolbar menu.\n * @public\n * @since 1.10.0\n */\n getOrder(): BasesPropertyId[];\n\n /**\n * Retrieve the sorting config for this view. Sort is configured by the user through the sort toolbar menu.\n * Removes invalid sort configs. If no (valid) sort config, returns an empty array.\n * Does not validate that the properties exists.\n *\n * Note that data from BasesQueryResult will be presorted.\n *\n * @public\n * @since 1.10.0\n */\n getSort(): BasesSortConfig[];\n\n /**\n * Retrieve a friendly name for the provided property.\n * If the property has been renamed by the user in the Base config, that value is returned.\n * File properties may have a default name that is returned, otherwise the name with the property\n * type prefix removed is returned.\n *\n * @public\n * @since 1.10.0\n */\n getDisplayName(propertyId: BasesPropertyId): string;\n\n}\n\n/**\n * Implement this factory function in a {@link BasesViewRegistration} to create a\n * new instance of a custom Bases view.\n * @param containerEl - The container below the Bases toolbar where the view will be displayed.\n * @public\n * @since 1.10.0\n */\nexport type BasesViewFactory = (controller: QueryController, containerEl: HTMLElement) =&gt; BasesView;\n\n/**\n * Container for options when registering a new Bases view type.\n * @public\n * @since 1.10.0\n */\nexport interface BasesViewRegistration {\n /**\n * @public\n * @since 1.10.0\n */\n name: string;\n /**\n * Icon ID to be used in the Bases view selector.\n * See {@link https://docs.obsidian.md/Plugins/User+interface/Icons} for available icons and how to add your own.\n * @public\n * @since 1.10.0\n */\n icon: IconName;\n /**\n * @public\n * @since 1.10.0\n */\n factory: BasesViewFactory;\n /**\n * @public\n * @since 1.10.0\n */\n options?: () =&gt; ViewOption[];\n}\n\n/**\n * @public\n * @since 0.11.13\n */\nexport interface BlockCache extends CacheItem {\n /** @public */\n id: string;\n}\n\n/**\n * @public\n * @since 0.13.26\n */\nexport interface BlockSubpathResult extends SubpathResult {\n /**\n * @public\n */\n type: 'block';\n /**\n * @public\n */\n block: BlockCache;\n /**\n * @public\n */\n list?: ListItemCache;\n}\n\n/**\n * {@link Value} wrapping a boolean.\n * @public\n * @since 1.10.0\n */\nexport class BooleanValue extends PrimitiveValue {\n /**\n * @public\n * @since 1.10.0\n */\n static type: string;\n\n}\n\n/**\n * @public\n * @since 0.9.7\n */\nexport class ButtonComponent extends BaseComponent {\n /**\n * @public\n * @since 0.9.7\n */\n buttonEl: HTMLButtonElement;\n\n /**\n * @public\n */\n constructor(containerEl: HTMLElement);\n /**\n * @public\n * @since 1.2.3\n */\n setDisabled(disabled: boolean): this;\n\n /**\n * @public\n * @since 0.9.7\n */\n setCta(): this;\n /**\n * @public\n * @since 0.9.20\n */\n removeCta(): this;\n /**\n * @public\n * @since 0.11.0\n */\n setWarning(): this;\n /**\n * @public\n * @since 1.1.0\n */\n setTooltip(tooltip: string, options?: TooltipOptions): this;\n /**\n * @public\n * @since 0.9.7\n */\n setButtonText(name: string): this;\n /**\n * @public\n * @since 1.1.0\n */\n setIcon(icon: IconName): this;\n /**\n * @public\n * @since 0.9.7\n */\n setClass(cls: string): this;\n /**\n * @public\n * @since 0.12.16\n */\n onClick(callback: (evt: MouseEvent) =&gt; unknown | Promise): this;\n}\n\n/**\n * @public\n */\nexport interface CachedMetadata {\n /**\n * @public\n */\n links?: LinkCache[];\n /**\n * @public\n */\n embeds?: EmbedCache[];\n /**\n * @public\n */\n tags?: TagCache[];\n /**\n * @public\n */\n headings?: HeadingCache[];\n /**\n * @public\n * @since 1.6.6\n */\n footnotes?: FootnoteCache[];\n /**\n * @public\n * @since 1.8.7\n */\n footnoteRefs?: FootnoteRefCache[];\n /**\n * @public\n * @since 1.8.7\n */\n referenceLinks?: ReferenceLinkCache[];\n /**\n * Sections are root level markdown blocks, which can be used to divide the document up.\n * @public\n */\n sections?: SectionCache[];\n /**\n * @public\n */\n listItems?: ListItemCache[];\n /**\n * @public\n */\n frontmatter?: FrontMatterCache;\n /**\n * Position of the frontmatter in the file.\n * @public\n * @since 1.4.0\n */\n frontmatterPosition?: Pos;\n\n /**\n * @public\n * @since 1.4.0\n */\n frontmatterLinks?: FrontmatterLinkCache[];\n /**\n * @public\n */\n blocks?: Record;\n\n}\n\n/**\n * @public\n */\nexport interface CacheItem {\n /**\n * Position of this item in the note.\n * @public\n */\n position: Pos;\n\n}\n\n/**\n * Implementation of the vault adapter for mobile devices.\n * @public\n * @since 1.7.2\n */\nexport class CapacitorAdapter implements DataAdapter {\n\n /**\n * @public\n * @since 1.7.2\n */\n getName(): string;\n\n /**\n * @public\n * @since 1.7.2\n */\n mkdir(normalizedPath: string): Promise;\n /**\n * @public\n * @since 1.7.2\n */\n trashSystem(normalizedPath: string): Promise;\n /**\n * @public\n * @since 1.7.2\n */\n trashLocal(normalizedPath: string): Promise;\n /**\n * @public\n * @since 1.7.2\n */\n rmdir(normalizedPath: string, recursive: boolean): Promise;\n /**\n * @public\n * @since 1.7.2\n */\n read(normalizedPath: string): Promise;\n /**\n * @public\n * @since 1.7.2\n */\n readBinary(normalizedPath: string): Promise;\n /**\n * @public\n * @since 1.7.2\n */\n write(normalizedPath: string, data: string, options?: DataWriteOptions): Promise;\n /**\n * @public\n * @since 1.7.2\n */\n writeBinary(normalizedPath: string, data: ArrayBuffer, options?: DataWriteOptions): Promise;\n /**\n * @public\n * @since 1.7.2\n */\n append(normalizedPath: string, data: string, options?: DataWriteOptions): Promise;\n /**\n * @public\n * @since 1.7.2\n */\n process(normalizedPath: string, fn: (data: string) =&gt; string, options?: DataWriteOptions): Promise;\n /**\n * @public\n * @since 1.7.2\n */\n getResourcePath(normalizedPath: string): string;\n\n /**\n * @public\n * @since 1.7.2\n */\n remove(normalizedPath: string): Promise;\n\n /**\n * @public\n * @since 1.7.2\n */\n rename(normalizedPath: string, normalizedNewPath: string): Promise;\n /**\n * @public\n * @since 1.7.2\n */\n copy(normalizedPath: string, normalizedNewPath: string): Promise;\n /**\n * @public\n * @since 1.7.2\n */\n exists(normalizedPath: string, sensitive?: boolean): Promise;\n\n /**\n * @public\n * @since 1.7.2\n */\n stat(normalizedPath: string): Promise;\n /**\n * @public\n * @since 1.7.2\n */\n list(normalizedPath: string): Promise;\n\n /**\n * @public\n * @since 1.7.2\n */\n getFullPath(normalizedPath: string): string;\n\n}\n\n/**\n * A closeable component that can get dismissed via the Android 'back' button.\n * @public\n */\nexport interface CloseableComponent {\n /** @public */\n close(): void;\n}\n\n/**\n * Color picker component. Values are by default 6-digit hash-prefixed hex strings like &#96;#000000&#96;.\n * @public\n * @since 1.0.0\n */\nexport class ColorComponent extends ValueComponent {\n\n /**\n * @public\n */\n constructor(containerEl: HTMLElement);\n /**\n * @public\n * @since 1.2.3\n */\n setDisabled(disabled: boolean): this;\n /**\n * @public\n * @since 1.0.0\n */\n getValue(): HexString;\n /**\n * @public\n * @since 1.0.0\n */\n getValueRgb(): RGB;\n /**\n * @public\n * @since 1.0.0\n */\n getValueHsl(): HSL;\n\n /**\n * @public\n * @since 1.0.0\n */\n setValue(value: HexString): this;\n /**\n * @public\n * @since 1.0.0\n */\n setValueRgb(rgb: RGB): this;\n /**\n * @public\n * @since 1.0.0\n */\n setValueHsl(hsl: HSL): this;\n\n /**\n * @public\n * @since 1.0.0\n */\n onChange(callback: (value: string) =&gt; any): this;\n}\n\n/**\n * @public\n */\nexport interface Command {\n /**\n * Globally unique ID to identify this command.\n * @public\n */\n id: string;\n /**\n * Human friendly name for searching.\n * @public\n */\n name: string;\n /**\n * Icon ID to be used in the toolbar.\n * See {@link https://docs.obsidian.md/Plugins/User+interface/Icons} for available icons and how to add your own.\n * @public\n */\n icon?: IconName;\n /** @public */\n mobileOnly?: boolean;\n /**\n * Whether holding the hotkey should repeatedly trigger this command.\n * @defaultValue false\n * @public\n */\n repeatable?: boolean;\n /**\n * Simple callback, triggered globally.\n * @example\n * &#96;&#96;&#96;ts\n * this.addCommand({\n * id: 'print-greeting-to-console',\n * name: 'Print greeting to console',\n * callback: () =&gt; {\n * console.log('Hey, you!');\n * },\n * });\n * &#96;&#96;&#96;\n * @public\n */\n callback?: () =&gt; any;\n /**\n * Complex callback, overrides the simple callback.\n * Used to 'check' whether your command can be performed in the current circumstances.\n * For example, if your command requires the active focused pane to be a MarkdownView, then\n * you should only return true if the condition is satisfied. Returning false or undefined causes\n * the command to be hidden from the command palette.\n *\n * @param checking - Whether the command palette is just 'checking' if your command should show right now.\n * If checking is true, then this function should not perform any action.\n * If checking is false, then this function should perform the action.\n * @returns Whether this command can be executed at the moment.\n *\n * @example\n * &#96;&#96;&#96;ts\n * this.addCommand({\n * id: 'example-command',\n * name: 'Example command',\n * checkCallback: (checking: boolean) =&gt; {\n * const value = getRequiredValue();\n *\n * if (value) {\n * if (!checking) {\n * doCommand(value);\n * }\n * return true;\n * }\n *\n * return false;\n * }\n * });\n * &#96;&#96;&#96;\n *\n * @public\n */\n checkCallback?: (checking: boolean) =&gt; boolean | void;\n\n /**\n * A command callback that is only triggered when the user is in an editor.\n * Overrides &#96;callback&#96; and &#96;checkCallback&#96;\n * @example\n * &#96;&#96;&#96;ts\n * this.addCommand({\n * id: 'example-command',\n * name: 'Example command',\n * editorCallback: (editor: Editor, view: MarkdownView) =&gt; {\n * const sel = editor.getSelection();\n *\n * console.log(&#96;You have selected: ${sel}&#96;);\n * }\n * });\n * &#96;&#96;&#96;\n * @public\n * @since 0.12.2\n */\n editorCallback?: (editor: Editor, ctx: MarkdownView | MarkdownFileInfo) =&gt; any;\n /**\n * A command callback that is only triggered when the user is in an editor.\n * Overrides &#96;editorCallback&#96;, &#96;callback&#96; and &#96;checkCallback&#96;\n * @example\n * &#96;&#96;&#96;ts\n * this.addCommand({\n * id: 'example-command',\n * name: 'Example command',\n * editorCheckCallback: (checking: boolean, editor: Editor, view: MarkdownView) =&gt; {\n * const value = getRequiredValue();\n *\n * if (value) {\n * if (!checking) {\n * doCommand(value);\n * }\n *\n * return true;\n * }\n *\n * return false;\n * }\n * });\n * &#96;&#96;&#96;\n * @public\n * @since 0.12.2\n */\n editorCheckCallback?: (checking: boolean, editor: Editor, ctx: MarkdownView | MarkdownFileInfo) =&gt; boolean | void;\n /**\n * Sets the default hotkey. It is recommended for plugins to avoid setting default hotkeys if possible,\n * to avoid conflicting hotkeys with one that's set by the user, even though customized hotkeys have higher priority.\n * @public\n */\n hotkeys?: Hotkey[];\n\n}\n\n/**\n * @public\n * @since 0.9.7\n */\nexport class Component {\n\n /**\n * Load this component and its children\n * @public\n * @since 0.9.7\n */\n load(): void;\n /**\n * Override this to load your component\n * @public\n * @virtual\n * @since 0.9.7\n */\n onload(): void;\n /**\n * Unload this component and its children\n * @public\n * @since 0.9.7\n */\n unload(): void;\n /**\n * Override this to unload your component\n * @public\n * @virtual\n * @since 0.9.7\n */\n onunload(): void;\n /**\n * Adds a child component, loading it if this component is loaded\n * @public\n * @since 0.12.0\n */\n addChild (component: T): T;\n /**\n * Removes a child component, unloading it\n * @public\n * @since 0.12.0\n */\n removeChild (component: T): T;\n /**\n * Registers a callback to be called when unloading\n * @public\n * @since 0.9.7\n */\n register(cb: () =&gt; any): void;\n /**\n * Registers an event to be detached when unloading\n * @public\n * @since 0.9.7\n */\n registerEvent(eventRef: EventRef): void;\n /**\n * Registers a DOM event to be detached when unloading\n * @public\n * @since 0.14.8\n */\n registerDomEvent (el: Window, type: K, callback: (this: HTMLElement, ev: WindowEventMap[K]) =&gt; any, options?: boolean | AddEventListenerOptions): void;\n /**\n * Registers a DOM event to be detached when unloading\n * @public\n * @since 0.14.8\n */\n registerDomEvent (el: Document, type: K, callback: (this: HTMLElement, ev: DocumentEventMap[K]) =&gt; any, options?: boolean | AddEventListenerOptions): void;\n /**\n * Registers a DOM event to be detached when unloading\n * @public\n * @since 0.14.8\n */\n registerDomEvent (el: HTMLElement, type: K, callback: (this: HTMLElement, ev: HTMLElementEventMap[K]) =&gt; any, options?: boolean | AddEventListenerOptions): void;\n\n /**\n * Registers an interval (from setInterval) to be cancelled when unloading\n * Use {@link window.setInterval} instead of {@link setInterval} to avoid TypeScript confusing between NodeJS vs Browser API\n * @public\n * @since 0.13.8\n */\n registerInterval(id: number): number;\n}\n\n/** @public */\nexport type Constructor = abstract new (...args: any[]) =&gt; T;\n\n/**\n * Work directly with files and folders inside a vault.\n * If possible prefer using the {@link Vault} API over this.\n * @public\n */\nexport interface DataAdapter {\n\n /**\n * @public\n */\n getName(): string;\n\n /**\n * Check if something exists at the given path. For a faster way to synchronously check\n * if a note or attachment is in the vault, use {@link Vault.getAbstractFileByPath}.\n * @param normalizedPath - path to file/folder, use {@link normalizePath} to normalize beforehand.\n * @param sensitive - Some file systems/operating systems are case-insensitive, set to true to force a case-sensitivity check.\n * @public\n */\n exists(normalizedPath: string, sensitive?: boolean): Promise;\n /**\n * Retrieve metadata about the given file/folder.\n * @param normalizedPath - path to file/folder, use {@link normalizePath} to normalize beforehand.\n * @public\n * @since 0.12.2\n */\n stat(normalizedPath: string): Promise;\n /**\n * Retrieve a list of all files and folders inside the given folder, non-recursive.\n * @param normalizedPath - path to folder, use {@link normalizePath} to normalize beforehand.\n * @public\n */\n list(normalizedPath: string): Promise;\n /**\n * @param normalizedPath - path to file, use {@link normalizePath} to normalize beforehand.\n * @public\n */\n read(normalizedPath: string): Promise;\n /**\n * @param normalizedPath - path to file, use {@link normalizePath} to normalize beforehand.\n * @public\n */\n readBinary(normalizedPath: string): Promise;\n /**\n * Write to a plaintext file.\n * If the file exists its content will be overwritten, otherwise the file will be created.\n * @param normalizedPath - path to file, use {@link normalizePath} to normalize beforehand.\n * @param data - new file content\n * @param options - (Optional)\n * @public\n */\n write(normalizedPath: string, data: string, options?: DataWriteOptions): Promise;\n /**\n * Write to a binary file.\n * If the file exists its content will be overwritten, otherwise the file will be created.\n * @param normalizedPath - path to file, use {@link normalizePath} to normalize beforehand.\n * @param data - the new file content\n * @param options - (Optional)\n * @public\n */\n writeBinary(normalizedPath: string, data: ArrayBuffer, options?: DataWriteOptions): Promise;\n /**\n * Add text to the end of a plaintext file.\n * @param normalizedPath - path to file, use {@link normalizePath} to normalize beforehand.\n * @param data - the text to append.\n * @param options - (Optional)\n * @public\n */\n append(normalizedPath: string, data: string, options?: DataWriteOptions): Promise;\n /**\n * Atomically read, modify, and save the contents of a plaintext file.\n * @param normalizedPath - path to file/folder, use {@link normalizePath} to normalize beforehand.\n * @param fn - a callback function which returns the new content of the file synchronously.\n * @param options - write options.\n * @returns string - the text value of the file that was written.\n * @public\n */\n process(normalizedPath: string, fn: (data: string) =&gt; string, options?: DataWriteOptions): Promise;\n /**\n * Returns a URI for the browser engine to use, for example to embed an image.\n * @param normalizedPath - path to file/folder, use {@link normalizePath} to normalize beforehand.\n * @public\n */\n getResourcePath(normalizedPath: string): string;\n /**\n * Create a directory.\n * @param normalizedPath - path to use for new folder, use {@link normalizePath} to normalize beforehand.\n * @public\n */\n mkdir(normalizedPath: string): Promise;\n /**\n * Try moving to system trash.\n * @param normalizedPath - path to file/folder, use {@link normalizePath} to normalize beforehand.\n * @returns Returns true if succeeded. This can fail due to system trash being disabled.\n * @public\n */\n trashSystem(normalizedPath: string): Promise;\n /**\n * Move to local trash.\n * Files will be moved into the &#96;.trash&#96; folder at the root of the vault.\n * @param normalizedPath - path to file/folder, use {@link normalizePath} to normalize beforehand.\n * @public\n */\n trashLocal(normalizedPath: string): Promise;\n /**\n * Remove a directory.\n * @param normalizedPath - path to folder, use {@link normalizePath} to normalize beforehand.\n * @param recursive - If &#96;true&#96;, delete folders under this folder recursively, if &#96;false&#96; the folder needs to be empty.\n * @public\n */\n rmdir(normalizedPath: string, recursive: boolean): Promise;\n /**\n * Delete a file.\n * @param normalizedPath - path to file, use {@link normalizePath} to normalize beforehand.\n * @public\n */\n remove(normalizedPath: string): Promise;\n\n /**\n * Rename a file or folder.\n * @param normalizedPath - current path to file/folder, use {@link normalizePath} to normalize beforehand.\n * @param normalizedNewPath - new path to file/folder, use {@link normalizePath} to normalize beforehand.\n * @public\n */\n rename(normalizedPath: string, normalizedNewPath: string): Promise;\n /**\n * Create a copy of a file.\n * This will fail if there is already a file at &#96;normalizedNewPath&#96;.\n * @param normalizedPath - path to file, use {@link normalizePath} to normalize beforehand.\n * @param normalizedNewPath - path to file, use {@link normalizePath} to normalize beforehand.\n * @public\n */\n copy(normalizedPath: string, normalizedNewPath: string): Promise;\n}\n\n/**\n * @public\n */\nexport interface DataWriteOptions {\n /**\n * Time of creation, represented as a unix timestamp, in milliseconds.\n * Omit this if you want to keep the default behaviour.\n * @public\n */\n ctime?: number;\n /**\n * Time of last modification, represented as a unix timestamp, in milliseconds.\n * Omit this if you want to keep the default behaviour.\n * @public\n */\n mtime?: number;\n\n}\n\n/**\n * {@link Value} wrapping a Date.\n * @public\n * @since 1.10.0\n */\nexport class DateValue extends NotNullValue {\n\n /**\n * @public\n * @since 1.10.0\n */\n toString(): string;\n\n /**\n * @returns a new DateValue with any time portion in this DateValue removed.\n * @public\n * @since 1.10.0\n */\n dateOnly(): DateValue;\n\n /**\n * @returns a new {@link RelativeDateValue} based on this DateValue.\n * @public\n * @since 1.10.0\n */\n relative(): string;\n /**\n * @public\n * @since 1.10.0\n */\n isTruthy(): boolean;\n\n /**\n * Create new DateValue from an input string.\n *\n * @example\n * parseFromString(\"2025-12-31\")\n * parseFromString(\"2025-12-31T23:59\")\n * parseFromString(\"2025-12-31T23:59:59\")\n * parseFromString(\"2025-12-31T23:59:59Z-07\")\n *\n * @param input - An ISO 8601 date or datetime string.\n * @public\n * @since 1.10.0\n */\n static parseFromString(input: string): DateValue | null;\n\n}\n\n/**\n * A standard debounce function.\n * Use this to have a time-delayed function only be called once in a given timeframe.\n *\n * @param cb - The function to call.\n * @param timeout - The timeout to wait, in milliseconds\n * @param resetTimer - Whether to reset the timeout when the debouncer is called again.\n * @returns a debounced function that takes the same parameter as the original function.\n * @example\n * &#96;&#96;&#96;ts\n * const debounced = debounce((text: string) =&gt; {\n * console.log(text);\n * }, 1000, true);\n * debounced('Hello world'); // this will not be printed\n * await sleep(500);\n * debounced('World, hello'); // this will be printed to the console.\n * &#96;&#96;&#96;\n * @public\n */\nexport function debounce (cb: (...args: [...T]) =&gt; V, timeout?: number, resetTimer?: boolean): Debouncer;\n\n/** @public */\nexport interface Debouncer {\n /** @public */\n (...args: [...T]): this;\n /**\n * Cancel any pending debounced function call.\n * @public\n */\n cancel(): this;\n /**\n * If there is any pending function call, clear the timer and call the function immediately.\n * @public\n * @since 1.4.4\n */\n run(): V | void;\n}\n\n/**\n * Manually trigger a tooltip that will appear over the provided element.\n *\n * To display a tooltip on hover, use {@link setTooltip} instead.\n * @public\n * @since 1.8.7\n */\nexport function displayTooltip(newTargetEl: HTMLElement, content: string | DocumentFragment, options?: TooltipOptions): void;\n\n/**\n * @public\n * @since 0.9.7\n */\nexport class DropdownComponent extends ValueComponent {\n /**\n * @public\n * @since 0.9.7\n */\n selectEl: HTMLSelectElement;\n\n /**\n * @public\n */\n constructor(containerEl: HTMLElement);\n /**\n * @public\n * @since 1.2.3\n */\n setDisabled(disabled: boolean): this;\n /**\n * @public\n * @since 0.9.7\n */\n addOption(value: string, display: string): this;\n /**\n * @public\n * @since 0.9.7\n */\n addOptions(options: Record): this;\n /**\n * @public\n * @since 0.9.7\n */\n getValue(): string;\n /**\n * @public\n * @since 0.9.7\n */\n setValue(value: string): this;\n /**\n * @public\n * @since 0.9.7\n */\n onChange(callback: (value: string) =&gt; any): this;\n}\n\n/**\n * @public\n * @since 1.10.0\n */\nexport interface DropdownOption extends BaseOption {\n /**\n * @public\n * @since 1.10.0\n */\n type: 'dropdown';\n /**\n * @public\n * @since 1.10.0\n */\n default?: string;\n /**\n * @public\n * @since 1.10.0\n */\n options: Record;\n}\n\n/**\n * {@link Value} wrapping a duration. Durations can be used to modify a {@link DateValue} or can\n * result from subtracting a DateValue from another.\n * @public\n * @since 1.10.0\n */\nexport class DurationValue extends NotNullValue {\n\n /**\n * @public\n * @since 1.10.0\n */\n toString(): string;\n /**\n * @public\n * @since 1.10.0\n */\n isTruthy(): boolean;\n\n /**\n * Modifies the provided {@DateValue} by this duration.\n * @public\n * @since 1.10.0\n */\n addToDate(value: DateValue, subtract?: boolean): DateValue;\n /**\n * Convert this duration into milliseconds.\n * @public\n * @since 1.10.0\n */\n getMilliseconds(): number;\n\n /**\n * Create a new DurationValue using an ISO 8601 duration.\n * See {@link https://en.wikipedia.org/wiki/ISO_8601#Durations} for duration format details.\n * @public\n * @since 1.10.0\n */\n static parseFromString(input: string): DurationValue | null;\n /**\n * Create a new DurationValue from milliseconds.\n * @public\n * @since 1.10.0\n */\n static fromMilliseconds(milliseconds: number): DurationValue;\n}\n\n/**\n * @public\n * @since 0.9.7\n */\nexport abstract class EditableFileView extends FileView {\n\n}\n\n/**\n * A common interface that bridges the gap between CodeMirror 5 and CodeMirror 6.\n * @public\n * @since 0.11.11\n */\nexport abstract class Editor {\n\n /**\n * @public\n * @since 0.11.11\n */\n getDoc(): this;\n /**\n * @public\n * @since 0.11.11\n */\n abstract refresh(): void;\n /**\n * @public\n * @since 0.11.11\n */\n abstract getValue(): string;\n /** @public\n * @since 0.11.11\n */\n abstract setValue(content: string): void;\n /**\n * Get the text at line (0-indexed)\n * @public\n * @since 0.11.11\n */\n abstract getLine(line: number): string;\n /**\n * @public\n * @since 0.11.11\n */\n setLine(n: number, text: string): void;\n /**\n * Gets the number of lines in the document\n * @public\n * @since 0.11.11\n */\n abstract lineCount(): number;\n /**\n * @public\n * @since 0.11.11\n */\n abstract lastLine(): number;\n /**\n * @public\n * @since 0.11.11\n */\n abstract getSelection(): string;\n /**\n * @public\n * @since 0.11.11\n */\n somethingSelected(): boolean;\n /**\n * @public\n * @since 0.11.11\n */\n abstract getRange(from: EditorPosition, to: EditorPosition): string;\n /**\n * @public\n * @since 0.11.11\n */\n abstract replaceSelection(replacement: string, origin?: string): void;\n /**\n * @public\n * @since 0.11.11\n */\n abstract replaceRange(replacement: string, from: EditorPosition, to?: EditorPosition, origin?: string): void;\n /**\n * @public\n * @since 0.11.11\n */\n abstract getCursor(side?: 'from' | 'to' | 'head' | 'anchor'): EditorPosition;\n /**\n * @public\n * @since 0.11.11\n */\n abstract listSelections(): EditorSelection[];\n /**\n * @public\n * @since 0.11.11\n */\n setCursor(pos: EditorPosition | number, ch?: number): void;\n /**\n * @public\n * @since 0.11.11\n */\n abstract setSelection(anchor: EditorPosition, head?: EditorPosition): void;\n /**\n * @public\n * @since 0.12.11\n */\n abstract setSelections(ranges: EditorSelectionOrCaret[], main?: number): void;\n /**\n * @public\n * @since 0.11.11\n */\n abstract focus(): void;\n /**\n * @public\n * @since 0.11.11\n */\n abstract blur(): void;\n /**\n * @public\n * @since 0.11.11\n */\n abstract hasFocus(): boolean;\n /**\n * @public\n * @since 0.11.11\n */\n abstract getScrollInfo(): {\n /**\n * @public\n * @since 0.11.11\n */\n top: number;\n /**\n * @public\n * @since 0.11.11\n */\n left: number;\n };\n /**\n * @public\n * @since 0.11.11\n */\n abstract scrollTo(x?: number | null, y?: number | null): void;\n /**\n * @public\n * @since 0.13.0\n */\n abstract scrollIntoView(range: EditorRange, center?: boolean): void;\n /**\n * @public\n * @since 0.11.11\n */\n abstract undo(): void;\n /**\n * @public\n * @since 0.11.11\n */\n abstract redo(): void;\n /**\n * @public\n * @since 0.12.2\n */\n abstract exec(command: EditorCommandName): void;\n /**\n * @public\n * @since 0.13.0\n */\n abstract transaction(tx: EditorTransaction, origin?: string): void;\n /**\n * @public\n * @since 0.11.11\n */\n abstract wordAt(pos: EditorPosition): EditorRange | null;\n /**\n * @public\n * @since 0.11.11\n */\n abstract posToOffset(pos: EditorPosition): number;\n /**\n * @public\n * @since 0.11.11\n */\n abstract offsetToPos(offset: number): EditorPosition;\n\n /**\n * @public\n * @since 0.13.26\n */\n processLines (read: (line: number, lineText: string) =&gt; T | null, write: (line: number, lineText: string, value: T | null) =&gt; EditorChange | void, ignoreEmpty?: boolean): void;\n\n}\n\n/**\n * @public\n * @since 0.12.11\n */\nexport interface EditorChange extends EditorRangeOrCaret {\n /** @public */\n text: string;\n}\n\n/** @public */\nexport type EditorCommandName = 'goUp' | 'goDown' | 'goLeft' | 'goRight' | 'goStart' | 'goEnd' | 'goWordLeft' | 'goWordRight' | 'indentMore' | 'indentLess' | 'newlineAndIndent' | 'swapLineUp' | 'swapLineDown' | 'deleteLine' | 'toggleFold' | 'foldAll' | 'unfoldAll';\n\n/**\n * Use this StateField to get a reference to the EditorView\n * @public\n */\nexport const editorEditorField: StateField;\n\n/**\n * Use this StateField to get information about this Markdown editor, such as the associated file, or the Editor.\n * @public\n */\nexport const editorInfoField: StateField;\n\n/**\n * Use this StateField to check whether Live Preview is active\n * @public\n */\nexport const editorLivePreviewField: StateField;\n\n/**\n * @public\n * @since 0.12.11\n */\nexport interface EditorPosition {\n /** @public */\n line: number;\n /** @public */\n ch: number;\n}\n\n/**\n * @public\n * @since 0.12.11\n */\nexport interface EditorRange {\n /** @public */\n from: EditorPosition;\n /** @public */\n to: EditorPosition;\n}\n\n/**\n * @public\n * @since 0.12.11\n */\nexport interface EditorRangeOrCaret {\n /** @public */\n from: EditorPosition;\n /** @public */\n to?: EditorPosition;\n}\n\n/**\n * @public\n * @since 0.15.0\n */\nexport interface EditorScrollInfo {\n /** @public */\n left: number;\n /** @public */\n top: number;\n /** @public */\n width: number;\n /** @public */\n height: number;\n /** @public */\n clientWidth: number;\n /** @public */\n clientHeight: number;\n}\n\n/**\n * @public\n * @since 0.12.11\n */\nexport interface EditorSelection {\n /** @public */\n anchor: EditorPosition;\n /** @public */\n head: EditorPosition;\n}\n\n/**\n * @public\n * @since 0.12.11\n */\nexport interface EditorSelectionOrCaret {\n /** @public */\n anchor: EditorPosition;\n /** @public */\n head?: EditorPosition;\n}\n\n/**\n * @public\n * @since 0.12.17\n */\nexport abstract class EditorSuggest extends PopoverSuggest {\n\n /**\n * Current suggestion context, containing the result of &#96;onTrigger&#96;.\n * This will be null any time the EditorSuggest is not supposed to run.\n * @public\n * @since 0.12.17\n */\n context: EditorSuggestContext | null;\n /**\n * Override this to use a different limit for suggestion items\n * @public\n * @since 0.12.17\n */\n limit: number;\n /**\n * @public\n */\n constructor(app: App);\n /**\n * @public\n * @since 0.13.0\n */\n setInstructions(instructions: Instruction[]): void;\n\n /**\n * Based on the editor line and cursor position, determine if this EditorSuggest should be triggered at this moment.\n * Typically, you would run a regular expression on the current line text before the cursor.\n * Return null to indicate that this editor suggest is not supposed to be triggered.\n *\n * Please be mindful of performance when implementing this function, as it will be triggered very often (on each keypress).\n * Keep it simple, and return null as early as possible if you determine that it is not the right time.\n * @public\n * @since 1.1.13\n */\n abstract onTrigger(cursor: EditorPosition, editor: Editor, file: TFile | null): EditorSuggestTriggerInfo | null;\n /**\n * Generate suggestion items based on this context. Can be async, but preferably sync.\n * When generating async suggestions, you should pass the context along.\n * @public\n * @since 0.12.17\n */\n abstract getSuggestions(context: EditorSuggestContext): T[] | Promise;\n\n}\n\n/**\n * @public\n * @since 0.12.17\n */\nexport interface EditorSuggestContext extends EditorSuggestTriggerInfo {\n /** @public */\n editor: Editor;\n /** @public */\n file: TFile;\n}\n\n/**\n * @public\n * @since 0.12.17\n */\nexport interface EditorSuggestTriggerInfo {\n /**\n * The start position of the triggering text. This is used to position the popover.\n * @public\n */\n start: EditorPosition;\n /**\n * The end position of the triggering text. This is used to position the popover.\n * @public\n */\n end: EditorPosition;\n /**\n * They query string (usually the text between start and end) that will be used to generate the suggestion content.\n * @public\n */\n query: string;\n}\n\n/** @public */\nexport interface EditorTransaction {\n /** @public */\n replaceSelection?: string;\n /** @public */\n changes?: EditorChange[];\n /**\n * Multiple selections, overrides &#96;selection&#96;.\n * @public\n */\n selections?: EditorRangeOrCaret[];\n /** @public */\n selection?: EditorRangeOrCaret;\n}\n\n/**\n * This is now deprecated - it is now mapped directly to &#96;editorInfoField&#96;, which return a MarkdownFileInfo, which may be a MarkdownView but not necessarily.\n * @public\n * @deprecated use {@link editorInfoField} instead.\n */\nexport const editorViewField: StateField;\n\n/**\n * @public\n * @since 0.9.7\n */\nexport interface EmbedCache extends ReferenceCache {\n}\n\n/**\n * @public\n */\nexport interface EventRef {\n\n}\n\n/**\n * @public\n * @since 0.9.7\n */\nexport class Events {\n\n /**\n * @public\n * @since 0.9.7\n */\n on(name: string, callback: (...data: unknown[]) =&gt; unknown, ctx?: any): EventRef;\n /**\n * @public\n * @since 0.9.7\n */\n off(name: string, callback: (...data: unknown[]) =&gt; unknown): void;\n /**\n * @public\n * @since 0.9.7\n */\n offref(ref: EventRef): void;\n /**\n * @public\n * @since 0.9.7\n */\n trigger(name: string, ...data: unknown[]): void;\n /**\n * @public\n * @since 0.9.7\n */\n tryTrigger(evt: EventRef, args: unknown[]): void;\n}\n\n/**\n * @public\n * @since 0.9.7\n */\nexport class ExtraButtonComponent extends BaseComponent {\n /**\n * @public\n * @since 0.9.7\n */\n extraSettingsEl: HTMLElement;\n\n /**\n * @public\n */\n constructor(containerEl: HTMLElement);\n /**\n * @public\n * @since 1.2.3\n */\n setDisabled(disabled: boolean): this;\n /**\n * @public\n * @since 1.1.0\n */\n setTooltip(tooltip: string, options?: TooltipOptions): this;\n /**\n * @param icon - ID of the icon, can use any icon loaded with {@link addIcon} or from the inbuilt library.\n * @see The Obsidian icon library includes the {@link https://lucide.dev/ Lucide icon library}, any icon name from their site will work here.\n * @public\n * @since 0.9.7\n */\n setIcon(icon: IconName): this;\n /**\n * @public\n * @since 0.9.7\n */\n onClick(callback: () =&gt; any): this;\n}\n\n/**\n * Manage the creation, deletion and renaming of files from the UI.\n * @public\n * @since 0.9.7\n */\nexport class FileManager {\n\n /**\n * Gets the folder that new files should be saved to, given the user's preferences.\n * @param sourcePath - The path to the current open/focused file,\n * used when the user wants new files to be created 'in the same folder'.\n * Use an empty string if there is no active file.\n * @param newFilePath - The path to the file that will be newly created,\n * used to infer what settings to use based on the path's extension.\n * @public\n * @since 1.1.13\n */\n getNewFileParent(sourcePath: string, newFilePath?: string): TFolder;\n\n /**\n * Rename or move a file safely, and update all links to it depending on the user's preferences.\n * @param file - the file to rename\n * @param newPath - the new path for the file\n * @public\n * @since 0.11.0\n */\n renameFile(file: TAbstractFile, newPath: string): Promise;\n\n /**\n * @public\n * @since 0.15.0\n */\n promptForDeletion(file: TAbstractFile): Promise;\n\n /**\n * Remove a file or a folder from the vault according the user's preferred 'trash'\n * options (either moving the file to .trash/ or the OS trash bin).\n * @param file\n * @public\n * @since 1.6.6\n */\n trashFile(file: TAbstractFile): Promise;\n\n /**\n * Generate a Markdown link based on the user's preferences.\n * @param file - the file to link to.\n * @param sourcePath - where the link is stored in, used to compute relative links.\n * @param subpath - A subpath, starting with &#96;#&#96;, used for linking to headings or blocks.\n * @param alias - The display text if it's to be different than the file name. Pass empty string to use file name.\n * @public\n * @since 0.12.0\n */\n generateMarkdownLink(file: TFile, sourcePath: string, subpath?: string, alias?: string): string;\n\n /**\n * Atomically read, modify, and save the frontmatter of a note.\n * The frontmatter is passed in as a JS object, and should be mutated directly to achieve the desired result.\n *\n * Remember to handle errors thrown by this method.\n *\n * @param file - the file to be modified. Must be a Markdown file.\n * @param fn - a callback function which mutates the frontmatter object synchronously.\n * @param options - write options.\n * @throws YAMLParseError if the YAML parsing fails\n * @throws any errors that your callback function throws\n * @example\n * &#96;&#96;&#96;ts\n * app.fileManager.processFrontMatter(file, (frontmatter) =&gt; {\n * frontmatter['key1'] = value;\n * delete frontmatter['key2'];\n * });\n * &#96;&#96;&#96;\n * @public\n * @since 1.4.4\n */\n processFrontMatter(file: TFile, fn: (frontmatter: any) =&gt; void, options?: DataWriteOptions): Promise;\n\n /**\n * Resolves a unique path for the attachment file being saved.\n * Ensures that the parent directory exists and dedupes the\n * filename if the destination filename already exists.\n *\n * @param filename Name of the attachment being saved\n * @param sourcePath The path to the note associated with this attachment, defaults to the workspace's active file.\n * @returns Full path for where the attachment should be saved, according to the user's settings\n * @public\n * @since 1.5.7\n */\n getAvailablePathForAttachment(filename: string, sourcePath?: string): Promise;\n\n}\n\n/**\n * A text input allowing selection of a file from in the vault.\n * @public\n * @since 1.10.2\n */\nexport interface FileOption extends BaseOption {\n /**\n * @public\n * @since 1.10.2\n */\n type: 'file';\n /**\n * @public\n * @since 1.10.2\n */\n default?: string;\n /**\n * @public\n * @since 1.10.2\n */\n placeholder?: string;\n /**\n * @public\n * @since 1.10.2\n */\n filter?: (file: TFile) =&gt; boolean;\n}\n\n/**\n * @public\n */\nexport interface FileStats {\n /**\n * Time of creation, represented as a unix timestamp, in milliseconds.\n * @public\n */\n ctime: number;\n /**\n * Time of last modification, represented as a unix timestamp, in milliseconds.\n * @public\n */\n mtime: number;\n /**\n * Size on disk, as bytes.\n * @public\n */\n size: number;\n}\n\n/**\n * Implementation of the vault adapter for desktop.\n * @public\n */\nexport class FileSystemAdapter implements DataAdapter {\n\n /**\n * @public\n */\n getName(): string;\n /**\n * @public\n */\n getBasePath(): string;\n\n /**\n * @public\n */\n mkdir(normalizedPath: string): Promise;\n /**\n * @public\n */\n trashSystem(normalizedPath: string): Promise;\n /**\n * @public\n */\n trashLocal(normalizedPath: string): Promise;\n /**\n * @public\n */\n rmdir(normalizedPath: string, recursive: boolean): Promise;\n /**\n * @public\n */\n read(normalizedPath: string): Promise;\n /**\n * @public\n */\n readBinary(normalizedPath: string): Promise;\n /**\n * @public\n */\n write(normalizedPath: string, data: string, options?: DataWriteOptions): Promise;\n /**\n * @public\n */\n writeBinary(normalizedPath: string, data: ArrayBuffer, options?: DataWriteOptions): Promise;\n /**\n * @public\n */\n append(normalizedPath: string, data: string, options?: DataWriteOptions): Promise;\n /**\n * @public\n */\n process(normalizedPath: string, fn: (data: string) =&gt; string, options?: DataWriteOptions): Promise;\n\n /**\n * @public\n */\n getResourcePath(normalizedPath: string): string;\n /**\n * Returns the file:// path of this file\n * @public\n * @since 0.14.3\n */\n getFilePath(normalizedPath: string): string;\n /**\n * @public\n */\n remove(normalizedPath: string): Promise;\n\n /**\n * @public\n */\n rename(normalizedPath: string, normalizedNewPath: string): Promise;\n\n /**\n * @public\n */\n copy(normalizedPath: string, normalizedNewPath: string): Promise;\n /**\n * @public\n */\n exists(normalizedPath: string, sensitive?: boolean): Promise;\n\n /**\n * @public\n * @since 0.12.2\n */\n stat(normalizedPath: string): Promise;\n /**\n * @public\n */\n list(normalizedPath: string): Promise;\n\n /**\n * @public\n */\n getFullPath(normalizedPath: string): string;\n\n /**\n * @public\n */\n static readLocalFile(path: string): Promise;\n /**\n * @public\n */\n static mkdir(path: string): Promise;\n}\n\n/**\n * {@link Value} wrapping a file in Obsidian.\n * @public\n * @since 1.10.0\n */\nexport class FileValue extends NotNullValue {\n\n /**\n * @public\n * @since 1.10.0\n */\n toString(): string;\n /**\n * @public\n * @since 1.10.0\n */\n isTruthy(): boolean;\n\n}\n\n/**\n * @public\n */\nexport abstract class FileView extends ItemView {\n /**\n * @public\n */\n allowNoFile: boolean;\n /**\n * @public\n */\n file: TFile | null;\n /**\n * File views can be navigated by default.\n * @inheritDoc\n * @public\n */\n navigation: boolean;\n /**\n * @public\n */\n constructor(leaf: WorkspaceLeaf);\n\n /**\n * @public\n */\n getDisplayText(): string;\n /**\n * @public\n */\n onload(): void;\n /**\n * @public\n */\n getState(): Record;\n\n /**\n * @public\n * @since 0.9.7\n */\n setState(state: any, result: ViewStateResult): Promise;\n\n /**\n * @public\n */\n onLoadFile(file: TFile): Promise;\n /**\n * @public\n */\n onUnloadFile(file: TFile): Promise;\n /**\n * @public\n */\n onRename(file: TFile): Promise;\n\n /**\n * @public\n * @since 0.9.7\n */\n canAcceptExtension(extension: string): boolean;\n}\n\n/**\n * Flush the MathJax stylesheet.\n * @public\n */\nexport function finishRenderMath(): Promise;\n\n/**\n * A text input allowing selection of a folder from in the vault.\n * @public\n * @since 1.10.2\n */\nexport interface FolderOption extends BaseOption {\n /**\n * @public\n * @since 1.10.2\n */\n type: 'folder';\n /**\n * @public\n * @since 1.10.2\n */\n default?: string;\n /**\n * @public\n * @since 1.10.2\n */\n placeholder?: string;\n /**\n * @public\n * @since 1.10.2\n */\n filter?: (folder: TFolder) =&gt; boolean;\n}\n\n/**\n * @public\n */\nexport interface FootnoteCache extends CacheItem {\n /**\n * @public\n */\n id: string;\n}\n\n/**\n * @public\n */\nexport interface FootnoteRefCache extends CacheItem {\n /**\n * @public\n */\n id: string;\n}\n\n/**\n * @public\n * @since 1.7.2\n */\nexport interface FootnoteSubpathResult extends SubpathResult {\n /**\n * @public\n */\n type: 'footnote';\n /**\n * @public\n */\n footnote: FootnoteCache;\n}\n\n/**\n * The context in which a formula is evaluated. In most cases, {@link BasesEntry} is the specific type to use.\n * @public\n * @since 1.10.0\n */\nexport interface FormulaContext {\n\n}\n\n/**\n * A text input supporting formula evaluation.\n * @public\n * @since 1.10.2\n */\nexport interface FormulaOption extends BaseOption {\n /**\n * @public\n * @since 1.10.2\n */\n type: 'formula';\n /**\n * @public\n * @since 1.10.2\n */\n default?: string;\n /**\n * @public\n * @since 1.10.2\n */\n placeholder?: string;\n}\n\n/**\n * @public\n */\nexport interface FrontMatterCache {\n /**\n * @public\n */\n [key: string]: any;\n}\n\n/** @public */\nexport interface FrontMatterInfo {\n /** @public Whether this file has a frontmatter block */\n exists: boolean;\n /** @public String representation of the frontmatter */\n frontmatter: string;\n /** @public Start of the frontmatter contents (excluding the ---) */\n from: number;\n /** @public End of the frontmatter contents (excluding the ---) */\n to: number;\n /** @public Offset where the frontmatter block ends (including the ---) */\n contentStart: number;\n}\n\n/**\n * @public\n */\nexport interface FrontmatterLinkCache extends Reference {\n /**\n * @public\n */\n key: string;\n}\n\n/**\n * @public\n * @since 0.9.20\n */\nexport interface FuzzyMatch {\n /**\n * @public\n * @since 0.9.20\n */\n item: T;\n /**\n * @public\n * @ince 0.9.20\n */\n match: SearchResult;\n}\n\n/**\n * @public\n * @since 0.9.20\n */\nexport abstract class FuzzySuggestModal extends SuggestModal &gt; {\n\n /**\n * @public\n * @since 0.9.20\n */\n getSuggestions(query: string): FuzzyMatch [];\n /**\n * @public\n * @since 0.9.20\n */\n renderSuggestion(item: FuzzyMatch, el: HTMLElement): void;\n /**\n * @public\n * @since 0.9.20\n */\n onChooseSuggestion(item: FuzzyMatch, evt: MouseEvent | KeyboardEvent): void;\n /**\n * @public\n * @since 0.9.20\n */\n abstract getItems(): T[];\n /**\n * @public\n * @since 0.9.20\n */\n abstract getItemText(item: T): string;\n /**\n * @public\n * @since 0.9.20\n */\n abstract onChooseItem(item: T, evt: MouseEvent | KeyboardEvent): void;\n}\n\n/**\n * Combines all tags from frontmatter and note content into a single array.\n * @public\n */\nexport function getAllTags(cache: CachedMetadata): string[] | null;\n\n/** @public */\nexport function getBlobArrayBuffer(blob: Blob): Promise;\n\n/**\n * Given the contents of a file, get information about the frontmatter of the file, including\n * whether there is a frontmatter block, the offsets of where it starts and ends, and the frontmatter text.\n *\n * @public\n * @since 1.5.7\n */\nexport function getFrontMatterInfo(content: string): FrontMatterInfo;\n\n/**\n * Create an SVG from an iconId. Returns null if no icon associated with the iconId.\n * @param iconId - the icon ID\n * @public\n */\nexport function getIcon(iconId: string): SVGSVGElement | null;\n\n/**\n * Get the list of registered icons.\n * @public\n */\nexport function getIconIds(): IconName[];\n\n/**\n * Get the ISO code for the currently configured app language. Defaults to 'en'.\n * See {@link https://github.com/obsidianmd/obsidian-translations?tab=readme-ov-file#existing-languages} for list of options.\n * @public\n * @since 1.8.7\n */\nexport function getLanguage(): string;\n\n/**\n * Converts the linktext to a linkpath.\n * @param linktext A wikilink without the leading [[ and trailing ]]\n * @returns the name of the file that is being linked to.\n * @public\n */\nexport function getLinkpath(linktext: string): string;\n\n/**\n * Collapsible container for other ViewOptions.\n * @public\n * @since 1.10.0\n */\nexport interface GroupOption {\n /**\n * @public\n * @since 1.10.0\n */\n type: 'group';\n /**\n * @public\n * @since 1.10.0\n */\n displayName: string;\n /**\n * @public\n * @since 1.10.0\n */\n items: Exclude [];\n /**\n * If provided, the group will be hidden if the function returns true.\n *\n * @public\n * @since 1.10.2\n * @param config - Read-only copy of the current view configuration.\n */\n shouldHide?: (config: BasesViewConfig) =&gt; boolean;\n}\n\n/**\n * @public\n */\nexport interface HeadingCache extends CacheItem {\n /**\n * @public\n */\n heading: string;\n /**\n * Number between 1 and 6.\n * @public\n */\n level: number;\n}\n\n/**\n * @public\n * @since 0.9.16\n */\nexport interface HeadingSubpathResult extends SubpathResult {\n /**\n * @public\n * @since 0.9.16\n */\n type: 'heading';\n /**\n * @public\n * @since 0.9.16\n */\n current: HeadingCache;\n /**\n * @public\n * @since 0.9.16\n */\n next: HeadingCache;\n}\n\n/**\n * Hex strings are 6-digit hash-prefixed rgb strings in lowercase form.\n * Example: #ffffff\n * @public\n */\nexport type HexString = string;\n\n/** @public */\nexport function hexToArrayBuffer(hex: string): ArrayBuffer;\n\n/**\n * @public\n */\nexport interface Hotkey {\n /** @public */\n modifiers: Modifier[];\n /** @public */\n key: string;\n\n}\n\n/**\n * @public\n */\nexport interface HoverLinkSource {\n /**\n * Text displayed in the 'Page preview' plugin settings.\n * It should match the plugin's display name.\n * @public\n */\n display: string;\n /**\n * Whether the &#96;hover-link&#96; event requires the 'Mod' key to be pressed to trigger.\n * @public\n */\n defaultMod: boolean;\n}\n\n/**\n * @public\n * @since 0.11.13\n */\nexport interface HoverParent {\n /**\n * @public\n * @since 0.11.13\n */\n hoverPopover: HoverPopover | null;\n}\n\n/**\n * @public\n * @since 0.15.0\n */\nexport class HoverPopover extends Component {\n\n /**\n * @public\n */\n hoverEl: HTMLElement;\n /**\n * @public\n */\n state: PopoverState;\n\n /**\n * @public\n */\n constructor(parent: HoverParent, targetEl: HTMLElement | null, waitTime?: number, staticPos?: Point | null);\n\n}\n\n/**\n * @public\n * @since 0.16.0\n */\nexport interface HSL {\n /**\n * Hue integer value between 0 and 360\n * @public\n * @since 0.16.0\n */\n h: number;\n /**\n * Saturation integer value between 0 and 100\n * @public\n * @since 0.16.0\n */\n s: number;\n /**\n * Lightness integer value between 0 and 100\n * @public\n * @since 0.16.0\n */\n l: number;\n}\n\n/**\n * Converts HTML to a Markdown string.\n * @public\n */\nexport function htmlToMarkdown(html: string | HTMLElement | Document | DocumentFragment): string;\n\n/**\n * {@link Value} wrapping raw HTML.\n * @public\n * @since 1.10.0\n */\nexport class HTMLValue extends StringValue {\n\n}\n\n/**\n * {@link Value} wrapping a renderable icon.\n * @public\n * @since 1.10.0\n */\nexport class IconValue extends StringValue {\n\n}\n\n/**\n * {@link Value} wrapping a path to an image resource in the vault.\n * @public\n * @since 1.10.0\n */\nexport class ImageValue extends StringValue {\n\n}\n\n/**\n * @public\n * @since 0.9.20\n */\nexport interface Instruction {\n /**\n * @public\n * @since 0.9.20\n */\n command: string;\n /**\n * @public\n * @since 0.9.20\n */\n purpose: string;\n}\n\n/**\n * @public\n */\nexport interface ISuggestOwner {\n /**\n * Render the suggestion item into DOM.\n * @public\n */\n renderSuggestion(value: T, el: HTMLElement): void;\n /**\n * Called when the user makes a selection.\n * @public\n */\n selectSuggestion(value: T, evt: MouseEvent | KeyboardEvent): void;\n\n}\n\n/**\n * @public\n *@since 0.9.7\n */\nexport abstract class ItemView extends View {\n\n /** @public */\n contentEl: HTMLElement;\n\n /**\n * @public\n */\n constructor(leaf: WorkspaceLeaf);\n\n /**\n * @public\n * @since 1.1.0\n */\n addAction(icon: IconName, title: string, callback: (evt: MouseEvent) =&gt; any): HTMLElement;\n\n}\n\n/**\n * Iterate links and embeds.\n * If callback returns true, the iteration process will be interrupted.\n * @returns true if callback ever returns true, false otherwise.\n * @public\n * @deprecated\n */\nexport function iterateCacheRefs(cache: CachedMetadata, cb: (ref: ReferenceCache) =&gt; boolean | void): boolean;\n\n/**\n * If callback returns true, the iteration process will be interrupted.\n * @returns true if callback ever returns true, false otherwise.\n * @public\n */\nexport function iterateRefs(refs: Reference[], cb: (ref: Reference) =&gt; boolean | void): boolean;\n\n/**\n * Manages keymap lifecycle for different {@link Scope}s.\n *\n * @public\n * @since 0.13.9\n */\nexport class Keymap {\n\n /**\n * Push a scope onto the scope stack, setting it as the active scope to handle all key events.\n * @public\n * @since 0.13.9\n */\n pushScope(scope: Scope): void;\n /**\n * Remove a scope from the scope stack.\n * If the given scope is active, the next scope in the stack will be made active.\n * @public\n * @since 0.13.9\n */\n popScope(scope: Scope): void;\n\n /**\n * Checks whether the modifier key is pressed during this event.\n * @public\n * @since 0.12.17\n */\n static isModifier(evt: MouseEvent | TouchEvent | KeyboardEvent, modifier: Modifier): boolean;\n\n /**\n * Translates an event into the type of pane that should open.\n * Returns 'tab' if the modifier key Cmd/Ctrl is pressed OR if this is a middle-click MouseEvent.\n * Returns 'split' if Cmd/Ctrl+Alt is pressed.\n * Returns 'window' if Cmd/Ctrl+Alt+Shift is pressed.\n * @public\n * @since 0.16.0\n */\n static isModEvent(evt?: UserEvent | null): PaneType | boolean;\n}\n\n/**\n * @public\n */\nexport interface KeymapContext extends KeymapInfo {\n /**\n * Interpreted virtual key.\n * @public\n */\n vkey: string;\n}\n\n/**\n * @public\n */\nexport interface KeymapEventHandler extends KeymapInfo {\n /** @public */\n scope: Scope;\n\n}\n\n/**\n * Return &#96;false&#96; to automatically preventDefault\n * @public\n */\nexport type KeymapEventListener = (evt: KeyboardEvent, ctx: KeymapContext) =&gt; false | any;\n\n/**\n * @public\n * @since 0.10.4\n */\nexport interface KeymapInfo {\n /**\n * @public\n * @since 0.10.4\n */\n modifiers: string | null;\n /**\n * @public\n * @since 0.10.4\n */\n key: string | null;\n}\n\n/**\n * @public\n * @since 0.9.7\n */\nexport interface LinkCache extends ReferenceCache {\n}\n\n/**\n * {@link Value} wrapping an internal wikilink.\n * @public\n * @since 1.10.0\n */\nexport class LinkValue extends StringValue {\n\n /**\n * Create a new LinkValue from wikilink syntax.\n * @example\n * parseFromString(\"[[Welcome|Example Link]]\")\n *\n * @public\n * @since 1.10.0\n */\n static parseFromString(app: App, input: string, sourcePath: string): LinkValue | null;\n\n}\n\n/**\n * @public\n */\nexport interface ListedFiles {\n /** @public */\n files: string[];\n /** @public */\n folders: string[];\n}\n\n/**\n * @public\n */\nexport interface ListItemCache extends CacheItem {\n /**\n * The block ID of this list item, if defined.\n * @public\n */\n id?: string | undefined;\n /**\n * A single character indicating the checked status of a task.\n * The space character &#96;' '&#96; is interpreted as an incomplete task.\n * Any other character is interpreted as completed task.\n * &#96;undefined&#96; if this item isn't a task.\n * @public\n */\n task?: string | undefined;\n /**\n * Line number of the parent list item (position.start.line).\n * If this item has no parent (e.g. it's a root level list),\n * then this value is the negative of the line number of the first list item (start of the list).\n *\n * Can be used to deduce which list items belongs to the same group (item1.parent === item2.parent).\n * Can be used to reconstruct hierarchy information (parentItem.position.start.line === childItem.parent).\n * @public\n */\n parent: number;\n}\n\n/**\n * {@link Value} wrapping an array of Values. Values do not all need to be of the same type.\n * @public\n * @since 1.10.0\n */\nexport class ListValue extends NotNullValue {\n /**\n * @public\n * @since 1.10.0\n */\n static type: string;\n\n /**\n * The array passed in will be modified!\n * @param value - Contents of the list.\n * @public\n * @since 1.10.0\n */\n constructor(value: (unknown | Value)[]);\n\n /**\n * @public\n * @since 1.10.0\n */\n toString(): string;\n /**\n * @public\n * @since 1.10.0\n */\n isTruthy(): boolean;\n /**\n * @returns true if any elements in this list loosely equal the provided value.\n * @public\n * @since 1.10.0\n */\n includes(value: Value): boolean;\n\n /**\n * @returns the number of elements in this list.\n * @public\n * @since 1.10.0\n */\n length(): number;\n /**\n * @returns the value at the provided index, or {@link NullValue}.\n * @public\n * @since 1.10.0\n */\n get(index: number): Value;\n\n /**\n * @returns a new {@link ListValue} containing the elements from this ListValue and the provided ListValue.\n * @public\n * @since 1.10.0\n */\n concat(other: ListValue): ListValue;\n\n}\n\n/**\n * @public\n */\nexport const livePreviewState: ViewPlugin;\n\n/**\n * The object stored in the view plugin {@link livePreviewState}\n * @public\n */\nexport interface LivePreviewStateType {\n /**\n * True if the left mouse is currently held down in the editor\n * (for example, when drag-to-select text).\n * @public\n */\n mousedown: boolean;\n}\n\n/**\n * Load MathJax.\n * @see {@link https://www.mathjax.org/ Official MathJax documentation}\n * @public\n */\nexport function loadMathJax(): Promise;\n\n/**\n * Load Mermaid and return a promise to the global mermaid object.\n * Can also use &#96;mermaid&#96; after this promise resolves to get the same reference.\n * @see {@link https://mermaid.js.org/ Official Mermaid documentation}\n * @public\n */\nexport function loadMermaid(): Promise;\n\n/**\n * Load PDF.js and return a promise to the global pdfjsLib object.\n * Can also use &#96;window.pdfjsLib&#96; after this promise resolves to get the same reference.\n * @see {@link https://mozilla.github.io/pdf.js/ Official PDF.js documentation}\n * @public\n */\nexport function loadPdfJs(): Promise;\n\n/**\n * Load Prism.js and return a promise to the global Prism object.\n * Can also use &#96;Prism&#96; after this promise resolves to get the same reference.\n * @see {@link https://prismjs.com/ Official Prism documentation}\n * @public\n */\nexport function loadPrism(): Promise;\n\n/**\n * Location within a Markdown document\n * @public\n */\nexport interface Loc {\n /**\n * Line number. 0-based.\n * @public\n */\n line: number;\n /**\n * Column number.\n * @public\n */\n col: number;\n /**\n * Number of characters from the beginning of the file.\n * @public\n */\n offset: number;\n}\n\n/**\n * This is the editor for Obsidian Mobile as well as the WYSIWYG editor.\n * @public\n */\nexport class MarkdownEditView implements MarkdownSubView, HoverParent, MarkdownFileInfo {\n\n /** @public */\n app: App;\n\n /** @public */\n hoverPopover: HoverPopover;\n\n /**\n * @public\n */\n constructor(view: MarkdownView);\n\n /**\n * @public\n */\n clear(): void;\n /**\n * @public\n */\n get(): string;\n /**\n * @public\n */\n set(data: string, clear: boolean): void;\n\n /** @public */\n get file(): TFile;\n\n /**\n * @public\n */\n getSelection(): string;\n\n /**\n * @public\n */\n getScroll(): number;\n /**\n * @public\n */\n applyScroll(scroll: number): void;\n\n}\n\n/**\n * @public\n */\nexport interface MarkdownFileInfo extends HoverParent {\n /**\n * @public\n */\n app: App;\n /**\n * @public\n */\n get file(): TFile | null;\n\n /**\n * @public\n */\n editor?: Editor;\n}\n\n/**\n * A post processor receives an element which is a section of the preview.\n *\n * Post processors can mutate the DOM to render various things, such as mermaid graphs, latex equations, or custom controls.\n *\n * If your post processor requires lifecycle management, for example, to clear an interval, kill a subprocess, etc when this element is\n * removed from the app, look into {@link MarkdownPostProcessorContext.addChild}\n * @public\n * @since 0.10.12\n */\nexport interface MarkdownPostProcessor {\n /**\n * The processor function itself.\n * @public\n */\n (el: HTMLElement, ctx: MarkdownPostProcessorContext): Promise | void;\n /**\n * An optional integer sort order. Defaults to 0. Lower number runs before higher numbers.\n * @public\n */\n sortOrder?: number;\n}\n\n/**\n * @public\n */\nexport interface MarkdownPostProcessorContext {\n /**\n * @public\n */\n docId: string;\n /**\n * The path to the associated file. Any links are assumed to be relative to the &#96;sourcePath&#96;.\n * @public\n */\n sourcePath: string;\n /** @public */\n frontmatter: any | null | undefined;\n\n /**\n * Adds a child component that will have its lifecycle managed by the renderer.\n *\n * Use this to add a dependent child to the renderer such that if the containerEl\n * of the child is ever removed, the component's unload will be called.\n * @public\n */\n addChild(child: MarkdownRenderChild): void;\n /**\n * Gets the section information of this element at this point in time.\n * Only call this function right before you need this information to get the most up-to-date version.\n * This function may also return null in many circumstances; if you use it, you must be prepared to deal with nulls.\n * @public\n */\n getSectionInfo(el: HTMLElement): MarkdownSectionInformation | null;\n\n}\n\n/** @public **/\nexport interface MarkdownPreviewEvents extends Component {\n\n}\n\n/**\n * @public\n * @since 0.9.7\n */\nexport class MarkdownPreviewRenderer {\n\n /**\n * @public\n * @since 0.10.12\n */\n static registerPostProcessor(postProcessor: MarkdownPostProcessor, sortOrder?: number): void;\n /**\n * @public\n * @since 0.9.7\n */\n static unregisterPostProcessor(postProcessor: MarkdownPostProcessor): void;\n\n /**\n * @public\n * @since 0.12.11\n */\n static createCodeBlockPostProcessor(language: string, handler: (source: string, el: HTMLElement, ctx: MarkdownPostProcessorContext) =&gt; Promise | void): (el: HTMLElement, ctx: MarkdownPostProcessorContext) =&gt; void;\n\n}\n\n/**\n * @public\n */\nexport class MarkdownPreviewView extends MarkdownRenderer implements MarkdownSubView, MarkdownPreviewEvents {\n\n /**\n * @public\n */\n containerEl: HTMLElement;\n\n /**\n * @public\n */\n get file(): TFile;\n\n /**\n * @public\n */\n get(): string;\n /**\n * @public\n */\n set(data: string, clear: boolean): void;\n /**\n * @public\n */\n clear(): void;\n\n /**\n * @public\n */\n rerender(full?: boolean): void;\n\n /**\n * @public\n */\n getScroll(): number;\n /**\n * @public\n */\n applyScroll(scroll: number): void;\n\n}\n\n/**\n * @public\n */\nexport class MarkdownRenderChild extends Component {\n /** @public */\n containerEl: HTMLElement;\n /**\n * @param containerEl - This HTMLElement will be used to test whether this component is still alive.\n * It should be a child of the Markdown preview sections, and when it's no longer attached\n * (for example, when it is replaced with a new version because the user edited the Markdown source code),\n * this component will be unloaded.\n * @public\n */\n constructor(containerEl: HTMLElement);\n}\n\n/**\n * @public\n * @since 0.9.7\n */\nexport abstract class MarkdownRenderer extends MarkdownRenderChild implements MarkdownPreviewEvents, HoverParent {\n /** @public */\n app: App;\n\n /** @public */\n hoverPopover: HoverPopover | null;\n\n /** @public */\n abstract get file(): TFile;\n\n /**\n * Renders Markdown string to an HTML element.\n * @public\n * @deprecated - use {@link MarkdownRenderer.render}\n * @since 0.10.6\n */\n static renderMarkdown(markdown: string, el: HTMLElement, sourcePath: string, component: Component): Promise;\n /**\n * Renders Markdown string to an HTML element.\n * @param app - A reference to the app object\n * @param markdown - The Markdown source code\n * @param el - The element to append to\n * @param sourcePath - The normalized path of this Markdown file, used to resolve relative internal links\n * @param component - A parent component to manage the lifecycle of the rendered child components.\n * @public\n */\n static render(app: App, markdown: string, el: HTMLElement, sourcePath: string, component: Component): Promise;\n}\n\n/** @public */\nexport interface MarkdownSectionInformation {\n /** @public */\n text: string;\n /** @public */\n lineStart: number;\n /** @public */\n lineEnd: number;\n}\n\n/**\n * @public\n */\nexport interface MarkdownSubView {\n\n /**\n * @public\n */\n getScroll(): number;\n /**\n * @public\n */\n applyScroll(scroll: number): void;\n\n /**\n * @public\n */\n get(): string;\n /**\n * @public\n */\n set(data: string, clear: boolean): void;\n\n}\n\n/**\n * @public\n */\nexport class MarkdownView extends TextFileView implements MarkdownFileInfo {\n\n /** @public */\n editor: Editor;\n\n /** @public */\n previewMode: MarkdownPreviewView;\n\n /** @public */\n currentMode: MarkdownSubView;\n\n /** @public */\n hoverPopover: HoverPopover | null;\n /**\n * @public\n */\n constructor(leaf: WorkspaceLeaf);\n\n /**\n * @public\n */\n getViewType(): string;\n\n /**\n * @public\n */\n getMode(): MarkdownViewModeType;\n\n /**\n * @public\n */\n getViewData(): string;\n /**\n * @public\n */\n clear(): void;\n\n /**\n * @public\n */\n setViewData(data: string, clear: boolean): void;\n\n /**\n * @public\n */\n showSearch(replace?: boolean): void;\n\n}\n\n/**\n * @public\n */\nexport type MarkdownViewModeType = 'source' | 'preview';\n\n/**\n * @public\n */\nexport class Menu extends Component implements CloseableComponent {\n\n /**\n * @public\n */\n constructor();\n\n /**\n * @public\n */\n setNoIcon(): this;\n /**\n * Force this menu to use native or DOM.\n * (Only works on the desktop app)\n * @public\n * @since 0.16.0\n */\n setUseNativeMenu(useNativeMenu: boolean): this;\n\n /**\n * Adds a menu item. Only works when menu is not shown yet.\n * @public\n */\n addItem(cb: (item: MenuItem) =&gt; any): this;\n /**\n * Adds a separator. Only works when menu is not shown yet.\n * @public\n */\n addSeparator(): this;\n\n /**\n * @public\n * @since 0.12.6\n */\n showAtMouseEvent(evt: MouseEvent): this;\n /**\n * @public\n * @since 1.1.0\n */\n showAtPosition(position: MenuPositionDef, doc?: Document): this;\n /**\n * @public\n */\n hide(): this;\n /** @public */\n close(): void;\n /**\n * @public\n */\n onHide(callback: () =&gt; any): void;\n\n /**\n * @public\n * @since 1.6.0\n */\n static forEvent(evt: PointerEvent | MouseEvent): Menu;\n}\n\n/**\n * @public\n */\nexport class MenuItem {\n\n /**\n * Private constructor. Use {@link Menu.addItem} instead.\n * @public\n */\n private constructor();\n /**\n * @public\n */\n setTitle(title: string | DocumentFragment): this;\n /**\n * @param icon - ID of the icon, can use any icon loaded with {@link addIcon} or from the built-in lucide library.\n * @see The Obsidian icon library includes the {@link https://lucide.dev/ Lucide icon library}, any icon name from their site will work here.\n * @public\n */\n setIcon(icon: IconName | null): this;\n\n /**\n * @public\n */\n setChecked(checked: boolean | null): this;\n /**\n * @public\n */\n setDisabled(disabled: boolean): this;\n /**\n * @param state - If the warning state is enabled\n * If set to true the MenuItem's title and icon will become red. Or whatever color is applied to the class 'is-warning' by a theme.\n * @public\n * @since 0.15.0\n */\n setWarning(isWarning: boolean): this;\n /**\n * @public\n * @since 0.15.0\n */\n setIsLabel(isLabel: boolean): this;\n\n /**\n * @public\n */\n onClick(callback: (evt: MouseEvent | KeyboardEvent) =&gt; any): this;\n\n /**\n * Sets the section this menu item should belong in.\n * To find the section IDs of an existing menu, inspect the DOM elements\n * to see their &#96;data-section&#96; attribute.\n * @public\n */\n setSection(section: string): this;\n\n}\n\n/**\n * @public\n * @since 1.1.0\n */\nexport interface MenuPositionDef {\n /** @public */\n x: number;\n /** @public */\n y: number;\n /** @public */\n width?: number;\n /** @public */\n overlap?: boolean;\n /** @public */\n left?: boolean;\n}\n\n/**\n * @public\n * @since 0.15.3\n */\nexport class MenuSeparator {\n\n}\n\n/**\n *\n * Linktext is any internal link that is composed of a path and a subpath, such as 'My note#Heading'\n * Linkpath (or path) is the path part of a linktext\n * Subpath is the heading/block ID part of a linktext.\n *\n * @public\n */\nexport class MetadataCache extends Events {\n\n /**\n * Get the best match for a linkpath.\n * @public\n * @since 0.12.5\n */\n getFirstLinkpathDest(linkpath: string, sourcePath: string): TFile | null;\n\n /**\n * @public\n * @since 0.9.21\n */\n getFileCache(file: TFile): CachedMetadata | null;\n /**\n * @public\n * @since 0.14.5\n */\n getCache(path: string): CachedMetadata | null;\n\n /**\n * Generates a linktext for a file.\n *\n * If file name is unique, use the filename.\n * If not unique, use full path.\n * @public\n */\n fileToLinktext(file: TFile, sourcePath: string, omitMdExtension?: boolean): string;\n\n /**\n * Contains all resolved links. This object maps each source file's path to an object of destination file paths with the link count.\n * Source and destination paths are all vault absolute paths that comes from &#96;TFile.path&#96; and can be used with &#96;Vault.getAbstractFileByPath(path)&#96;.\n * @public\n */\n resolvedLinks: Record &gt;;\n /**\n * Contains all unresolved links. This object maps each source file to an object of unknown destinations with count.\n * Source paths are all vault absolute paths, similar to &#96;resolvedLinks&#96;.\n * @public\n */\n unresolvedLinks: Record &gt;;\n\n /**\n * Called when a file has been indexed, and its (updated) cache is now available.\n *\n * Note: This is not called when a file is renamed for performance reasons.\n * You must hook the vault rename event for those.\n * @public\n */\n on(name: 'changed', callback: (file: TFile, data: string, cache: CachedMetadata) =&gt; any, ctx?: any): EventRef;\n /**\n * Called when a file has been deleted. A best-effort previous version of the cached metadata is presented,\n * but it could be null in case the file was not successfully cached previously.\n * @public\n */\n on(name: 'deleted', callback: (file: TFile, prevCache: CachedMetadata | null) =&gt; any, ctx?: any): EventRef;\n\n /**\n * Called when a file has been resolved for &#96;resolvedLinks&#96; and &#96;unresolvedLinks&#96;.\n * This happens sometimes after a file has been indexed.\n * @public\n */\n on(name: 'resolve', callback: (file: TFile) =&gt; any, ctx?: any): EventRef;\n /**\n * Called when all files has been resolved. This will be fired each time files get modified after the initial load.\n * @public\n */\n on(name: 'resolved', callback: () =&gt; any, ctx?: any): EventRef;\n}\n\n/**\n * @public\n */\nexport class Modal implements CloseableComponent {\n /**\n * @public\n */\n app: App;\n /**\n * @public\n */\n scope: Scope;\n /**\n * @public\n */\n containerEl: HTMLElement;\n /**\n * @public\n */\n modalEl: HTMLElement;\n\n /**\n * @public\n */\n titleEl: HTMLElement;\n /**\n * @public\n */\n contentEl: HTMLElement;\n\n /**\n * @public\n * @since 0.9.16\n */\n shouldRestoreSelection: boolean;\n\n /**\n * @public\n */\n constructor(app: App);\n /**\n * Show the modal on the active window. On mobile, the modal will animate on screen.\n * @public\n */\n open(): void;\n\n /**\n * Hide the modal.\n * @public\n */\n close(): void;\n /**\n * @public\n */\n onOpen(): Promise | void;\n /**\n * @public\n */\n onClose(): void;\n\n /**\n * @public\n */\n setTitle(title: string): this;\n /**\n * @public\n */\n setContent(content: string | DocumentFragment): this;\n\n /**\n * @public\n * @since 1.10.0\n */\n setCloseCallback(callback: () =&gt; any): this;\n\n}\n\n/**\n * Mod = Cmd on MacOS and Ctrl on other OS\n * Ctrl = Ctrl key for every OS\n * Meta = Cmd on MacOS and Win key on other OS\n * @public\n */\nexport type Modifier = 'Mod' | 'Ctrl' | 'Meta' | 'Shift' | 'Alt';\n\n/** @public */\nexport const moment: typeof Moment;\n\n\n/**\n * @public\n * @since 0.9.7\n */\nexport class MomentFormatComponent extends TextComponent {\n /**\n * @public\n * @since 0.9.7\n */\n sampleEl: HTMLElement;\n\n /**\n * Sets the default format when input is cleared. Also used for placeholder.\n * @public\n * @since 0.9.7\n */\n setDefaultFormat(defaultFormat: string): this;\n /**\n * @public\n * @since 0.9.7\n */\n setSampleEl(sampleEl: HTMLElement): this;\n /**\n * @public\n * @since 0.9.7\n */\n setValue(value: string): this;\n /**\n * @public\n * @since 0.9.7\n */\n onChanged(): void;\n /**\n * @public\n * @since 0.9.7\n */\n updateSample(): void;\n}\n\n/**\n * @public\n * @since 1.10.0\n */\nexport interface MultitextOption extends BaseOption {\n /**\n * @public\n * @since 1.10.0\n */\n type: 'multitext';\n /**\n * @public\n * @since 1.10.0\n */\n default?: string[];\n}\n\n/**\n * @public\n */\nexport function normalizePath(path: string): string;\n\n/**\n * Notification component. Use to present timely, high-value information.\n * @public\n * @since 0.9.7\n */\nexport class Notice {\n /**\n * @public\n * @deprecated Use &#96;messageEl&#96; instead\n * @since 0.9.7\n */\n noticeEl: HTMLElement;\n /**\n * @public\n * @since 1.8.7\n */\n containerEl: HTMLElement;\n /**\n * @public\n * @since 1.8.7\n */\n messageEl: HTMLElement;\n\n /**\n * @param message - The message to be displayed, can either be a simple string or a {@link DocumentFragment}\n * @param duration - Time in milliseconds to show the notice for. If this is 0, the\n * Notice will stay visible until the user manually dismisses it.\n * @public\n */\n constructor(message: string | DocumentFragment, duration?: number);\n /**\n * Change the message of this notice.\n * @public\n * @since 0.9.7\n */\n setMessage(message: string | DocumentFragment): this;\n\n /**\n * @public\n * @since 0.9.7\n */\n hide(): void;\n}\n\n/**\n * Base type for all non-null {@link Values}.\n * @public\n * @since 1.10.0\n */\nexport abstract class NotNullValue extends Value {\n}\n\n/**\n * {@link Value} which represents null.\n * NullValue is a singleton and &#96;NullValue.value&#96; should be used instead of calling the constructor.\n * @public\n * @since 1.10.0\n */\nexport class NullValue extends Value {\n\n /**\n * @public\n * @since 1.10.0\n */\n toString(): string;\n /**\n * @public\n * @since 1.10.0\n */\n isTruthy(): boolean;\n\n /**\n * @public\n * @since 1.10.0\n */\n static value: NullValue;\n}\n\n/**\n * {@link Value} wrapping a number.\n * @public\n * @since 1.10.0\n */\nexport class NumberValue extends PrimitiveValue {\n /**\n * @public\n * @since 1.10.0\n */\n static type: string;\n\n}\n\n/**\n * {@link Value} wrapping an object.\n * @public\n * @since 1.10.0\n */\nexport class ObjectValue extends NotNullValue {\n /**\n * @public\n * @since 1.10.0\n */\n static type: string;\n\n /**\n * @public\n * @since 1.10.0\n */\n toString(): string;\n /**\n * @public\n * @since 1.10.0\n */\n isTruthy(): boolean;\n /**\n * @public\n * @since 1.10.0\n */\n isEmpty(): boolean;\n\n /**\n * @returns the {@link Value} associated with the provided key, or {@link NullValue}.\n * If the referenced property in the object is not a Value, it will be wrapped before returning.\n * @public\n * @since 1.10.0\n */\n get(key: string): Value | null;\n\n}\n\n/**\n * @public\n */\nexport interface ObsidianProtocolData {\n /** @public */\n action: string;\n /** @public */\n [key: string]: string | 'true';\n}\n\n/**\n * @public\n */\nexport type ObsidianProtocolHandler = (params: ObsidianProtocolData) =&gt; any;\n\n/**\n * @public\n */\nexport interface OpenViewState {\n /** @public */\n state?: Record;\n /** @public */\n eState?: Record;\n /** @public */\n active?: boolean;\n /** @public */\n group?: WorkspaceLeaf;\n}\n\n/**\n * @public\n */\nexport type PaneType = 'tab' | 'split' | 'window';\n\n/**\n * @public\n */\nexport function parseFrontMatterAliases(frontmatter: any | null): string[] | null;\n\n/**\n * @public\n */\nexport function parseFrontMatterEntry(frontmatter: any | null, key: string | RegExp): any | null;\n\n/**\n * @public\n */\nexport function parseFrontMatterStringArray(frontmatter: any | null, key: string | RegExp): string[] | null;\n\n/**\n * @public\n */\nexport function parseFrontMatterTags(frontmatter: any | null): string[] | null;\n\n/**\n * Parses the linktext of a wikilink into its component parts.\n * @param linktext A wikilink without the leading [[ and trailing ]]\n * @returns filepath and subpath (subpath can refer either to a block id, or a heading)\n * @public\n */\nexport function parseLinktext(linktext: string): {\n /**\n * @public\n */\n path: string;\n /**\n * @public\n */\n subpath: string;\n};\n\n/**\n * Split a Bases property ID into constituent parts.\n * @public\n * @since 1.10.0\n */\nexport function parsePropertyId(propertyId: BasesPropertyId): BasesProperty;\n\n/** @public */\nexport function parseYaml(yaml: string): any;\n\n/**\n * @public\n * @since 0.12.2\n */\nexport const Platform: {\n /**\n * The UI is in desktop mode.\n * @public\n */\n isDesktop: boolean;\n /**\n * The UI is in mobile mode.\n * @public\n */\n isMobile: boolean;\n /**\n * We're running the electron-based desktop app.\n * @public\n */\n isDesktopApp: boolean;\n /**\n * We're running the capacitor-js mobile app.\n * @public\n */\n isMobileApp: boolean;\n /**\n * We're running the iOS app.\n * @public\n */\n isIosApp: boolean;\n /**\n * We're running the Android app.\n * @public\n */\n isAndroidApp: boolean;\n /**\n * We're in a mobile app that has very limited screen space.\n * @public\n */\n isPhone: boolean;\n /**\n * We're in a mobile app that has sufficiently large screen space.\n * @public\n */\n isTablet: boolean;\n /**\n * We're on a macOS device, or a device that pretends to be one (like iPhones and iPads).\n * Typically used to detect whether to use command-based hotkeys vs ctrl-based hotkeys.\n * @public\n */\n isMacOS: boolean;\n /**\n * We're on a Windows device.\n * @public\n */\n isWin: boolean;\n /**\n * We're on a Linux device.\n * @public\n */\n isLinux: boolean;\n /**\n * We're running in Safari.\n * Typically used to provide workarounds for Safari bugs.\n * @public\n */\n isSafari: boolean;\n /**\n * The path prefix for resolving local files on this platform.\n * This returns:\n * - &#96;file:///&#96; on mobile\n * - &#96;app://random-id/&#96; on desktop (Replaces the old format of &#96;app://local/&#96;)\n * @public\n */\n resourcePathPrefix: string;\n\n};\n\n/**\n * @public\n * @since 0.9.7\n */\nexport abstract class Plugin extends Component {\n\n /**\n * @public\n * @since 0.9.7\n */\n app: App;\n /**\n * @public\n * @since 0.9.7\n */\n manifest: PluginManifest;\n /**\n * @public\n */\n constructor(app: App, manifest: PluginManifest);\n\n /**\n * @public\n * @since 0.9.7\n */\n onload(): Promise | void;\n /**\n * Adds a ribbon icon to the left bar.\n * @param icon - The icon name to be used. See {@link addIcon}\n * @param title - The title to be displayed in the tooltip.\n * @param callback - The &#96;click&#96; callback.\n * @public\n * @since 0.9.7\n */\n addRibbonIcon(icon: IconName, title: string, callback: (evt: MouseEvent) =&gt; any): HTMLElement;\n /**\n * Adds a status bar item to the bottom of the app.\n * Not available on mobile.\n * @see {@link https://docs.obsidian.md/Plugins/User+interface/Status+bar}\n * @return HTMLElement - element to modify.\n * @public\n * @since 0.9.7\n */\n addStatusBarItem(): HTMLElement;\n /**\n * Register a command globally.\n * Registered commands will be available from the {@link https://help.obsidian.md/Plugins/Command+palette Command palette}.\n * The command id and name will be automatically prefixed with this plugin's id and name.\n * @public\n * @since 0.9.7\n */\n addCommand(command: Command): Command;\n /**\n * Manually remove a command from the list of global commands.\n * This should not be needed unless your plugin registers commands dynamically.\n * @public\n * @since 1.7.2\n */\n removeCommand(commandId: string): void;\n /**\n * Register a settings tab, which allows users to change settings.\n * @see {@link https://docs.obsidian.md/Plugins/User+interface/Settings#Register+a+settings+tab}\n * @public\n * @since 0.9.7\n */\n addSettingTab(settingTab: PluginSettingTab): void;\n /**\n * @public\n * @since 0.9.7\n */\n registerView(type: string, viewCreator: ViewCreator): void;\n /**\n * Registers a view with the 'Page preview' core plugin as an emitter of the 'hover-link' event.\n * @public\n * @since 1.1.0\n */\n registerHoverLinkSource(id: string, info: HoverLinkSource): void;\n /**\n * @public\n * @since 0.9.7\n */\n registerExtensions(extensions: string[], viewType: string): void;\n /**\n * Registers a post processor, to change how the document looks in reading mode.\n * @see {@link https://docs.obsidian.md/Plugins/Editor/Markdown+post+processing}\n * @public\n * @since 0.9.7\n */\n registerMarkdownPostProcessor(postProcessor: MarkdownPostProcessor, sortOrder?: number): MarkdownPostProcessor;\n /**\n * Register a special post processor that handles fenced code given a language and a handler.\n * This special post processor takes care of removing the &#96; &#96; and create a &#96; &#96; that\n * will be passed to the handler, and is expected to be filled with custom elements.\n * @see {@link https://docs.obsidian.md/Plugins/Editor/Markdown+post+processing#Post-process+Markdown+code+blocks}\n * @public\n * @since 0.9.7\n */\n registerMarkdownCodeBlockProcessor(language: string, handler: (source: string, el: HTMLElement, ctx: MarkdownPostProcessorContext) =&gt; Promise | void, sortOrder?: number): MarkdownPostProcessor;\n /**\n * Register a Base view handler that can be used to render data from property queries.\n *\n * @returns false if bases are not enabled in this vault.\n * @public\n * @since 1.10.0\n */\n registerBasesView(viewId: string, registration: BasesViewRegistration): boolean;\n\n /**\n * Registers a CodeMirror 6 extension.\n * To reconfigure cm6 extensions for a plugin on the fly, an array should be passed in, and modified dynamically.\n * Once this array is modified, calling {@link Workspace.updateOptions} will apply the changes.\n * @param extension - must be a CodeMirror 6 &#96;Extension&#96;, or an array of Extensions.\n * @public\n * @since 0.12.8\n */\n registerEditorExtension(extension: Extension): void;\n /**\n * Register a handler for obsidian:// URLs.\n * @param action - the action string. For example, 'open' corresponds to &#96;obsidian://open&#96;.\n * @param handler - the callback to trigger. A key-value pair that is decoded from the query will be passed in.\n * For example, &#96;obsidian://open?key=value&#96; would generate &#96;{'action': 'open', 'key': 'value'}&#96;.\n * @public\n * @since 0.11.0\n */\n registerObsidianProtocolHandler(action: string, handler: ObsidianProtocolHandler): void;\n /**\n * Register an EditorSuggest which can provide live suggestions while the user is typing.\n * @public\n * @since 0.12.7\n */\n registerEditorSuggest(editorSuggest: EditorSuggest): void;\n /**\n * Load settings data from disk.\n * Data is stored in &#96;data.json&#96; in the plugin folder.\n * @see {@link https://docs.obsidian.md/Plugins/User+interface/Settings}\n * @public\n * @since 0.9.7\n */\n loadData(): Promise;\n /**\n * Write settings data to disk.\n * Data is stored in &#96;data.json&#96; in the plugin folder.\n * @see {@link https://docs.obsidian.md/Plugins/User+interface/Settings}\n * @public\n * @since 0.9.7\n */\n saveData(data: any): Promise;\n\n /**\n * Perform any initial setup code. The user has explicitly interacted with the plugin\n * so its safe to engage with the user. If your plugin registers a custom view,\n * you can open it here.\n * @public\n * @since 1.7.2\n */\n onUserEnable(): void;\n\n /**\n * Called when the &#96;data.json&#96; file is modified on disk externally from Obsidian.\n * This usually means that a Sync service or external program has modified\n * the plugin settings.\n *\n * Implement this method to reload plugin settings when they have changed externally.\n *\n * @public\n * @since 1.5.7\n */\n onExternalSettingsChange?(): any;\n}\n\n\n/**\n * Metadata about a Community plugin.\n * @see {@link https://docs.obsidian.md/Reference/Manifest}\n * @public\n */\nexport interface PluginManifest {\n /**\n * Vault path to the plugin folder in the config directory.\n * @public\n */\n dir?: string;\n /**\n * The plugin ID.\n * @public\n */\n id: string;\n /**\n * The display name.\n * @public\n */\n name: string;\n /**\n * The author's name.\n * @public\n */\n author: string;\n /**\n * The current version, using {@link https://semver.org/ Semantic Versioning}.\n * @public\n */\n version: string;\n /**\n * The minimum required Obsidian version to run this plugin.\n * @public\n */\n minAppVersion: string;\n /**\n * A description of the plugin.\n * @public\n */\n description: string;\n /**\n * A URL to the author's website.\n * @public\n */\n authorUrl?: string;\n\n /**\n * Whether the plugin can be used only on desktop.\n * @public\n */\n isDesktopOnly?: boolean;\n}\n\n/**\n * Provides a unified interface for users to configure the plugin.\n * @see {@link https://docs.obsidian.md/Plugins/User+interface/Settings#Register+a+settings+tab}\n * @public\n * @since 0.9.7\n */\nexport abstract class PluginSettingTab extends SettingTab {\n\n /**\n * @public\n */\n constructor(app: App, plugin: Plugin);\n}\n\n/**\n * @public\n */\nexport interface Point {\n /**\n * @public\n */\n x: number;\n /**\n * @public\n */\n y: number;\n}\n\n/**\n * @public\n */\nexport enum PopoverState {\n\n}\n\n/**\n * Base class for adding a type-ahead popover.\n * @public\n */\nexport abstract class PopoverSuggest implements ISuggestOwner, CloseableComponent {\n /** @public */\n app: App;\n /** @public */\n scope: Scope;\n\n /** @public */\n constructor(app: App, scope?: Scope);\n\n /** @public */\n open(): void;\n /** @public */\n close(): void;\n\n /**\n * @inheritDoc\n * @public\n */\n abstract renderSuggestion(value: T, el: HTMLElement): void;\n /**\n * @inheritDoc\n * @public\n */\n abstract selectSuggestion(value: T, evt: MouseEvent | KeyboardEvent): void;\n}\n\n/**\n * Describes a text range in a Markdown document.\n * @public\n */\nexport interface Pos {\n /**\n * Starting location.\n * @public\n */\n start: Loc;\n /**\n * End location.\n * @public\n */\n end: Loc;\n}\n\n/**\n * Construct a fuzzy search callback that runs on a target string.\n * Performance may be an issue if you are running the search for more than a few thousand times.\n * If performance is a problem, consider using &#96;prepareSimpleSearch&#96; instead.\n * @param query - the fuzzy query.\n * @return fn - the callback function to apply the search on.\n * @public\n */\nexport function prepareFuzzySearch(query: string): (text: string) =&gt; SearchResult | null;\n\n/**\n * Construct a simple search callback that runs on a target string.\n * @param query - the space-separated words\n * @return fn - the callback function to apply the search on\n * @public\n */\nexport function prepareSimpleSearch(query: string): (text: string) =&gt; SearchResult | null;\n\n/**\n * Base type for {@link Values} which wrap a single primitive.\n * @public\n * @since 1.10.0\n */\nexport abstract class PrimitiveValue extends NotNullValue {\n\n /**\n * @public\n * @since 1.10.0\n */\n constructor(value: T);\n /**\n * @public\n * @since 1.10.0\n */\n toString(): string;\n /**\n * @public\n * @since 1.10.0\n */\n isTruthy(): boolean;\n\n}\n\n/**\n * @public\n * @since 1.4.4\n */\nexport class ProgressBarComponent extends ValueComponent {\n\n /**\n * @public\n */\n constructor(containerEl: HTMLElement);\n /**\n * @public\n */\n getValue(): number;\n /**\n * @param value - The progress amount, a value between 0-100.\n * @public\n */\n setValue(value: number): this;\n\n}\n\n/**\n * A dropdown menu allowing selection of a property.\n * @public\n * @since 1.10.0\n */\nexport interface PropertyOption extends BaseOption {\n /**\n * @public\n * @since 1.10.0\n */\n type: 'property';\n /**\n * @public\n * @since 1.10.0\n */\n default?: string;\n /**\n * @public\n * @since 1.10.0\n */\n placeholder?: string;\n /**\n * If provided, only properties which pass the filter will be included for selection in the property dropdown.\n *\n * @public\n * @since 1.10.0\n */\n filter?: (prop: BasesPropertyId) =&gt; boolean;\n}\n\n/**\n * Responsible for executing the Bases query and evaluating filters and formulas.\n * Notifies views of updated results.\n * @public\n * @since 1.10.0\n */\nexport class QueryController extends Component {\n\n}\n\n/**\n * Base interface for items that point to a different location.\n * @public\n */\nexport interface Reference {\n /**\n * Link destination.\n * @public\n */\n link: string;\n /**\n * Contains the text as it's written in the document. Not available on Publish.\n * @public\n */\n original: string;\n /**\n * Available if title is different from link text, in the case of &#96;[[page name|display name]]&#96; this will return &#96;display name&#96;\n * @public\n */\n displayText?: string;\n}\n\n/**\n * @public\n */\nexport interface ReferenceCache extends Reference, CacheItem {\n}\n\n/**\n * @public\n * @since 1.8.7\n */\nexport interface ReferenceLinkCache extends CacheItem {\n /**\n * @public\n */\n id: string;\n /**\n * @public\n */\n link: string;\n}\n\n/**\n * {@link Value} wrapping a RegExp pattern.\n * @public\n * @since 1.10.0\n */\nexport class RegExpValue extends NotNullValue {\n\n /**\n * @public\n * @since 1.10.0\n */\n toString(): string;\n /**\n * @public\n * @since 1.10.0\n */\n isTruthy(): boolean;\n}\n\n/**\n * {@link Value} wrapping a Date.\n * RelativeDateValue behaves the same as a {@link DateValue} however it renders as a time relative to now.\n * @public\n * @since 1.10.0\n */\nexport class RelativeDateValue extends DateValue {\n\n}\n\n/**\n * Remove a custom icon from the library.\n * @param iconId - the icon ID\n * @public\n */\nexport function removeIcon(iconId: string): void;\n\n/**\n * Utility functions for rendering Values within the app.\n * @public\n * @since 1.10.0\n */\nexport class RenderContext implements HoverParent {\n\n /**\n * @public\n * @since 1.10.0\n */\n hoverPopover: HoverPopover | null;\n\n}\n\n/**\n * @public\n */\nexport function renderMatches(el: HTMLElement | DocumentFragment, text: string, matches: SearchMatches | null, offset?: number): void;\n\n/**\n * Render some LaTeX math using the MathJax engine. Returns an HTMLElement.\n * Requires calling &#96;finishRenderMath&#96; when rendering is all done to flush the MathJax stylesheet.\n * @public\n */\nexport function renderMath(source: string, display: boolean): HTMLElement;\n\n/**\n * @public\n */\nexport function renderResults(el: HTMLElement, text: string, result: SearchResult, offset?: number): void;\n\n/**\n * Similar to &#96;fetch()&#96;, request a URL using HTTP/HTTPS, without any CORS restrictions.\n * Returns the text value of the response.\n * @public\n * @since 0.12.11\n */\nexport function request(request: RequestUrlParam | string): Promise;\n\n/**\n * Similar to &#96;fetch()&#96;, request a URL using HTTP/HTTPS, without any CORS restrictions.\n * @public\n */\nexport function requestUrl(request: RequestUrlParam | string): RequestUrlResponsePromise;\n\n/** @public */\nexport interface RequestUrlParam {\n /** @public */\n url: string;\n /** @public */\n method?: string;\n /** @public */\n contentType?: string;\n /** @public */\n body?: string | ArrayBuffer;\n /** @public */\n headers?: Record;\n /**\n * Whether to throw an error when the status code is 400+\n * Defaults to true\n * @public\n */\n throw?: boolean;\n}\n\n/** @public */\nexport interface RequestUrlResponse {\n /** @public */\n status: number;\n /** @public */\n headers: Record;\n /** @public */\n arrayBuffer: ArrayBuffer;\n /** @public */\n json: any;\n /** @public */\n text: string;\n}\n\n/** @public */\nexport interface RequestUrlResponsePromise extends Promise {\n /** @public */\n arrayBuffer: Promise;\n /** @public */\n json: Promise;\n /** @public */\n text: Promise;\n}\n\n/**\n * Returns true if the API version is equal or higher than the requested version.\n * Use this to limit functionality that require specific API versions to avoid\n * crashing on older Obsidian builds.\n * @public\n */\nexport function requireApiVersion(version: string): boolean;\n\n/**\n * Resolve the given subpath to a reference in the MetadataCache.\n * @public\n */\nexport function resolveSubpath(cache: CachedMetadata, subpath: string): HeadingSubpathResult | BlockSubpathResult | FootnoteSubpathResult | null;\n\n/**\n * @public\n * @since 0.16.0\n */\nexport interface RGB {\n /**\n * Red integer value between 0 and 255\n * @public\n */\n r: number;\n /**\n * Green integer value between 0 and 255\n * @public\n */\n g: number;\n /**\n * Blue integer value between 0 and 255\n * @public\n */\n b: number;\n}\n\n/** @public */\nexport function sanitizeHTMLToDom(html: string): DocumentFragment;\n\n/**\n * A scope receives keyboard events and binds callbacks to given hotkeys.\n * Only one scope is active at a time, but scopes may define parent scopes (in the constructor) and inherit their hotkeys.\n * @public\n */\nexport class Scope {\n\n /**\n * @public\n */\n constructor(parent?: Scope);\n /**\n * Add a keymap event handler to this scope.\n * @param modifiers - &#96;Mod&#96;, &#96;Ctrl&#96;, &#96;Meta&#96;, &#96;Shift&#96;, or &#96;Alt&#96;. &#96;Mod&#96; translates to &#96;Meta&#96; on macOS and &#96;Ctrl&#96; otherwise. Pass &#96;null&#96; to capture all events matching the &#96;key&#96;, regardless of modifiers.\n * @param key - Keycode from https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key%5FValues\n * @param func - the callback that will be called when a user triggers the keybind.\n * @public\n */\n register(modifiers: Modifier[] | null, key: string | null, func: KeymapEventListener): KeymapEventHandler;\n /**\n * Remove an existing keymap event handler.\n * @public\n */\n unregister(handler: KeymapEventHandler): void;\n\n}\n\n/**\n * @public\n * @since 0.9.21\n */\nexport class SearchComponent extends AbstractTextComponent {\n /**\n * @public\n * @since 0.9.21\n */\n clearButtonEl: HTMLElement;\n\n /**\n * @public\n */\n constructor(containerEl: HTMLElement);\n /**\n * @public\n */\n onChanged(): void;\n\n}\n\n/**\n * @public\n */\nexport type SearchMatches = SearchMatchPart[];\n\n/**\n * Text position offsets within text file. Represents\n * a text range [from offset, to offset].\n *\n * @public\n */\nexport type SearchMatchPart = [number, number];\n\n/**\n * @public\n * @since 0.9.21\n */\nexport interface SearchResult {\n /** @public */\n score: number;\n /** @public */\n matches: SearchMatches;\n}\n\n/**\n * @public\n * @since 0.9.21\n */\nexport interface SearchResultContainer {\n /** @public */\n match: SearchResult;\n}\n\n/**\n * @public\n * @since 1.11.1\n */\nexport class SecretComponent extends BaseComponent {\n\n /**\n * @public\n */\n constructor(app: App, containerEl: HTMLElement);\n /**\n * @public\n * @since 1.11.4\n */\n setValue(value: string): this;\n /**\n * @public\n * @since 1.11.4\n */\n onChange(cb: (value: string) =&gt; unknown): this;\n}\n\n/**\n * @public\n * @since 1.11.4\n */\nexport class SecretStorage {\n\n /**\n * @public\n * @since 1.11.4\n */\n private loadSecrets;\n\n /**\n * Sets a secret in the storage.\n * @param id Lowercase alphanumeric ID with optional dashes\n * @param secret The secret value to store\n * @throws Error if ID is invalid\n * @public\n * @since 1.11.4\n */\n setSecret(id: string, secret: string): void;\n /**\n * Gets a secret from storage\n * @param id The secret ID\n * @returns The secret value or null if not found\n * @public\n * @since 1.11.4\n */\n getSecret(id: string): string | null;\n /**\n * Lists all secrets in storage\n * @returns Array of secret IDs\n * @public\n * @since 1.11.4\n */\n listSecrets(): string[];\n\n}\n\n/**\n * @public\n */\nexport interface SectionCache extends CacheItem {\n /**\n * The block ID of this section, if defined.\n * @public\n */\n id?: string | undefined;\n /**\n * The type string generated by the parser.\n * Typing is non-exhaustive, more types can be available than are documented here.\n * @public\n */\n type: 'blockquote' | 'callout' | 'code' | 'element' | 'footnoteDefinition' | 'heading' | 'html' | 'list' | 'paragraph' | 'table' | 'text' | 'thematicBreak' | 'yaml' | string;\n}\n\n/**\n * Insert an SVG into the element from an iconId. Does nothing if no icon associated with the iconId.\n * @param parent - the HTML element to insert the icon\n * @param iconId - the icon ID\n * @see The Obsidian icon library includes the {@link https://lucide.dev/ Lucide icon library}, any icon name from their site will work here.\n * @public\n */\nexport function setIcon(parent: HTMLElement, iconId: IconName): void;\n\n/**\n * @public\n * @since 0.9.7\n */\nexport class Setting {\n /** @public\n * @since 0.9.7\n */\n settingEl: HTMLElement;\n /**\n * @public\n * @since 0.9.7\n */\n infoEl: HTMLElement;\n /**\n * @public\n * @since 0.9.7\n */\n nameEl: HTMLElement;\n /**\n * @public\n * @since 0.9.7\n */\n descEl: HTMLElement;\n /**\n * @public\n * @since 0.9.7\n */\n controlEl: HTMLElement;\n /**\n * @public\n * @since 0.9.7\n */\n components: BaseComponent[];\n /**\n * @public\n */\n constructor(containerEl: HTMLElement);\n /**\n * @public\n * @since 0.12.16\n */\n setName(name: string | DocumentFragment): this;\n /**\n * @public\n * @since 0.9.7\n */\n setDesc(desc: string | DocumentFragment): this;\n /**\n * @public\n * @since 0.9.7\n */\n setClass(cls: string): this;\n /**\n * @public\n * @since 1.1.0\n */\n setTooltip(tooltip: string, options?: TooltipOptions): this;\n /**\n * @public\n * @since 0.9.16\n */\n setHeading(): this;\n /**\n * @public\n * @since 1.2.3\n */\n setDisabled(disabled: boolean): this;\n\n /**\n * @public\n * @since 0.9.7\n */\n addButton(cb: (component: ButtonComponent) =&gt; any): this;\n /**\n * @public\n * @since 0.9.16\n */\n addExtraButton(cb: (component: ExtraButtonComponent) =&gt; any): this;\n /**\n * @public\n * @since 0.9.7\n */\n addToggle(cb: (component: ToggleComponent) =&gt; any): this;\n /**\n * @public\n * @since 0.9.7\n */\n addText(cb: (component: TextComponent) =&gt; any): this;\n /**\n * @public\n * @since 1.11.0\n */\n addComponent (cb: (el: HTMLElement) =&gt; T): this;\n /**\n * @public\n * @since 0.9.21\n */\n addSearch(cb: (component: SearchComponent) =&gt; any): this;\n /**\n * @public\n * @since 0.9.7\n */\n addTextArea(cb: (component: TextAreaComponent) =&gt; any): this;\n /**\n * @public\n * @since 0.9.7\n */\n addMomentFormat(cb: (component: MomentFormatComponent) =&gt; any): this;\n /**\n * @public\n * @ince 0.9.7\n */\n addDropdown(cb: (component: DropdownComponent) =&gt; any): this;\n /**\n * @public\n * @ince 0.16.0\n */\n addColorPicker(cb: (component: ColorComponent) =&gt; any): this;\n /**\n * @public\n * @ince 1.4.4\n */\n addProgressBar(cb: (component: ProgressBarComponent) =&gt; any): this;\n /**\n * @public\n * @since 0.9.7\n */\n addSlider(cb: (component: SliderComponent) =&gt; any): this;\n /**\n * Facilitates chaining\n * @public\n * @since 0.9.20\n */\n then(cb: (setting: this) =&gt; any): this;\n /**\n * @public\n * @since 0.13.8\n */\n clear(): this;\n\n}\n\n/**\n * @public\n * @since 1.11.0\n */\nexport class SettingGroup {\n\n /**\n * @public\n * @since 1.11.0\n */\n constructor(containerEl: HTMLElement);\n /**\n * @public\n * @since 1.11.0\n */\n setHeading(text: string | DocumentFragment): this;\n /**\n * @public\n * @since 1.11.0\n */\n addClass(cls: string): this;\n /**\n * @public\n * @since 1.11.0\n */\n addSetting(cb: (setting: Setting) =&gt; void): this;\n /**\n * Add a search input at the beginning of the setting group. Useful for filtering\n * results or adding an input for quick entry.\n * @public\n * @since 1.11.0\n */\n addSearch(cb: (component: SearchComponent) =&gt; any): this;\n /**\n * @public\n * @since 1.11.0\n */\n addExtraButton(cb: (component: ExtraButtonComponent) =&gt; any): this;\n}\n\n/**\n * @public\n * @see {@link https://docs.obsidian.md/Plugins/User+interface/Settings#Register+a+settings+tab}\n * @since 0.9.7\n */\nexport abstract class SettingTab {\n\n /**\n * The icon to display in the settings sidebar.\n * @public\n * @since 1.11.0\n */\n icon: IconName;\n /**\n * Reference to the app instance.\n * @public\n */\n app: App;\n\n /**\n * HTML element for the setting tab content.\n * @public\n */\n containerEl: HTMLElement;\n\n /**\n * Called when the settings tab should be rendered.\n * @see {@link https://docs.obsidian.md/Plugins/User+interface/Settings#Register+a+settings+tab}\n * @public\n */\n abstract display(): void;\n /**\n * Hides the contents of the setting tab.\n * Any registered components should be unloaded when the view is hidden.\n * Override this if you need to perform additional cleanup.\n * @public\n */\n hide(): void;\n}\n\n/**\n * @param el - The element to show the tooltip on\n * @param tooltip - The tooltip text to show\n * @param options\n * @public\n * @since 1.4.4\n */\nexport function setTooltip(el: HTMLElement, tooltip: string, options?: TooltipOptions): void;\n\n/**\n * @public\n */\nexport type Side = 'left' | 'right';\n\n/**\n * @public\n * @since 0.9.7\n */\nexport class SliderComponent extends ValueComponent {\n /**\n * @public\n */\n sliderEl: HTMLInputElement;\n\n /**\n * @public\n */\n constructor(containerEl: HTMLElement);\n /**\n * @public\n * @since 1.2.3\n */\n setDisabled(disabled: boolean): this;\n /**\n * @param instant whether or not the value should get updated while the slider is dragging\n * @public\n * @since 1.6.6\n */\n setInstant(instant: boolean): this;\n /**\n * @public\n * @since 0.9.7\n */\n setLimits(min: number | null, max: number | null, step: number | 'any'): this;\n /**\n * @public\n * @since 0.9.7\n */\n getValue(): number;\n /**\n * @public\n * @since 0.9.7\n */\n setValue(value: number): this;\n /**\n * @public\n * @since 0.9.7\n */\n getValuePretty(): string;\n /**\n * @public\n * @since 0.9.7\n */\n setDynamicTooltip(): this;\n /**\n * @public\n * @since 0.9.7\n */\n showTooltip(): void;\n /**\n * @public\n * @since 0.9.7\n */\n onChange(callback: (value: number) =&gt; any): this;\n}\n\n/**\n * @public\n * @since 1.10.0\n */\nexport interface SliderOption extends BaseOption {\n /**\n * @public\n * @since 1.10.0\n */\n type: 'slider';\n /**\n * @public\n * @since 1.10.0\n */\n default?: number;\n /**\n * @public\n * @since 1.10.0\n */\n min?: number;\n /**\n * @public\n * @since 1.10.0\n */\n max?: number;\n /**\n * @public\n * @since 1.10.0\n */\n step?: number;\n /**\n * @public\n * @since 1.10.0\n */\n instant?: boolean;\n}\n\n/**\n * @public\n */\nexport function sortSearchResults(results: SearchResultContainer[]): void;\n\n/**\n * @public\n */\nexport type SplitDirection = 'vertical' | 'horizontal';\n\n/** @public */\nexport interface Stat {\n /** @public */\n type: 'file' | 'folder';\n /**\n * Time of creation, represented as a unix timestamp.\n * @public\n */\n ctime: number;\n /**\n * Time of last modification, represented as a unix timestamp.\n * @public\n */\n mtime: number;\n /**\n * Size on disk, as bytes.\n * @public\n */\n size: number;\n}\n\n/** @public */\nexport function stringifyYaml(obj: any): string;\n\n/**\n * {@link Value} wrapping a string.\n * @public\n * @since 1.10.0\n */\nexport class StringValue extends PrimitiveValue {\n /**\n * @public\n * @since 1.10.0\n */\n static type: string;\n\n}\n\n/**\n * Normalizes headings for link matching by stripping out special characters and shrinking consecutive spaces.\n * @public\n */\nexport function stripHeading(heading: string): string;\n\n/**\n * Prepares headings for linking by stripping out some bad combinations of special characters that could break links.\n * @public\n */\nexport function stripHeadingForLink(heading: string): string;\n\n/**\n * @public\n */\nexport interface SubpathResult {\n /**\n * @public\n */\n start: Loc;\n /**\n * @public\n */\n end: Loc | null;\n}\n\n/**\n * @public\n * @ince 0.9.20\n */\nexport abstract class SuggestModal extends Modal implements ISuggestOwner {\n /**\n * @public\n * @ince 0.9.20\n */\n limit: number;\n /**\n * @public\n * @since 0.9.20\n */\n emptyStateText: string;\n\n /**\n * @public\n * @0.9.20\n */\n inputEl: HTMLInputElement;\n\n /**\n * @public\n * @since 0.9.20\n */\n resultContainerEl: HTMLElement;\n\n /**\n * @public\n */\n constructor(app: App);\n /**\n * @public\n * @since 0.9.20\n */\n setPlaceholder(placeholder: string): void;\n /**\n * @public\n * @since 0.9.20\n */\n setInstructions(instructions: Instruction[]): void;\n\n /**\n * @public\n * @since 0.9.20\n */\n onNoSuggestion(): void;\n /**\n * @public\n * @since 0.9.20\n */\n selectSuggestion(value: T, evt: MouseEvent | KeyboardEvent): void;\n /**\n * @public\n * @since 1.7.2\n */\n selectActiveSuggestion(evt: MouseEvent | KeyboardEvent): void;\n /**\n * @public\n * @since 1.5.7\n */\n abstract getSuggestions(query: string): T[] | Promise;\n /**\n * @public\n * @since 1.5.7\n */\n abstract renderSuggestion(value: T, el: HTMLElement): void;\n /**\n * @public\n * @since 1.5.7\n */\n abstract onChooseSuggestion(item: T, evt: MouseEvent | KeyboardEvent): void;\n}\n\n/**\n * This can be either a &#96;TFile&#96; or a &#96;TFolder&#96;.\n * @public\n * @since 0.9.7\n */\nexport abstract class TAbstractFile {\n /**\n * @public\n * @since 0.9.7\n */\n vault: Vault;\n /**\n * @public\n * @since 0.9.7\n */\n path: string;\n /**\n * @public\n * @since 0.9.7\n */\n name: string;\n /**\n * @public\n * @since 0.9.7\n */\n parent: TFolder | null;\n\n}\n\n/**\n * @public\n * @since 0.9.7\n */\nexport interface TagCache extends CacheItem {\n /**\n * @public\n */\n tag: string;\n}\n\n/**\n * {@link Value} wrapping an Obsidian tag.\n * @public\n * @since 1.10.0\n */\nexport class TagValue extends StringValue {\n\n /**\n * @public\n * @since 1.10.0\n */\n constructor(value: string);\n\n}\n\n/**\n * @public\n * @since 0.10.2\n */\nexport class Tasks {\n\n /**\n * @public\n * @since 0.10.2\n */\n add(callback: () =&gt; Promise): void;\n /**\n * @public\n * @since 0.10.2\n */\n addPromise(promise: Promise): void;\n /**\n * @public\n * @since 0.10.2\n */\n isEmpty(): boolean;\n /**\n * @public\n * @since 0.10.2\n */\n promise(): Promise;\n}\n\n/**\n * @public\n * @since 0.9.7\n */\nexport class TextAreaComponent extends AbstractTextComponent {\n /**\n * @public\n */\n constructor(containerEl: HTMLElement);\n}\n\n/**\n * @public\n * @since 0.9.21\n */\nexport class TextComponent extends AbstractTextComponent {\n /**\n * @public\n */\n constructor(containerEl: HTMLElement);\n\n}\n\n/**\n * This class implements a plaintext-based editable file view, which can be loaded and saved given an editor.\n *\n * Note that by default, this view only saves when it's closing. To implement auto-save, your editor should\n * call &#96;this.requestSave()&#96; when the content is changed.\n * @public\n * @since 0.10.12\n */\nexport abstract class TextFileView extends EditableFileView {\n\n /**\n * In memory data\n * @public\n * @since 0.10.12\n */\n data: string;\n /**\n * Debounced save in 2 seconds from now\n * @public\n * @since 0.10.12\n */\n requestSave: () =&gt; void;\n\n /**\n * @public\n */\n constructor(leaf: WorkspaceLeaf);\n\n /**\n * @public\n * @since 0.10.12\n */\n onUnloadFile(file: TFile): Promise;\n /**\n * @public\n * @since 0.10.12\n */\n onLoadFile(file: TFile): Promise;\n\n /**\n * @public\n * @since 0.10.12\n */\n save(clear?: boolean): Promise;\n\n /**\n * Gets the data from the editor. This will be called to save the editor contents to the file.\n * @public\n * @since 0.10.12\n */\n abstract getViewData(): string;\n /**\n * Set the data to the editor. This is used to load the file contents.\n *\n * If clear is set, then it means we're opening a completely different file.\n * In that case, you should call clear(), or implement a slightly more efficient\n * clearing mechanism given the new data to be set.\n * @public\n * @since 0.10.12\n */\n abstract setViewData(data: string, clear: boolean): void;\n /**\n * Clear the editor. This is usually called when we're about to open a completely\n * different file, so it's best to clear any editor states like undo-redo history,\n * and any caches/indexes associated with the previous file contents.\n * @public\n * @since 0.10.12\n */\n abstract clear(): void;\n}\n\n/**\n * @public\n * @since 1.10.0\n */\nexport interface TextOption extends BaseOption {\n /**\n * @public\n * @since 1.10.0\n */\n type: 'text';\n /**\n * @public\n * @since 1.10.0\n */\n default?: string;\n /**\n * @public\n * @since 1.10.0\n */\n placeholder?: string;\n}\n\n/**\n * @public\n * @since 0.9.7\n */\nexport class TFile extends TAbstractFile {\n /**\n * @public\n * @since 0.9.7\n */\n stat: FileStats;\n /**\n * @public\n * @since 0.9.7\n */\n basename: string;\n /**\n * @public\n * @since 0.9.7\n */\n extension: string;\n\n}\n\n/**\n * @public\n * @since 0.9.7\n */\nexport class TFolder extends TAbstractFile {\n /**\n * @public\n * @since 0.9.7\n */\n children: TAbstractFile[];\n\n /**\n * @public\n * @since 0.9.7\n */\n isRoot(): boolean;\n\n}\n\n/**\n * @public\n * @since 0.9.7\n */\nexport class ToggleComponent extends ValueComponent {\n /**\n * @public\n * @since 0.9.7\n */\n toggleEl: HTMLElement;\n\n /**\n * @public\n * @since 0.9.7\n */\n constructor(containerEl: HTMLElement);\n /**\n * @public\n * @since 1.2.3\n */\n setDisabled(disabled: boolean): this;\n /**\n * @public\n * @since 0.9.7\n */\n getValue(): boolean;\n /**\n * @public\n * @since 0.9.7\n */\n setValue(on: boolean): this;\n\n /**\n * @public\n * @since 1.1.1\n */\n setTooltip(tooltip: string, options?: TooltipOptions): this;\n /**\n * @public\n * @since 0.9.7\n */\n onClick(): void;\n /**\n * @public\n * @since 0.9.7\n */\n onChange(callback: (value: boolean) =&gt; any): this;\n}\n\n/**\n * @public\n * @since 1.10.0\n */\nexport interface ToggleOption extends BaseOption {\n /**\n * @public\n * @since 1.10.0\n */\n type: 'toggle';\n /**\n * @public\n * @since 1.10.0\n */\n default?: boolean;\n}\n\n/** @public */\nexport interface TooltipOptions {\n /** @public */\n placement?: TooltipPlacement;\n /**\n * @public\n * @since 1.8.7\n */\n classes?: string[];\n /**\n * @public\n * @since 1.8.7\n */\n gap?: number;\n\n /**\n * @public\n * @since 1.4.11\n */\n delay?: number;\n}\n\n/** @public */\nexport type TooltipPlacement = 'bottom' | 'right' | 'left' | 'top';\n\n/**\n * {@link Value} wrapping an external link.\n * @public\n * @since 1.10.0\n */\nexport class UrlValue extends StringValue {\n\n}\n\n/**\n * @public\n */\nexport type UserEvent = MouseEvent | KeyboardEvent | TouchEvent | PointerEvent;\n\n/**\n * Container type for data which can expose functions for retrieving, comparing, and rendering the data.\n * Most commonly used in conjunction with formulas for Bases. Values can be used as formula parameters,\n * intermediate values, and the result of evaluation.\n * @public\n * @since 1.10.0\n */\nexport abstract class Value {\n /**\n * @public\n * @since 1.10.0\n */\n static type: string;\n\n /**\n * @public\n * @since 1.10.0\n */\n static equals(a: Value | null, b: Value | null): boolean;\n /**\n * @public\n * @since 1.10.0\n */\n static looseEquals(a: Value | null, b: Value | null): boolean;\n\n /**\n * @public\n * @since 1.10.0\n */\n abstract toString(): string;\n /**\n * @public\n * @since 1.10.0\n */\n abstract isTruthy(): boolean;\n /**\n * @public\n * @since 1.10.0\n */\n equals(other: this): boolean;\n /**\n * @public\n * @since 1.10.0\n */\n looseEquals(other: Value): boolean;\n /**\n * Render this value into the provided HTMLElement.\n * @public\n * @since 1.10.0\n */\n renderTo(el: HTMLElement, ctx: RenderContext): void;\n\n}\n\n/**\n * @public\n * @since 0.9.7\n */\nexport abstract class ValueComponent extends BaseComponent {\n /**\n * @public\n * @since 0.9.7\n */\n registerOptionListener(listeners: Record T&gt;, key: string): this;\n /**\n * @public\n * @since 0.9.7\n */\n abstract getValue(): T;\n /**\n * @public\n * @since 0.9.7\n */\n abstract setValue(value: T): this;\n}\n\n/**\n * Work with files and folders stored inside a vault.\n * @see {@link https://docs.obsidian.md/Plugins/Vault}\n * @public\n * @since 0.9.7\n */\nexport class Vault extends Events {\n /**\n * @public\n * @since 0.9.7\n */\n adapter: DataAdapter;\n\n /**\n * Gets the path to the config folder.\n * This value is typically &#96;.obsidian&#96; but it could be different.\n * @public\n * @since 0.11.1\n */\n configDir: string;\n\n /**\n * Gets the name of the vault.\n * @public\n * @since 0.9.7\n */\n getName(): string;\n\n /**\n * Get a file inside the vault at the given path.\n * Returns &#96;null&#96; if the file does not exist.\n *\n * @param path\n * @public\n * @since 1.5.7\n */\n getFileByPath(path: string): TFile | null;\n /**\n * Get a folder inside the vault at the given path.\n * Returns &#96;null&#96; if the folder does not exist.\n *\n * @param path\n * @public\n * @since 1.5.7\n */\n getFolderByPath(path: string): TFolder | null;\n /**\n * Get a file or folder inside the vault at the given path. To check if the return type is\n * a file, use &#96;instanceof TFile&#96;. To check if it is a folder, use &#96;instanceof TFolder&#96;.\n * @param path - vault absolute path to the folder or file, with extension, case sensitive.\n * @returns the abstract file, if it's found.\n * @public\n * @since 0.11.11\n */\n getAbstractFileByPath(path: string): TAbstractFile | null;\n\n /**\n * Get the root folder of the current vault.\n * @public\n * @since 0.9.7\n */\n getRoot(): TFolder;\n\n /**\n * Create a new plaintext file inside the vault.\n * @param path - Vault absolute path for the new file, with extension.\n * @param data - text content for the new file.\n * @param options - (Optional)\n * @public\n * @since 0.9.7\n */\n create(path: string, data: string, options?: DataWriteOptions): Promise;\n /**\n * Create a new binary file inside the vault.\n * @param path - Vault absolute path for the new file, with extension.\n * @param data - content for the new file.\n * @param options - (Optional)\n * @throws Error if file already exists\n * @public\n * @since 0.9.7\n */\n createBinary(path: string, data: ArrayBuffer, options?: DataWriteOptions): Promise;\n /**\n * Create a new folder inside the vault.\n * @param path - Vault absolute path for the new folder.\n * @throws Error if folder already exists\n * @public\n * @since 1.4.0\n */\n createFolder(path: string): Promise;\n /**\n * Read a plaintext file that is stored inside the vault, directly from disk.\n * Use this if you intend to modify the file content afterwards.\n * Use {@link Vault.cachedRead} otherwise for better performance.\n * @public\n * @since 0.9.7\n */\n read(file: TFile): Promise;\n /**\n * Read the content of a plaintext file stored inside the vault\n * Use this if you only want to display the content to the user.\n * If you want to modify the file content afterward use {@link Vault.read}\n * @public\n * @since 0.9.7\n */\n cachedRead(file: TFile): Promise;\n /**\n * Read the content of a binary file stored inside the vault.\n * @public\n * @since 0.9.7\n */\n readBinary(file: TFile): Promise;\n\n /**\n * Returns a URI for the browser engine to use, for example to embed an image.\n * @public\n * @since 0.9.7\n */\n getResourcePath(file: TFile): string;\n /**\n * Deletes the file completely.\n * @param file - The file or folder to be deleted\n * @param force - Should attempt to delete folder even if it has hidden children\n * @public\n * @since 0.9.7\n */\n delete(file: TAbstractFile, force?: boolean): Promise;\n /**\n * Tries to move to system trash. If that isn't successful/allowed, use local trash\n * @param file - The file or folder to be deleted\n * @param system - Set to &#96;false&#96; to use local trash by default.\n * @public\n * @since 0.9.7\n */\n trash(file: TAbstractFile, system: boolean): Promise;\n /**\n * Rename or move a file. To ensure links are automatically renamed,\n * use {@link FileManager.renameFile} instead.\n * @param file - the file to rename/move\n * @param newPath - vault absolute path to move file to.\n * @public\n * @since 0.9.11\n */\n rename(file: TAbstractFile, newPath: string): Promise;\n /**\n * Modify the contents of a plaintext file.\n * @param file - The file\n * @param data - The new file content\n * @param options - (Optional)\n * @public\n * @since 0.9.7\n */\n modify(file: TFile, data: string, options?: DataWriteOptions): Promise;\n /**\n * Modify the contents of a binary file.\n * @param file - The file\n * @param data - The new file content\n * @param options - (Optional)\n * @public\n * @since 0.9.7\n */\n modifyBinary(file: TFile, data: ArrayBuffer, options?: DataWriteOptions): Promise;\n /**\n * Add text to the end of a plaintext file inside the vault.\n * @param file - The file\n * @param data - the text to add\n * @param options - (Optional)\n * @public\n * @since 0.13.0\n */\n append(file: TFile, data: string, options?: DataWriteOptions): Promise;\n /**\n * Atomically read, modify, and save the contents of a note.\n * @param file - the file to be read and modified.\n * @param fn - a callback function which returns the new content of the note synchronously.\n * @param options - write options.\n * @returns string - the text value of the note that was written.\n * @example\n * &#96;&#96;&#96;ts\n * app.vault.process(file, (data) =&gt; {\n * return data.replace('Hello', 'World');\n * });\n * &#96;&#96;&#96;\n * @public\n * @since 1.1.0\n */\n process(file: TFile, fn: (data: string) =&gt; string, options?: DataWriteOptions): Promise;\n /**\n * Create a copy of a file or folder.\n * @param file - The file or folder.\n * @param newPath - Vault absolute path for the new copy.\n * @public\n * @since 1.8.7\n */\n copy (file: T, newPath: string): Promise;\n /**\n * Get all files and folders in the vault.\n * @public\n * @since 0.9.7\n */\n getAllLoadedFiles(): TAbstractFile[];\n /**\n * Get all folders in the vault.\n * @param includeRoot - Should the root folder (&#96;/&#96;) be returned\n * @public\n * @since 1.6.6\n */\n getAllFolders(includeRoot?: boolean): TFolder[];\n\n /**\n * @public\n * @since 0.9.7\n */\n static recurseChildren(root: TFolder, cb: (file: TAbstractFile) =&gt; any): void;\n /**\n * Get all Markdown files in the vault.\n * @public\n * @since 0.9.7\n */\n getMarkdownFiles(): TFile[];\n /**\n * Get all files in the vault.\n * @public\n * @since 0.9.7\n */\n getFiles(): TFile[];\n\n /**\n * Called when a file is created.\n * This is also called when the vault is first loaded for each existing file\n * If you do not wish to receive create events on vault load, register your event handler inside {@link Workspace.onLayoutReady}.\n * @public\n * @since 0.9.7\n */\n on(name: 'create', callback: (file: TAbstractFile) =&gt; any, ctx?: any): EventRef;\n /**\n * Called when a file is modified.\n * @public\n * @since 0.9.7\n */\n on(name: 'modify', callback: (file: TAbstractFile) =&gt; any, ctx?: any): EventRef;\n /**\n * Called when a file is deleted.\n * @public\n * @since 0.9.7\n */\n on(name: 'delete', callback: (file: TAbstractFile) =&gt; any, ctx?: any): EventRef;\n /**\n * Called when a file is renamed.\n * @public\n * @since 0.9.7\n */\n on(name: 'rename', callback: (file: TAbstractFile, oldPath: string) =&gt; any, ctx?: any): EventRef;\n\n}\n\n/**\n * @public\n * @since 0.9.7\n */\nexport abstract class View extends Component {\n /**\n * @public\n * @since 0.9.7\n */\n app: App;\n /**\n * @public\n * @since 1.1.0\n */\n icon: IconName;\n /**\n * Whether or not the view is intended for navigation.\n * If your view is a static view that is not intended to be navigated away, set this to false.\n * (For example: File explorer, calendar, etc.)\n * If your view opens a file or can be otherwise navigated, set this to true.\n * (For example: Markdown editor view, Kanban view, PDF view, etc.)\n *\n * @public\n * @since 0.15.1\n */\n navigation: boolean;\n /**\n * @public\n * @since 0.9.7\n */\n leaf: WorkspaceLeaf;\n /**\n * @public\n * @since 0.9.7\n */\n containerEl: HTMLElement;\n /**\n * Assign an optional scope to your view to register hotkeys for when the view\n * is in focus.\n *\n * @example\n * &#96;&#96;&#96;ts\n * this.scope = new Scope(this.app.scope);\n * &#96;&#96;&#96;\n * @default null\n * @public\n * @since 1.5.7\n */\n scope: Scope | null;\n /**\n * @public\n * @since 0.9.7\n */\n constructor(leaf: WorkspaceLeaf);\n\n /**\n * @public\n * @since 0.9.7\n */\n protected onOpen(): Promise;\n /**\n * @public\n * @since 0.9.7\n */\n protected onClose(): Promise;\n /**\n * @public\n * @since 0.9.7\n */\n abstract getViewType(): string;\n /**\n * @public\n * @since 0.9.7\n */\n getState(): Record;\n /**\n * @public\n * @since 0.9.7\n */\n setState(state: unknown, result: ViewStateResult): Promise;\n /**\n * @public\n * @since 0.9.7\n */\n getEphemeralState(): Record;\n /**\n * @public\n * @since 0.9.7\n */\n setEphemeralState(state: unknown): void;\n /**\n * @public\n * @since 1.1.0\n */\n getIcon(): IconName;\n /**\n * Called when the size of this view is changed.\n * @public\n * @since 0.9.7\n */\n onResize(): void;\n /**\n * @public\n * @since 0.9.7\n */\n abstract getDisplayText(): string;\n /**\n * Populates the pane menu.\n *\n * (Replaces the previously removed &#96;onHeaderMenu&#96; and &#96;onMoreOptionsMenu&#96;)\n * @public\n * @since 0.15.3\n */\n onPaneMenu(menu: Menu, source: 'more-options' | 'tab-header' | string): void;\n\n}\n\n/**\n * @public\n */\nexport type ViewCreator = (leaf: WorkspaceLeaf) =&gt; View;\n\n/**\n * ViewOption and the associated sub-types are configuration-driven settings controls\n * which can be provided by a {@link BasesViewRegistration} to expose configuration options\n * to users in the view config menu of the Bases toolbar.\n *\n * @public\n * @since 1.10.0\n */\nexport type ViewOption = DropdownOption | FileOption | FolderOption | FormulaOption | GroupOption | MultitextOption | PropertyOption | SliderOption | TextOption | ToggleOption;\n\n/**\n * @public\n */\nexport interface ViewState {\n\n /**\n * @public\n */\n type: string;\n /**\n * @public\n */\n state?: Record;\n /**\n * @public\n */\n active?: boolean;\n /**\n * @public\n */\n pinned?: boolean;\n /**\n * @public\n */\n group?: WorkspaceLeaf;\n\n}\n\n/**\n * @public\n */\nexport interface ViewStateResult {\n /**\n * Set this to true to indicate that there is a state change which should be recorded in the navigation history.\n * @public\n */\n history: boolean;\n\n}\n\n/**\n * @public\n * @since 0.9.7\n */\nexport class Workspace extends Events {\n\n /**\n * @public\n * @since 0.9.7\n */\n leftSplit: WorkspaceSidedock | WorkspaceMobileDrawer;\n /**\n * @public\n * @since 0.9.7\n */\n rightSplit: WorkspaceSidedock | WorkspaceMobileDrawer;\n /**\n * @public\n * @since 0.9.7\n */\n leftRibbon: WorkspaceRibbon;\n /**\n * @public\n * @deprecated No longer used\n */\n rightRibbon: WorkspaceRibbon;\n /**\n * @public\n * @since 0.9.7\n */\n rootSplit: WorkspaceRoot;\n\n /**\n * Indicates the currently focused leaf, if one exists.\n *\n * Please avoid using &#96;activeLeaf&#96; directly, especially without checking whether\n * &#96;activeLeaf&#96; is null.\n *\n * @public\n * @since 0.9.7\n * @deprecated The use of this field is discouraged.\n * The recommended alternatives are:\n * - If you need information about the current view, use {@link Workspace.getActiveViewOfType}.\n * - If you need to open a new file or navigate a view, use {@link Workspace.getLeaf}.\n */\n activeLeaf: WorkspaceLeaf | null;\n\n /**\n *\n * @public\n * @since 0.9.7\n */\n containerEl: HTMLElement;\n /**\n * If the layout of the app has been successfully initialized.\n * To react to the layout becoming ready, use {@link Workspace.onLayoutReady}\n * @public\n * @since 0.9.7\n */\n layoutReady: boolean;\n /**\n * Save the state of the current workspace layout.\n * @public\n * @since 0.16.0\n */\n requestSaveLayout: Debouncer&lt;[], Promise &gt;;\n\n /**\n * A component managing the current editor.\n * This can be null if the active view has no editor.\n * @public\n */\n activeEditor: MarkdownFileInfo | null;\n\n /**\n * Runs the callback function right away if layout is already ready,\n * or push it to a queue to be called later when layout is ready.\n * @public\n * @since 0.11.0\n */\n onLayoutReady(callback: () =&gt; any): void;\n /**\n * @public\n * @since 0.9.7\n */\n changeLayout(workspace: any): Promise;\n\n /**\n * @public\n * @since 0.9.7\n */\n getLayout(): Record;\n\n /**\n * @public\n * @since 0.9.11\n */\n createLeafInParent(parent: WorkspaceSplit, index: number): WorkspaceLeaf;\n\n /**\n * @public\n * @since 0.9.7\n */\n createLeafBySplit(leaf: WorkspaceLeaf, direction?: SplitDirection, before?: boolean): WorkspaceLeaf;\n /**\n * @public\n * @deprecated - You should use {@link Workspace.getLeaf|getLeaf(true)} instead which does the same thing.\n * @since 0.9.7\n */\n splitActiveLeaf(direction?: SplitDirection): WorkspaceLeaf;\n\n /**\n * @public\n * @deprecated - Use the new form of this method instead\n * @since 0.13.8\n */\n duplicateLeaf(leaf: WorkspaceLeaf, direction?: SplitDirection): Promise;\n /**\n * @public\n * @since 1.1.0\n */\n duplicateLeaf(leaf: WorkspaceLeaf, leafType: PaneType | boolean, direction?: SplitDirection): Promise;\n /**\n * @public\n * @deprecated - You should use {@link Workspace.getLeaf|getLeaf(false)} instead which does the same thing.\n */\n getUnpinnedLeaf(): WorkspaceLeaf;\n /**\n * Creates a new leaf in a leaf adjacent to the currently active leaf.\n * If direction is &#96;'vertical'&#96;, the leaf will appear to the right.\n * If direction is &#96;'horizontal'&#96;, the leaf will appear below the current leaf.\n *\n * @public\n * @since 0.16.0\n */\n getLeaf(newLeaf?: 'split', direction?: SplitDirection): WorkspaceLeaf;\n /**\n * If newLeaf is false (or not set) then an existing leaf which can be navigated\n * is returned, or a new leaf will be created if there was no leaf available.\n *\n * If newLeaf is &#96;'tab'&#96; or &#96;true&#96; then a new leaf will be created in the preferred\n * location within the root split and returned.\n *\n * If newLeaf is &#96;'split'&#96; then a new leaf will be created adjacent to the currently active leaf.\n *\n * If newLeaf is &#96;'window'&#96; then a popout window will be created with a new leaf inside.\n *\n * @public\n * @since 0.16.0\n */\n getLeaf(newLeaf?: PaneType | boolean): WorkspaceLeaf;\n\n /**\n * Migrates this leaf to a new popout window.\n * Only works on the desktop app.\n * @public\n * @throws Error if the app does not support popout windows (i.e. on mobile or if Electron version is too old)\n * @since 0.15.4\n */\n moveLeafToPopout(leaf: WorkspaceLeaf, data?: WorkspaceWindowInitData): WorkspaceWindow;\n\n /**\n * Open a new popout window with a single new leaf and return that leaf.\n * Only works on the desktop app.\n * @public\n * @since 0.15.4\n */\n openPopoutLeaf(data?: WorkspaceWindowInitData): WorkspaceLeaf;\n /**\n * @public\n * @since 0.16.0\n */\n openLinkText(linktext: string, sourcePath: string, newLeaf?: PaneType | boolean, openViewState?: OpenViewState): Promise;\n /**\n * Sets the active leaf\n * @param leaf - The new active leaf\n * @param params - Parameter object of whether to set the focus.\n * @public\n * @since 0.16.3\n */\n setActiveLeaf(leaf: WorkspaceLeaf, params?: {\n /** @public */\n focus?: boolean;\n }): void;\n /**\n * @deprecated - function signature changed. Use other form instead\n * @public\n */\n setActiveLeaf(leaf: WorkspaceLeaf, pushHistory: boolean, focus: boolean): void;\n\n /**\n * Retrieve a leaf by its id.\n * @param id id of the leaf to retrieve.\n * @public\n * @since 1.5.1\n */\n getLeafById(id: string): WorkspaceLeaf | null;\n /**\n * Get all leaves that belong to a group\n * @param group id\n * @public\n * @since 0.9.7\n */\n getGroupLeaves(group: string): WorkspaceLeaf[];\n\n /**\n * Get the most recently active leaf in a given workspace root. Useful for interacting with the leaf in the root split while a sidebar leaf might be active.\n * @param root Root for the leaves you want to search. If a root is not provided, the &#96;rootSplit&#96; and leaves within pop-outs will be searched.\n * @public\n * @since 0.15.4\n */\n getMostRecentLeaf(root?: WorkspaceParent): WorkspaceLeaf | null;\n /**\n * Create a new leaf inside the left sidebar.\n * @param split Should the existing split be split up?\n * @public\n * @since 0.9.7\n */\n getLeftLeaf(split: boolean): WorkspaceLeaf | null;\n /**\n * Create a new leaf inside the right sidebar.\n * @param split Should the existing split be split up?\n * @public\n * @since 0.9.7\n */\n getRightLeaf(split: boolean): WorkspaceLeaf | null;\n /**\n * Get side leaf or create one if one does not exist.\n * @public\n * @since 1.7.2\n */\n ensureSideLeaf(type: string, side: Side, options?: {\n /** @public */\n active?: boolean;\n /** @public */\n split?: boolean;\n /** @public */\n reveal?: boolean;\n /** @public */\n state?: any;\n }): Promise;\n\n /**\n * Get the currently active view of a given type.\n * @public\n * @since 0.9.16\n */\n getActiveViewOfType (type: Constructor): T | null;\n\n /**\n * Returns the file for the current view if it's a &#96;FileView&#96;.\n * Otherwise, it will return the most recently active file.\n * @public\n */\n getActiveFile(): TFile | null;\n\n /**\n * Iterate through all leaves in the main area of the workspace.\n * @public\n * @since 0.9.7\n */\n iterateRootLeaves(callback: (leaf: WorkspaceLeaf) =&gt; any): void;\n /**\n * Iterate through all leaves, including main area leaves, floating leaves, and sidebar leaves.\n * @public\n * @since 0.9.7\n */\n iterateAllLeaves(callback: (leaf: WorkspaceLeaf) =&gt; any): void;\n /**\n * Get all leaves of a given type.\n * @public\n * @since 0.9.7\n */\n getLeavesOfType(viewType: string): WorkspaceLeaf[];\n /**\n * Remove all leaves of the given type.\n * @public\n * @since 0.9.7\n */\n detachLeavesOfType(viewType: string): void;\n\n /**\n * Bring a given leaf to the foreground. If the leaf is in a sidebar, the sidebar will be uncollapsed.\n * &#96;await&#96; this function to ensure your view has been fully loaded and is not deferred.\n * @public\n * @since 1.7.2\n */\n revealLeaf(leaf: WorkspaceLeaf): Promise;\n /**\n * Get the filenames of the 10 most recently opened files.\n * @public\n * @since 0.9.7\n */\n getLastOpenFiles(): string[];\n\n /**\n * Calling this function will update/reconfigure the options of all Markdown views.\n * It is fairly expensive, so it should not be called frequently.\n * @public\n * @since 0.13.21\n */\n updateOptions(): void;\n\n /**\n * Add a context menu to internal file links.\n * @public\n * @since 0.12.10\n */\n handleLinkContextMenu(menu: Menu, linktext: string, sourcePath: string, leaf?: WorkspaceLeaf): boolean;\n\n /**\n * Triggered when the active Markdown file is modified. React to file changes before they\n * are saved to disk.\n * @public\n * @since 0.9.7\n */\n on(name: 'quick-preview', callback: (file: TFile, data: string) =&gt; any, ctx?: any): EventRef;\n /**\n * Triggered when a &#96;WorkspaceItem&#96; is resized or the workspace layout has changed.\n * @public\n * @since 0.9.7\n */\n on(name: 'resize', callback: () =&gt; any, ctx?: any): EventRef;\n\n /**\n * Triggered when the active leaf changes.\n * @public\n * @since 0.10.9\n */\n on(name: 'active-leaf-change', callback: (leaf: WorkspaceLeaf | null) =&gt; any, ctx?: any): EventRef;\n /**\n * Triggered when the active file changes. The file could be in a new leaf, an existing leaf,\n * or an embed.\n * @public\n * @since 0.10.9\n */\n on(name: 'file-open', callback: (file: TFile | null) =&gt; any, ctx?: any): EventRef;\n\n /**\n * @public\n * @since 0.9.20\n */\n on(name: 'layout-change', callback: () =&gt; any, ctx?: any): EventRef;\n /**\n * Triggered when a new popout window is created.\n * @public\n * @since 0.15.3\n */\n on(name: 'window-open', callback: (win: WorkspaceWindow, window: Window) =&gt; any, ctx?: any): EventRef;\n /**\n * Triggered when a popout window is closed.\n * @public\n * @since 0.15.3\n */\n on(name: 'window-close', callback: (win: WorkspaceWindow, window: Window) =&gt; any, ctx?: any): EventRef;\n /**\n * Triggered when the CSS of the app has changed.\n * @public\n * @since 0.9.7\n */\n on(name: 'css-change', callback: () =&gt; any, ctx?: any): EventRef;\n\n /**\n * Triggered when the user opens the context menu on a file.\n * @public\n * @since 0.9.12\n */\n on(name: 'file-menu', callback: (menu: Menu, file: TAbstractFile, source: string, leaf?: WorkspaceLeaf) =&gt; any, ctx?: any): EventRef;\n /**\n * Triggered when the user opens the context menu with multiple files selected in the File Explorer.\n * @public\n * @since 1.4.10\n */\n on(name: 'files-menu', callback: (menu: Menu, files: TAbstractFile[], source: string, leaf?: WorkspaceLeaf) =&gt; any, ctx?: any): EventRef;\n\n /**\n * Triggered when the user opens the context menu on an external URL.\n * @public\n * @since 1.5.1\n */\n on(name: 'url-menu', callback: (menu: Menu, url: string) =&gt; any, ctx?: any): EventRef;\n /**\n * Triggered when the user opens the context menu on an editor.\n * @public\n * @since 1.1.0\n */\n on(name: 'editor-menu', callback: (menu: Menu, editor: Editor, info: MarkdownView | MarkdownFileInfo) =&gt; any, ctx?: any): EventRef;\n /**\n * Triggered when changes to an editor has been applied, either programmatically or from a user event.\n * @public\n * @since 1.1.1\n */\n on(name: 'editor-change', callback: (editor: Editor, info: MarkdownView | MarkdownFileInfo) =&gt; any, ctx?: any): EventRef;\n\n /**\n * Triggered when the editor receives a paste event.\n * Check for &#96;evt.defaultPrevented&#96; before attempting to handle this event, and return if it has been already handled.\n * Use &#96;evt.preventDefault()&#96; to indicate that you've handled the event.\n * @public\n * @since 1.1.0\n */\n on(name: 'editor-paste', callback: (evt: ClipboardEvent, editor: Editor, info: MarkdownView | MarkdownFileInfo) =&gt; any, ctx?: any): EventRef;\n /**\n * Triggered when the editor receives a drop event.\n * Check for &#96;evt.defaultPrevented&#96; before attempting to handle this event, and return if it has been already handled.\n * Use &#96;evt.preventDefault()&#96; to indicate that you've handled the event.\n * @public\n * @since 1.1.0\n */\n on(name: 'editor-drop', callback: (evt: DragEvent, editor: Editor, info: MarkdownView | MarkdownFileInfo) =&gt; any, ctx?: any): EventRef;\n\n /**\n * Triggered when the app is about to quit.\n * Not guaranteed to actually run.\n * Perform some best effort cleanup here.\n * @public\n * @since 0.10.2\n */\n on(name: 'quit', callback: (tasks: Tasks) =&gt; any, ctx?: any): EventRef;\n\n}\n\n/**\n * @public\n * @since 0.15.4\n */\nexport abstract class WorkspaceContainer extends WorkspaceSplit {\n\n /**\n * @public\n * @since 0.15.4\n */\n abstract win: Window;\n /**\n * @public\n * @since 0.15.4\n */\n abstract doc: Document;\n\n}\n\n/**\n * @public\n * @since 0.15.2\n */\nexport class WorkspaceFloating extends WorkspaceParent {\n /**\n * @public\n * @since 0.15.2\n */\n parent: WorkspaceParent;\n\n}\n\n/**\n * @public\n * @since 0.10.2\n */\nexport abstract class WorkspaceItem extends Events {\n\n /**\n * The direct parent of the leaf.\n * @public\n * @since 1.6.6\n */\n abstract parent: WorkspaceParent;\n\n /**\n * @public\n * @since 0.10.2\n */\n getRoot(): WorkspaceItem;\n /**\n * Get the root container parent item, which can be one of:\n * - {@link WorkspaceRoot}\n * - {@link WorkspaceWindow}\n * @public\n * @since 0.15.4\n */\n getContainer(): WorkspaceContainer;\n\n}\n\n/**\n * @public\n */\nexport class WorkspaceLeaf extends WorkspaceItem implements HoverParent {\n\n /**\n * The direct parent of the leaf.\n *\n * On desktop, a leaf is always a child of a &#96;WorkspaceTabs&#96; component.\n * On mobile, a leaf might be a child of a &#96;WorkspaceMobileDrawer&#96;.\n * Perform an &#96;instanceof&#96; check before making an assumption about the\n * &#96;parent&#96;.\n *\n * @public\n */\n parent: WorkspaceTabs | WorkspaceMobileDrawer;\n\n /**\n * The view associated with this leaf. Do not attempt to cast this to your\n * custom &#96;View&#96; without first checking &#96;instanceof&#96;.\n * @public\n */\n view: View;\n\n /** @public */\n hoverPopover: HoverPopover | null;\n\n /**\n * Open a file in this leaf.\n *\n * @public\n */\n openFile(file: TFile, openState?: OpenViewState): Promise;\n\n /**\n * @public\n */\n open(view: View): Promise;\n\n /**\n * @public\n */\n getViewState(): ViewState;\n /**\n * @public\n */\n setViewState(viewState: ViewState, eState?: any): Promise;\n /**\n * Returns true if this leaf is currently deferred because it is in the background.\n * A deferred leaf will have a DeferredView as its view, instead of the View that\n * it should normally have for its type (like MarkdownView for the &#96;markdown&#96; type).\n * @since 1.7.2\n * @public\n */\n get isDeferred(): boolean;\n /**\n * If this view is currently deferred, load it and await that it has fully loaded.\n * @since 1.7.2\n * @public\n */\n loadIfDeferred(): Promise;\n\n /**\n * @public\n */\n getEphemeralState(): any;\n /**\n * @public\n */\n setEphemeralState(state: any): void;\n /**\n * @public\n */\n togglePinned(): void;\n /**\n * @public\n */\n setPinned(pinned: boolean): void;\n\n /**\n * @public\n */\n setGroupMember(other: WorkspaceLeaf): void;\n /**\n * @public\n */\n setGroup(group: string): void;\n /**\n * @public\n */\n detach(): void;\n\n /**\n * @public\n */\n getIcon(): IconName;\n /**\n * @public\n */\n getDisplayText(): string;\n\n /**\n * @public\n */\n onResize(): void;\n\n /**\n * @public\n */\n on(name: 'pinned-change', callback: (pinned: boolean) =&gt; any, ctx?: any): EventRef;\n /**\n * @public\n */\n on(name: 'group-change', callback: (group: string) =&gt; any, ctx?: any): EventRef;\n\n}\n\n/**\n * @public\n * @since 1.6.6\n */\nexport class WorkspaceMobileDrawer extends WorkspaceParent {\n\n /** @public */\n parent: WorkspaceParent;\n\n /** @public */\n collapsed: boolean;\n\n /** @public */\n expand(): void;\n\n /** @public */\n collapse(): void;\n\n /** @public */\n toggle(): void;\n\n}\n\n/**\n * @public\n * @since 0.9.7\n */\nexport abstract class WorkspaceParent extends WorkspaceItem {\n\n}\n\n/**\n * @public\n */\nexport class WorkspaceRibbon {\n\n}\n\n/**\n * @public\n * @since 0.15.2\n */\nexport class WorkspaceRoot extends WorkspaceContainer {\n /** @public */\n win: Window;\n /** @public */\n doc: Document;\n\n}\n\n/**\n * @public\n * @since 0.15.4\n */\nexport class WorkspaceSidedock extends WorkspaceSplit {\n\n /**\n * @public\n * @since 0.12.11\n */\n collapsed: boolean;\n\n /**\n * @public\n * @since 0.12.11\n */\n toggle(): void;\n /**\n * @public\n * @since 0.12.11\n */\n collapse(): void;\n /**\n * @public\n * @since 0.12.11\n */\n expand(): void;\n\n}\n\n/**\n * @public\n * @since 0.9.7\n */\nexport class WorkspaceSplit extends WorkspaceParent {\n /** @public */\n parent: WorkspaceParent;\n\n}\n\n/**\n * @public\n */\nexport class WorkspaceTabs extends WorkspaceParent {\n\n /** @public */\n parent: WorkspaceSplit;\n\n}\n\n/**\n * @public\n * @since 0.15.4\n */\nexport class WorkspaceWindow extends WorkspaceContainer {\n\n /** @public */\n win: Window;\n /** @public */\n doc: Document;\n\n}\n\n/**\n * @public\n */\nexport interface WorkspaceWindowInitData {\n /** @public */\n x?: number;\n /** @public */\n y?: number;\n\n /**\n * The suggested size\n * @public\n */\n size?: {\n /** @public */\n width: number;\n /** @public */\n height: number;\n };\n}\n\nexport { }\n\n/**\n * Can be any Lucide icon name or an internal icon name.\n * @public\n */\nexport type IconName = string;\n"
}
```
User decision: **accepted**

Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="ripgrep_raw_search">
<details>
<summary>Tool use: **ripgrep_raw_search**</summary>


Parameters:

```json
{
  "pattern": "canvas|node-menu|context",
  "path": "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/node_modules/obsidian",
  "caseInsensitive": false
}
```
Result:

```json
{
  "success": {
    "pattern": "canvas|node-menu|context",
    "path": "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/node_modules/obsidian",
    "outputMode": "content",
    "workspaceResults": {
      "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board": {
        "content": {
          "matches": [
            {
              "file": "node_modules/obsidian/publish.d.ts",
              "matches": [
                {
                  "lineNumber": 7,
                  "content": "        }, callback: (value: T, key?: string) =&gt; boolean | void, context?: any): boolean;"
                }
              ]
            },
            {
              "file": "node_modules/obsidian/obsidian.d.ts",
              "matches": [
                {
                  "lineNumber": 15,
                  "content": "        }, callback: (value: T, key?: string) =&gt; boolean | void, context?: any): boolean;"
                },
                {
                  "lineNumber": 904,
                  "content": "     * formula in the context of the current Base. For embedded bases, or bases"
                },
                {
                  "lineNumber": 2240,
                  "content": "     * Current suggestion context, containing the result of &#96;onTrigger&#96;."
                },
                {
                  "lineNumber": 2245,
                  "content": "    context: EditorSuggestContext | null;"
                },
                {
                  "lineNumber": 2274,
                  "content": "     * Generate suggestion items based on this context. Can be async, but preferably sync."
                },
                {
                  "lineNumber": 2275,
                  "content": "     * When generating async suggestions, you should pass the context along."
                },
                {
                  "lineNumber": 2279,
                  "content": "    abstract getSuggestions(context: EditorSuggestContext): T[] | Promise&lt;T[]&gt;;"
                },
                {
                  "lineNumber": 2827,
                  "content": " * The context in which a formula is evaluated. In most cases, {@link BasesEntry} is the specific type to use."
                },
                {
                  "lineNumber": 6857,
                  "content": "     * Add a context menu to internal file links."
                },
                {
                  "lineNumber": 6916,
                  "content": "     * Triggered when the user opens the context menu on a file."
                },
                {
                  "lineNumber": 6922,
                  "content": "     * Triggered when the user opens the context menu with multiple files selected in the File Explorer."
                },
                {
                  "lineNumber": 6929,
                  "content": "     * Triggered when the user opens the context menu on an external URL."
                },
                {
                  "lineNumber": 6935,
                  "content": "     * Triggered when the user opens the context menu on an editor."
                }
              ]
            },
            {
              "file": "node_modules/obsidian/canvas.d.ts",
              "matches": [
                {
                  "lineNumber": 9,
                  "content": "/** The overall canvas file's JSON */"
                }
              ]
            },
            {
              "file": "node_modules/obsidian/CHANGELOG.md",
              "matches": [
                {
                  "lineNumber": 3,
                  "content": "This CHANGELOG details any breaking changes to the API or new additions that require additional context. The versions listed below correspond to the versions of the Obsidian app. There may not be a corresponding package version for the version listed below."
                },
                {
                  "lineNumber": 89,
                  "content": "- Updated the [Canvas spec](https://github.com/obsidianmd/obsidian-api/blob/master/canvas.d.ts) to indicate that colors can be stored in 1 or 2 formats:"
                },
                {
                  "lineNumber": 98,
                  "content": "There are some new CSS variables related to canvas and callouts in 1.1.3+. All the extended palette colors now have an RGB variant that is used for callouts and canvas colors. The hex values are primarily used for syntax highlighting."
                },
                {
                  "lineNumber": 175,
                  "content": "- Exposed the &#96;activeEditor&#96; on the Workspace. When a markdown view is active, this will point to the underlying &#96;MarkdownEditView&#96;. If a canvas view is active, this will be an EmbeddedEditor component."
                },
                {
                  "lineNumber": 179,
                  "content": "on file cards in the canvas. If a plugin is currently accessing the &#96;Editor&#96; using the following"
                }
              ]
            }
          ],
          "totalLines": 20,
          "totalMatchedLines": 20
        }
      }
    }
  }
}
```
Status: **completed**


</details>
</tool-use>

---





---

<tool-use data-tool-type="unknown" data-tool-name="ripgrep_raw_search">
<details>
<summary>Tool use: **ripgrep_raw_search**</summary>


Parameters:

```json
{
  "pattern": "canvas|node-menu|node menu",
  "path": "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/node_modules/obsidian/CHANGELOG.md",
  "contextBefore": 0,
  "contextAfter": 2,
  "caseInsensitive": false
}
```
Result:

```json
{
  "success": {
    "pattern": "canvas|node-menu|node menu",
    "path": "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/node_modules/obsidian/CHANGELOG.md",
    "outputMode": "content",
    "workspaceResults": {
      "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board": {
        "content": {
          "matches": [
            {
              "file": "node_modules/obsidian/CHANGELOG.md",
              "matches": [
                {
                  "lineNumber": 89,
                  "content": "- Updated the [Canvas spec](https://github.com/obsidianmd/obsidian-api/blob/master/canvas.d.ts) to indicate that colors can be stored in 1 or 2 formats:"
                },
                {
                  "lineNumber": 90,
                  "content": "  - as a hex string (i.e. \"#FFFFFF\")",
                  "isContextLine": true
                },
                {
                  "lineNumber": 91,
                  "content": "  - as a number \"1\", \"2\", etc.",
                  "isContextLine": true
                },
                {
                  "lineNumber": 98,
                  "content": "There are some new CSS variables related to canvas and callouts in 1.1.3+. All the extended palette colors now have an RGB variant that is used for callouts and canvas colors. The hex values are primarily used for syntax highlighting."
                },
                {
                  "lineNumber": 99,
                  "isContextLine": true
                },
                {
                  "lineNumber": 100,
                  "content": "&#96;&#96;&#96;css",
                  "isContextLine": true
                },
                {
                  "lineNumber": 175,
                  "content": "- Exposed the &#96;activeEditor&#96; on the Workspace. When a markdown view is active, this will point to the underlying &#96;MarkdownEditView&#96;. If a canvas view is active, this will be an EmbeddedEditor component."
                },
                {
                  "lineNumber": 176,
                  "isContextLine": true
                },
                {
                  "lineNumber": 177,
                  "content": "With these two changes, plugins should be able to adapt to the new Canvas view quite easily. Custom",
                  "isContextLine": true
                },
                {
                  "lineNumber": 179,
                  "content": "on file cards in the canvas. If a plugin is currently accessing the &#96;Editor&#96; using the following"
                },
                {
                  "lineNumber": 180,
                  "content": "approach:",
                  "isContextLine": true
                },
                {
                  "lineNumber": 181,
                  "isContextLine": true
                }
              ]
            }
          ],
          "totalLines": 12,
          "totalMatchedLines": 4
        }
      }
    }
  }
}
```
Status: **completed**


</details>
</tool-use>

---


Registering the handler for both "canvas:node-menu" and "canvas-node-menu" in case Obsidian uses a different event name.


---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** • Edit file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/main.ts</summary>

</details>

</tool-use>

---





---

<tool-use data-tool-type="unknown" data-tool-name="read_lints">
<details>
<summary>Tool use: **read_lints**</summary>


Parameters:

```json
{
  "paths": [
    "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/main.ts"
  ]
}
```
Result:

```json
{
  "linterErrorsByFile": [
    {
      "relativeWorkspacePath": "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/main.ts"
    }
  ]
}
```
Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="shell" data-tool-name="run_terminal_command_v2">
<details><summary>Tool use: **run_terminal_command_v2** • Run command: cd /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board && npm run build</summary>

```bash
cd /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board && npm run build
```

```

&gt; zettel-thinking-board@1.0.0 build
&gt; tsc -noEmit -skipLibCheck &amp;&amp; node esbuild.config.mjs production

src/canvas/types.test.ts(86,10): error TS2532: Object is possibly 'undefined'.
src/canvas/types.test.ts(87,10): error TS2532: Object is possibly 'undefined'.
src/canvas/types.test.ts(88,10): error TS2532: Object is possibly 'undefined'.
src/canvas/types.test.ts(89,10): error TS2532: Object is possibly 'undefined'.

```
</details>
</tool-use>

---


Build failed due to existing errors in `src/canvas/types.test.ts`, not from our changes. Verifying `main.ts` compiles:


---

<tool-use data-tool-type="shell" data-tool-name="run_terminal_command_v2">
<details><summary>Tool use: **run_terminal_command_v2** • Run command: cd /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board && npx tsc -noEmit -skipLibCheck 2>&1 | head -20</summary>

```bash
cd /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board && npx tsc -noEmit -skipLibCheck 2>&1 | head -20
```

```
src/canvas/types.test.ts(86,10): error TS2532: Object is possibly 'undefined'.
src/canvas/types.test.ts(87,10): error TS2532: Object is possibly 'undefined'.
src/canvas/types.test.ts(88,10): error TS2532: Object is possibly 'undefined'.
src/canvas/types.test.ts(89,10): error TS2532: Object is possibly 'undefined'.

```
</details>
</tool-use>

---


Summary of what’s in place and how to use it:

---

## 1. **Debug command**

There is a new command: **“Debug canvas hook”**.

- **How to run:** Command Palette → “Debug canvas hook” (or “Zettel … Debug canvas hook”).
- **What it does:** Shows a Notice with:
  - **Canvas active: yes / no** – “yes” only when the current tab is a canvas (so the plugin can see the canvas).
  - **Node menu ever fired: yes / no** – “yes” only if the canvas node context-menu callback has run at least once (i.e. Obsidian fired the event we listen to).

**How to test:**

1. Reload the plugin (or restart Obsidian).
2. Open your test canvas (blue + orange notes).
3. Run **“Debug canvas hook”** → you should see **“Canvas active: yes”**.
4. Right‑click the orange (or blue) node.
5. Run **“Debug canvas hook”** again.

Interpretation:

- **“Node menu ever fired: no”** after right‑clicking → the event we use (`canvas:node-menu` / `canvas-node-menu`) is either not fired by your Obsidian version or has another name. Then we need to find the correct event (e.g. from Obsidian source or other plugins).
- **“Node menu ever fired: yes”** but no “Run node” / “Run chain” in the menu → the event fires but `resolveCanvasNodeId(node)` is returning nothing, so we need to fix how we get the node id from the object Obsidian passes.

So this command is the way to **check whether we can affect the canvas at all** (canvas detection) and whether the **node context menu event** ever runs.

---

## 2. **Code changes**

- **`debugNodeMenuFired`** – Set to `true` inside the canvas node menu callback so “Debug canvas hook” can report whether that callback ever ran.
- **Shared handler** – One function adds “Run node”, “Run chain”, “Dismiss output”; it’s registered for both **`canvas:node-menu`** and **`canvas-node-menu`** so we don’t miss the event if Obsidian uses a different name.
- **“Debug canvas hook” command** – Uses `getActiveCanvasView()` for “Canvas active” and `debugNodeMenuFired` for “Node menu ever fired”.

No other behavior is changed. After you run the steps above and see the two lines in the Notice, we can decide the next step (e.g. try another event name or fix `resolveCanvasNodeId`).

---

**Note:** The full `npm run build` still fails because of existing TypeScript errors in `src/canvas/types.test.ts`. Those are unrelated to this debug work. If you build while excluding that test file (e.g. temporarily moving or excluding it), or fix those four “Object is possibly 'undefined'” issues, the rest of the project, including `main.ts`, type-checks.

---

_**User**_

I am able to run the script so that it can give me the output from a chain. However, it is not giving me the output of the Python code notes under the node. It should give me the output of each note under that note and it should change this note every time it is run. So I want an edge running from the note that is run to the output note in green, and these will be ignored when I am doing run nodes (replace it with new output), and run chain (because these are not children), you can mark this edge with 'output' which is not considered a variableName.

---

_**Agent (model default, mode Agent)**_


Reviewing how output nodes and edges are created and how run-node/run-chain traverse the graph.


---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/engine/runner.ts</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/canvas/types.ts</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/engine/state.ts</summary>

</details>
</tool-use>

---


Checking how nodes and edges are created and how we find/update the green output node:


---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/canvas/nodes.ts</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/engine/canvasApi.ts</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="ripgrep_raw_search">
<details>
<summary>Tool use: **ripgrep_raw_search**</summary>


Parameters:

```json
{
  "pattern": "edge|Edge|addEdge|createEdge",
  "path": "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board",
  "caseInsensitive": false
}
```
Result:

```json
{
  "success": {
    "pattern": "edge|Edge|addEdge|createEdge",
    "path": "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board",
    "outputMode": "content",
    "workspaceResults": {
      "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board": {
        "content": {
          "matches": [
            {
              "file": "./src/canvas/types.test.ts",
              "matches": [
                {
                  "lineNumber": 7,
                  "content": "\tgetIncomingEdgesWithLabels,"
                },
                {
                  "lineNumber": 9,
                  "content": "\tparseEdgeVariableName,"
                },
                {
                  "lineNumber": 52,
                  "content": "describe(\"parseEdgeVariableName\", () =&gt; {"
                },
                {
                  "lineNumber": 54,
                  "content": "\t\texpect(parseEdgeVariableName(undefined)).toBe(\"\");"
                },
                {
                  "lineNumber": 55,
                  "content": "\t\texpect(parseEdgeVariableName(\"\")).toBe(\"\");"
                },
                {
                  "lineNumber": 58,
                  "content": "\t\texpect(parseEdgeVariableName(\"summary\")).toBe(\"summary\");"
                },
                {
                  "lineNumber": 59,
                  "content": "\t\texpect(parseEdgeVariableName(\"  out1  \")).toBe(\"out1\");"
                },
                {
                  "lineNumber": 62,
                  "content": "\t\texpect(parseEdgeVariableName(\"summary\" + EDGE_LABEL_INJECTED)).toBe(\"summary\");"
                },
                {
                  "lineNumber": 63,
                  "content": "\t\texpect(parseEdgeVariableName(\"out1\" + EDGE_LABEL_CONCATENATED)).toBe(\"out1\");"
                },
                {
                  "lineNumber": 66,
                  "content": "\t\texpect(parseEdgeVariableName(\"foo (bar)\")).toBe(\"foo\");"
                },
                {
                  "lineNumber": 67,
                  "content": "\t\texpect(parseEdgeVariableName(\"draft (WIP)\")).toBe(\"draft\");"
                },
                {
                  "lineNumber": 71,
                  "content": "describe(\"getIncomingEdgesWithLabels\", () =&gt; {"
                },
                {
                  "lineNumber": 72,
                  "content": "\tit(\"returns incoming edges with variable names sorted by parent y\", () =&gt; {"
                },
                {
                  "lineNumber": 79,
                  "content": "\t\t\tedges: ["
                },
                {
                  "lineNumber": 84,
                  "content": "\t\tconst result = getIncomingEdgesWithLabels(\"a\", data);"
                },
                {
                  "lineNumber": 91,
                  "content": "\tit(\"returns empty array when node has no incoming edges\", () =&gt; {"
                },
                {
                  "lineNumber": 94,
                  "content": "\t\t\tedges: [],"
                },
                {
                  "lineNumber": 96,
                  "content": "\t\texpect(getIncomingEdgesWithLabels(\"a\", data)).toEqual([]);"
                },
                {
                  "lineNumber": 108,
                  "content": "\t\t\tedges: ["
                },
                {
                  "lineNumber": 118,
                  "content": "\t\t\tedges: [],"
                },
                {
                  "lineNumber": 128,
                  "content": "\t\t\tedges: [],"
                },
                {
                  "lineNumber": 133,
                  "content": "\t\tconst data: CanvasData = { nodes: [], edges: [] };"
                },
                {
                  "lineNumber": 142,
                  "content": "\t\tconst data: CanvasData = { nodes: [], edges: [] };"
                },
                {
                  "lineNumber": 153,
                  "content": "\t\t\tedges: [],"
                },
                {
                  "lineNumber": 160,
                  "content": "\t\t\tedges: [],"
                }
              ]
            },
            {
              "file": "./src/canvas/types.ts",
              "matches": [
                {
                  "lineNumber": 4,
                  "content": "\tCanvasEdgeData,"
                },
                {
                  "lineNumber": 11,
                  "content": "export type {AllCanvasNodeData, CanvasData, CanvasEdgeData, CanvasFileData, CanvasNodeData, CanvasTextData};"
                },
                {
                  "lineNumber": 34,
                  "content": "/** Suffixes we add to edge labels after run to show inject vs concatenate. */"
                },
                {
                  "lineNumber": 38,
                  "content": "/** Parse variable name from edge label; ignore anything in brackets at the end. */"
                },
                {
                  "lineNumber": 39,
                  "content": "export function parseEdgeVariableName(label: string | undefined): string {"
                },
                {
                  "lineNumber": 45,
                  "content": "/** Incoming edge with parent id and optional variable name (from label). */"
                },
                {
                  "lineNumber": 46,
                  "content": "export interface IncomingEdgeInfo {"
                },
                {
                  "lineNumber": 48,
                  "content": "\tedge: CanvasEdgeData;"
                },
                {
                  "lineNumber": 52,
                  "content": "/** Get incoming edges for a node with parent id and variable name, sorted by parent y. */"
                },
                {
                  "lineNumber": 53,
                  "content": "export function getIncomingEdgesWithLabels(nodeId: string, data: CanvasData): IncomingEdgeInfo[] {"
                },
                {
                  "lineNumber": 54,
                  "content": "\tconst edges = data.edges.filter((e) =&gt; e.toNode === nodeId);"
                },
                {
                  "lineNumber": 56,
                  "content": "\tconst withY = edges.map((e) =&gt; {"
                },
                {
                  "lineNumber": 61,
                  "content": "\t\t\tedge: e,"
                },
                {
                  "lineNumber": 62,
                  "content": "\t\t\tvariableName: parseEdgeVariableName(e.label),"
                },
                {
                  "lineNumber": 67,
                  "content": "\treturn withY.map(({ parentId, edge, variableName }) =&gt; ({ parentId, edge, variableName }));"
                },
                {
                  "lineNumber": 72,
                  "content": "\tconst edges = data.edges.filter((e) =&gt; e.toNode === nodeId);"
                },
                {
                  "lineNumber": 73,
                  "content": "\tconst fromIds = [...new Set(edges.map((e) =&gt; e.fromNode))];"
                }
              ]
            },
            {
              "file": "./PRD.md",
              "matches": [
                {
                  "lineNumber": 33,
                  "content": "### 3.2. Edge Variable Injection (Optional)"
                },
                {
                  "lineNumber": 35,
                  "content": "*   **Variable name on edge:** The user may put a **variable name** on an edge (the edge's label in the canvas). This names the parent's output for the target node."
                },
                {
                  "lineNumber": 37,
                  "content": "*   **Inject vs concatenate:** If the target note uses &#96;{{var:variableName}}&#96; for a given edge's variable, that parent's output is **injected** at that placeholder and **not** concatenated. If the variable is not used (or the edge has no label), the parent's output is **concatenated** as before."
                },
                {
                  "lineNumber": 38,
                  "content": "*   **Edge label after run:** When a node is run, incoming edges that have a variable name are updated to show how they were used: the label becomes &#96;variableName (injected)&#96; or &#96;variableName (concatenated)&#96;, so the user can see at a glance which edges were variable-injected vs concatenated."
                }
              ]
            },
            {
              "file": "./README.md",
              "matches": [
                {
                  "lineNumber": 24,
                  "content": "*   **Edge variable injection:** Put a **variable name** on an edge (edit the edge label). In the target note, use &#96;{{var:variableName}}&#96; to inject that parent's output at that spot instead of concatenating it. Edges update after run to show \"(injected)\" or \"(concatenated)\"."
                },
                {
                  "lineNumber": 62,
                  "content": "## 🔗 Edge variable injection"
                },
                {
                  "lineNumber": 66,
                  "content": "1. **Name the edge:** Select the edge (line) from parent to child and set its **label** to a variable name (e.g. &#96;summary&#96;)."
                },
                {
                  "lineNumber": 69,
                  "content": "4. **Edge labels after run:** The edge label is updated to &#96;summary (injected)&#96; or &#96;summary (concatenated)&#96; so you can see how each edge was used."
                },
                {
                  "lineNumber": 71,
                  "content": "Example: Orange → Purple with edge label &#96;draft&#96;. In the Purple note: \"Critique this draft:\\n\\n{{var:draft}}\\n\\nBe concise.\" Only the draft is injected; no extra concatenation."
                }
              ]
            },
            {
              "file": "./src/engine/runner.ts",
              "matches": [
                {
                  "lineNumber": 7,
                  "content": "\tgetIncomingEdgesWithLabels,"
                },
                {
                  "lineNumber": 13,
                  "content": "import type {AllCanvasNodeData, CanvasData, CanvasEdgeData} from \"../canvas/types\";"
                },
                {
                  "lineNumber": 17,
                  "content": "\tparseEdgeVariableName,"
                },
                {
                  "lineNumber": 29,
                  "content": "type EdgeInputMode = \"inject\" | \"concatenate\";"
                },
                {
                  "lineNumber": 31,
                  "content": "/** Get all root node ids (no incoming edges). */"
                },
                {
                  "lineNumber": 33,
                  "content": "\tconst hasIncoming = new Set(data.edges.map((e) =&gt; e.toNode));"
                },
                {
                  "lineNumber": 46,
                  "content": "\t\tfor (const e of data.edges) {"
                },
                {
                  "lineNumber": 61,
                  "content": "\t\tfor (const e of data.edges) {"
                },
                {
                  "lineNumber": 67,
                  "content": "\tfor (const e of data.edges) {"
                },
                {
                  "lineNumber": 81,
                  "content": "\t\tfor (const e of data.edges) {"
                },
                {
                  "lineNumber": 92,
                  "content": "/** Build concatenated context, template with {{var:name}} substituted, and per-edge mode. */"
                },
                {
                  "lineNumber": 96,
                  "content": "\tincoming: { parentId: string; edge: CanvasEdgeData; variableName: string }[]"
                },
                {
                  "lineNumber": 97,
                  "content": "): { concatenatedPart: string; template: string; edgeModes: Map&lt;string, EdgeInputMode&gt; } {"
                },
                {
                  "lineNumber": 98,
                  "content": "\tconst edgeModes = new Map&lt;string, EdgeInputMode&gt;();"
                },
                {
                  "lineNumber": 106,
                  "content": "\tfor (const { parentId, edge, variableName } of incoming) {"
                },
                {
                  "lineNumber": 112,
                  "content": "\t\t\tedgeModes.set(edge.id, \"inject\");"
                },
                {
                  "lineNumber": 115,
                  "content": "\t\t\tedgeModes.set(edge.id, \"concatenate\");"
                },
                {
                  "lineNumber": 126,
                  "content": "\t\tedgeModes,"
                },
                {
                  "lineNumber": 130,
                  "content": "/** Update edge labels to show inject vs concatenate, then refresh view (if setData) and save canvas. */"
                },
                {
                  "lineNumber": 131,
                  "content": "async function updateEdgeLabelsAndSave("
                },
                {
                  "lineNumber": 136,
                  "content": "\tedgeModes: Map&lt;string, EdgeInputMode&gt;,"
                },
                {
                  "lineNumber": 140,
                  "content": "\tfor (const edge of data.edges) {"
                },
                {
                  "lineNumber": 141,
                  "content": "\t\tif (edge.toNode !== nodeId) continue;"
                },
                {
                  "lineNumber": 142,
                  "content": "\t\tconst mode = edgeModes.get(edge.id);"
                },
                {
                  "lineNumber": 144,
                  "content": "\t\tconst baseName = parseEdgeVariableName(edge.label);"
                },
                {
                  "lineNumber": 148,
                  "content": "\t\tif (edge.label !== newLabel) {"
                },
                {
                  "lineNumber": 149,
                  "content": "\t\t\tedge.label = newLabel;"
                },
                {
                  "lineNumber": 180,
                  "content": "\tconst incoming = getIncomingEdgesWithLabels(nodeId, data);"
                },
                {
                  "lineNumber": 182,
                  "content": "\tconst { concatenatedPart, template, edgeModes } = buildInputWithVariables("
                },
                {
                  "lineNumber": 195,
                  "content": "\t\tawait updateEdgeLabelsAndSave(app.vault, canvasFilePath, data, nodeId, edgeModes, liveCanvas);"
                },
                {
                  "lineNumber": 203,
                  "content": "\t\tawait updateEdgeLabelsAndSave(app.vault, canvasFilePath, data, nodeId, edgeModes, liveCanvas);"
                },
                {
                  "lineNumber": 211,
                  "content": "\t\tawait updateEdgeLabelsAndSave(app.vault, canvasFilePath, data, nodeId, edgeModes, liveCanvas);"
                }
              ]
            },
            {
              "file": "./src/engine/canvasApi.ts",
              "matches": [
                {
                  "lineNumber": 14,
                  "content": "\t/** If present, used to refresh canvas after edge label updates (Obsidian canvas view). */"
                }
              ]
            },
            {
              "file": "./src/canvas/nodes.ts",
              "matches": [
                {
                  "lineNumber": 19,
                  "content": "\t\tif (data &amp;&amp; Array.isArray(data.nodes) &amp;&amp; Array.isArray(data.edges)) return data;"
                },
                {
                  "lineNumber": 65,
                  "content": "\tgetIncomingEdgesWithLabels,"
                },
                {
                  "lineNumber": 69,
                  "content": "\tparseEdgeVariableName,"
                },
                {
                  "lineNumber": 71,
                  "content": "export type {CanvasData, AllCanvasNodeData, IncomingEdgeInfo} from \"./types\";"
                }
              ]
            },
            {
              "file": "./package-lock.json",
              "matches": [
                {
                  "lineNumber": 6545,
                  "content": "\t\t\t\t\"@edge-runtime/vm\": \"*\","
                },
                {
                  "lineNumber": 6553,
                  "content": "\t\t\t\t\"@edge-runtime/vm\": {"
                }
              ]
            },
            {
              "file": "./src/__mocks__/obsidian-canvas.ts",
              "matches": [
                {
                  "lineNumber": 7,
                  "content": "export const CanvasEdgeData = {};"
                }
              ]
            },
            {
              "file": "./LICENSE",
              "matches": [
                {
                  "lineNumber": 161,
                  "content": "content, constitutes a covered work.  This License acknowledges your"
                },
                {
                  "lineNumber": 508,
                  "content": "actual knowledge that, but for the patent license, your conveying the"
                }
              ]
            }
          ],
          "totalLines": 93,
          "totalMatchedLines": 93
        }
      }
    }
  }
}
```
Status: **completed**


</details>
</tool-use>

---


Checking Obsidian canvas edge structure and whether the live canvas API exposes edge creation:


---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/node_modules/obsidian/canvas.d.ts</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="ripgrep_raw_search">
<details>
<summary>Tool use: **ripgrep_raw_search**</summary>


Parameters:

```json
{
  "pattern": "createTextNode|addNode|edges|setData",
  "path": "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src",
  "caseInsensitive": false
}
```
Result:

```json
{
  "success": {
    "pattern": "createTextNode|addNode|edges|setData",
    "path": "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src",
    "outputMode": "content",
    "workspaceResults": {
      "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board": {
        "content": {
          "matches": [
            {
              "file": "src/main.ts",
              "matches": [
                {
                  "lineNumber": 80,
                  "content": "\t\t\tconst addNodeMenuItems = (menu: Menu, node: unknown): void =&gt; {"
                },
                {
                  "lineNumber": 101,
                  "content": "\t\t\t\t\tthis.registerEvent(on(\"canvas:node-menu\", addNodeMenuItems));"
                },
                {
                  "lineNumber": 103,
                  "content": "\t\t\t\t\tthis.registerEvent(on(\"canvas-node-menu\", addNodeMenuItems));"
                }
              ]
            },
            {
              "file": "src/canvas/types.test.ts",
              "matches": [
                {
                  "lineNumber": 72,
                  "content": "\tit(\"returns incoming edges with variable names sorted by parent y\", () =&gt; {"
                },
                {
                  "lineNumber": 79,
                  "content": "\t\t\tedges: ["
                },
                {
                  "lineNumber": 91,
                  "content": "\tit(\"returns empty array when node has no incoming edges\", () =&gt; {"
                },
                {
                  "lineNumber": 94,
                  "content": "\t\t\tedges: [],"
                },
                {
                  "lineNumber": 108,
                  "content": "\t\t\tedges: ["
                },
                {
                  "lineNumber": 118,
                  "content": "\t\t\tedges: [],"
                },
                {
                  "lineNumber": 128,
                  "content": "\t\t\tedges: [],"
                },
                {
                  "lineNumber": 133,
                  "content": "\t\tconst data: CanvasData = { nodes: [], edges: [] };"
                },
                {
                  "lineNumber": 142,
                  "content": "\t\tconst data: CanvasData = { nodes: [], edges: [] };"
                },
                {
                  "lineNumber": 153,
                  "content": "\t\t\tedges: [],"
                },
                {
                  "lineNumber": 160,
                  "content": "\t\t\tedges: [],"
                }
              ]
            },
            {
              "file": "src/canvas/types.ts",
              "matches": [
                {
                  "lineNumber": 52,
                  "content": "/** Get incoming edges for a node with parent id and variable name, sorted by parent y. */"
                },
                {
                  "lineNumber": 54,
                  "content": "\tconst edges = data.edges.filter((e) =&gt; e.toNode === nodeId);"
                },
                {
                  "lineNumber": 56,
                  "content": "\tconst withY = edges.map((e) =&gt; {"
                },
                {
                  "lineNumber": 72,
                  "content": "\tconst edges = data.edges.filter((e) =&gt; e.toNode === nodeId);"
                },
                {
                  "lineNumber": 73,
                  "content": "\tconst fromIds = [...new Set(edges.map((e) =&gt; e.fromNode))];"
                }
              ]
            },
            {
              "file": "src/engine/runner.ts",
              "matches": [
                {
                  "lineNumber": 31,
                  "content": "/** Get all root node ids (no incoming edges). */"
                },
                {
                  "lineNumber": 33,
                  "content": "\tconst hasIncoming = new Set(data.edges.map((e) =&gt; e.toNode));"
                },
                {
                  "lineNumber": 46,
                  "content": "\t\tfor (const e of data.edges) {"
                },
                {
                  "lineNumber": 61,
                  "content": "\t\tfor (const e of data.edges) {"
                },
                {
                  "lineNumber": 67,
                  "content": "\tfor (const e of data.edges) {"
                },
                {
                  "lineNumber": 81,
                  "content": "\t\tfor (const e of data.edges) {"
                },
                {
                  "lineNumber": 130,
                  "content": "/** Update edge labels to show inject vs concatenate, then refresh view (if setData) and save canvas. */"
                },
                {
                  "lineNumber": 140,
                  "content": "\tfor (const edge of data.edges) {"
                },
                {
                  "lineNumber": 154,
                  "content": "\tliveCanvas?.setData?.(data);"
                },
                {
                  "lineNumber": 223,
                  "content": "\tconst textNode = liveCanvas.createTextNode({"
                },
                {
                  "lineNumber": 230,
                  "content": "\tliveCanvas.addNode(textNode);"
                }
              ]
            },
            {
              "file": "src/engine/canvasApi.ts",
              "matches": [
                {
                  "lineNumber": 3,
                  "content": "\tcreateTextNode(options: {"
                },
                {
                  "lineNumber": 10,
                  "content": "\taddNode(node: unknown): void;"
                },
                {
                  "lineNumber": 15,
                  "content": "\tsetData?(data: unknown): void;"
                }
              ]
            },
            {
              "file": "src/canvas/nodes.ts",
              "matches": [
                {
                  "lineNumber": 19,
                  "content": "\t\tif (data &amp;&amp; Array.isArray(data.nodes) &amp;&amp; Array.isArray(data.edges)) return data;"
                }
              ]
            }
          ],
          "totalLines": 34,
          "totalMatchedLines": 34
        }
      }
    }
  }
}
```
Status: **completed**


</details>
</tool-use>

---


Checking how the runner gets fresh data after creating a node and how `updateEdgeLabelsAndSave` uses `setData`:


---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/engine/runner.ts</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/settings.ts</summary>

</details>
</tool-use>

---


Checking how `runSingleNode` passes `data` and whether it's reloaded after mutations:


---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/engine/runner.ts</summary>

</details>
</tool-use>

---


Creating the plan.


---

<tool-use data-tool-type="unknown" data-tool-name="create_plan">
<details>
<summary>Tool use: **create_plan**</summary>


Parameters:

```json
{
  "plan": "# Output edge and replace green node\n\n## Goal\n\n- When a node (e.g. blue Python) is run, its output appears in a **green note below it**, connected by an **edge labeled &#96;output&#96;**.\n- Re-running that node **replaces** the content of that same green note (no duplicate output notes).\n- **Run node** and **Run chain** treat &#96;output&#96; edges as **non-execution**: green notes are not \"children\" in the DAG (roots/parents/topological order ignore edges whose label is &#96;output&#96;).\n- The &#96;output&#96; label is a reserved marker, not a variable name (no &#96;{{var:output}}&#96; semantics).\n\n## Current behavior (relevant parts)\n\n- [runner.ts](src/engine/runner.ts): &#96;createGreenNode(liveCanvas, sourceNode, text)&#96; creates a green text node via **live canvas only** (createTextNode + addNode). The new node is **not** written into the in-memory &#96;data&#96;; only &#96;updateEdgeLabelsAndSave&#96; later saves &#96;data&#96;, so the green node is not persisted in the canvas file. Re-runs create another green node (duplicates).\n- [types.ts](src/canvas/types.ts): &#96;getIncomingEdgesWithLabels&#96; and &#96;getParentIdsSortedByY&#96; use **all** incoming edges. &#96;findOutputNodeForSource&#96; finds the green node by **position** (green, below source).\n- [runner.ts](src/engine/runner.ts): &#96;getRootIds&#96;, &#96;canReach&#96;, &#96;topologicalOrderToTarget&#96; use **all** edges; there is no notion of \"output-only\" edges.\n\n## Implementation plan\n\n### 1. Treat &#96;output&#96; as a reserved edge label (non-variable)\n\n**File: [src/canvas/types.ts](src/canvas/types.ts)**\n\n- Add constant: &#96;EDGE_LABEL_OUTPUT = \"output\"&#96;.\n- Add helper: &#96;isOutputEdge(edge: CanvasEdgeData): boolean&#96; — true when &#96;parseEdgeVariableName(edge.label) === EDGE_LABEL_OUTPUT&#96;.\n- In **&#96;getIncomingEdgesWithLabels&#96;**: filter out edges where &#96;isOutputEdge(edge)&#96; so execution context never sees \"output\" as a variable.\n- In **&#96;getParentIdsSortedByY&#96;**: same — only consider edges where &#96;!isOutputEdge(edge)&#96; so green notes are not execution parents.\n- In **&#96;findOutputNodeForSource&#96;**: first try to find an edge with &#96;e.fromNode === sourceNodeId&#96; and &#96;parseEdgeVariableName(e.label) === EDGE_LABEL_OUTPUT&#96;; if found, return &#96;e.toNode&#96;. Otherwise keep the existing position-based fallback (green, below source) for backwards compatibility.\n\nExport &#96;EDGE_LABEL_OUTPUT&#96; and &#96;isOutputEdge&#96; from types (and re-export from [nodes.ts](src/canvas/nodes.ts) if needed by runner).\n\n### 2. Execution graph ignores output edges\n\n**File: [src/engine/runner.ts](src/engine/runner.ts)**\n\n- **&#96;getRootIds&#96;**: build &#96;hasIncoming&#96; only from edges where &#96;!isOutputEdge(e)&#96; (nodes whose only incoming edge is &#96;output&#96; are effectively roots for execution).\n- **&#96;canReach&#96;**: when following edges, only traverse edges where &#96;!isOutputEdge(e)&#96;.\n- **&#96;topologicalOrderToTarget&#96;**: when collecting ancestors and computing in-degrees, only use edges where &#96;!isOutputEdge(e)&#96;.\n- **&#96;updateEdgeLabelsAndSave&#96;**: when updating edge labels to \"(injected)\" / \"(concatenated)\", **skip** edges where &#96;isOutputEdge(edge)&#96; so the label stays exactly &#96;output&#96;.\n\n### 3. Create-or-replace green node and add/keep output edge in canvas data\n\n**File: [src/engine/runner.ts](src/engine/runner.ts)**\n\n- Replace **&#96;createGreenNode(liveCanvas, sourceNode, text)&#96;** with **&#96;ensureOutputNodeAndEdge(data, sourceNode, text, settings)&#96;** that **only mutates &#96;data&#96;** (no liveCanvas for creation). Call it from &#96;runSingleNode&#96; for orange, purple, and blue (same places as current &#96;createGreenNode&#96;). Then the existing **&#96;updateEdgeLabelsAndSave&#96;** will persist the mutated &#96;data&#96; (setData + save).\n\n**&#96;ensureOutputNodeAndEdge&#96; logic:**\n\n- &#96;outId = findOutputNodeForSource(data, sourceNode.id, settings)&#96; (now edge-first, then position).\n- **If &#96;outId&#96; exists**: get the node in &#96;data.nodes&#96; by id; if it is a text node, set &#96;node.text = text&#96;. Ensure an edge from &#96;sourceNode.id&#96; to &#96;outId&#96; with label &#96;output&#96; exists in &#96;data.edges&#96; (if missing, push one with a new id).\n- **If no &#96;outId&#96;**: generate a new node id (e.g. &#96;crypto.randomUUID()&#96;). Append a new text node to &#96;data.nodes&#96;: &#96;{ id, type: \"text\", text, x: sourceNode.x, y: sourceNode.y + sourceNode.height + GREEN_NODE_PADDING, width, height, color: settings.colorGreen }&#96; (reuse existing width/height constants). Append a new edge to &#96;data.edges&#96;: &#96;{ id: new edge id, fromNode: sourceNode.id, toNode: id, label: EDGE_LABEL_OUTPUT }&#96; (required fields per [canvas.d.ts](node_modules/obsidian/canvas.d.ts): id, fromNode, toNode; set label to &#96;\"output\"&#96;).\n\nSo green node and output edge always live in **canvas data**; &#96;liveCanvas?.setData?.(data)&#96; in &#96;updateEdgeLabelsAndSave&#96; refreshes the view when available.\n\n### 4. Dismiss output: remove green node and output edge from data\n\n**File: [src/engine/runner.ts](src/engine/runner.ts)**\n\n- **&#96;dismissOutput&#96;** currently removes the green node from the **live** canvas only. Change it to: (1) load or receive current canvas &#96;data&#96;, (2) find output node id with &#96;findOutputNodeForSource(data, sourceNodeId, settings)&#96;, (3) remove that node from &#96;data.nodes&#96; and any edge with &#96;fromNode === sourceNodeId&#96; and label &#96;output&#96; from &#96;data.edges&#96;, (4) if &#96;liveCanvas&#96; exists call &#96;liveCanvas.setData(data)&#96; and &#96;requestSave&#96;, (5) call &#96;saveCanvasData(vault, canvasFilePath, data)&#96; so the file no longer contains the green node or the output edge. Signature may need &#96;vault&#96;, &#96;canvasFilePath&#96;, and &#96;data&#96; (e.g. load data inside dismissOutput or pass from main).\n\n### 5. Tests and docs\n\n- **Unit tests** ([src/canvas/types.test.ts](src/canvas/types.test.ts)): add cases for &#96;isOutputEdge&#96;; add cases for &#96;getIncomingEdgesWithLabels&#96; / &#96;getParentIdsSortedByY&#96; where an edge has label &#96;output&#96; and is excluded; add case for &#96;findOutputNodeForSource&#96; when an edge from source with label &#96;output&#96; exists (returns &#96;toNode&#96;).\n- **PRD/README**: document that the edge from a run node to its green output note is labeled &#96;output&#96;, that this is not a variable name, and that run node / run chain ignore output edges.\n\n## Data flow summary\n\n&#96;&#96;&#96;mermaid\nflowchart LR\n  subgraph exec [Execution graph]\n    A[Run node] --&gt;|variable edges| B[Child nodes]\n  end\n  subgraph output [Output only]\n    A --&gt;|\"label: output\"| G[Green note]\n  end\n&#96;&#96;&#96;\n\n- Run node / Run chain: only variable (non-output) edges define parents and traversal.\n- Each run creates or updates one green node per source and ensures one edge with label &#96;output&#96; from source to that green node; re-run replaces the green node’s text.\n\n## Files to change\n\n| File | Changes |\n|------|--------|\n| [src/canvas/types.ts](src/canvas/types.ts) | Add &#96;EDGE_LABEL_OUTPUT&#96;, &#96;isOutputEdge&#96;; filter output edges in &#96;getIncomingEdgesWithLabels&#96; and &#96;getParentIdsSortedByY&#96;; edge-first lookup in &#96;findOutputNodeForSource&#96;. |\n| [src/canvas/nodes.ts](src/canvas/nodes.ts) | Re-export &#96;EDGE_LABEL_OUTPUT&#96;, &#96;isOutputEdge&#96; if used by runner. |\n| [src/engine/runner.ts](src/engine/runner.ts) | Use &#96;isOutputEdge&#96; in &#96;getRootIds&#96;, &#96;canReach&#96;, &#96;topologicalOrderToTarget&#96;, &#96;updateEdgeLabelsAndSave&#96;; replace &#96;createGreenNode&#96; with &#96;ensureOutputNodeAndEdge(data, ...)&#96;; update &#96;dismissOutput&#96; to mutate data (remove node + output edge) and save. |\n| [src/main.ts](src/main.ts) | Pass &#96;vault&#96;, &#96;canvasFilePath&#96;, and possibly loaded &#96;data&#96; into &#96;dismissOutput&#96; so it can save after removing node/edge. |\n| [src/canvas/types.test.ts](src/canvas/types.test.ts) | Tests for output-edge exclusion and edge-based &#96;findOutputNodeForSource&#96;. |\n| PRD.md / README.md | Document &#96;output&#96; edge label and behavior. |\n\n## Edge cases\n\n- **No liveCanvas**: &#96;ensureOutputNodeAndEdge&#96; only mutates &#96;data&#96;; &#96;updateEdgeLabelsAndSave&#96; still calls &#96;saveCanvasData&#96;, so the canvas file gets the new/updated green node and edge. View updates when the user reopens the canvas.\n- **Existing green node without an output edge**: Position-based &#96;findOutputNodeForSource&#96; still finds it; we add the missing &#96;output&#96; edge in &#96;ensureOutputNodeAndEdge&#96; when updating.\n- **crypto.randomUUID()**: Use for new node and edge ids; available in modern browsers and Node. If the project targets an environment without it, use a simple fallback (e.g. &#96;\"output-\" + Date.now() + \"-\" + Math.random()&#96;).\n",
  "name": "Output edge and replace green node",
  "overview": "Add an explicit \"output\" edge from each run node to its green output note, treat output edges as non-execution (ignored by run node/run chain), and create-or-replace the green node via canvas data so re-runs update the same note and the edge is persisted."
}
```
Additional data:

```json
{
  "reviewData": {
    "status": "Requested",
    "selectedOption": "none",
    "isShowingInput": false
  },
  "planUri": "file:///Users/caffae/.cursor/plans/output_edge_and_replace_green_node_6ae55a7d.plan.md",
  "hasOpenedEditor": true
}
```
Result:

```json
{
  "rejected": {}
}
```
Status: **completed**


</details>
</tool-use>

---

_**User**_

Implement the plan as specified, it is attached for your reference. Do NOT edit the plan file itself.

To-do's from the plan have already been created. Do not create them again. Mark them as in_progress as you work, starting with the first one. Don't stop until you have completed all the to-dos.

---

_**Agent (model default, mode Agent)**_


Implementing the plan step by step. Checking current todos and opening the relevant files.


---

<tool-use data-tool-type="task" data-tool-name="todo_write">
<details><summary>Tool use: **todo_write** • Todo List</summary>

- [-] Treat output as reserved edge label in types.ts
- [ ] Execution graph ignores output edges in runner.ts
- [ ] ensureOutputNodeAndEdge + replace createGreenNode in runner.ts
- [ ] dismissOutput mutates data and saves; main.ts passes args
- [ ] Unit tests for output edge and findOutputNodeForSource
- [ ] Document output edge in PRD/README

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/canvas/types.ts</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/canvas/nodes.ts</summary>

</details>
</tool-use>

---





---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** • Edit file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/canvas/types.ts</summary>

</details>

</tool-use>

---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** • Edit file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/canvas/types.ts</summary>

</details>

</tool-use>

---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** • Edit file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/canvas/types.ts</summary>

</details>

</tool-use>

---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** • Edit file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/canvas/types.ts</summary>

</details>

</tool-use>

---





---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** • Edit file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/canvas/nodes.ts</summary>

</details>

</tool-use>

---

<tool-use data-tool-type="task" data-tool-name="todo_write">
<details><summary>Tool use: **todo_write** • Todo List</summary>

- [x] Treat output as reserved edge label in types.ts
- [-] Execution graph ignores output edges in runner.ts
- [ ] ensureOutputNodeAndEdge + replace createGreenNode in runner.ts
- [ ] dismissOutput mutates data and saves; main.ts passes args
- [ ] Unit tests for output edge and findOutputNodeForSource
- [ ] Document output edge in PRD/README

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/engine/runner.ts</summary>

</details>
</tool-use>

---


Implementing runner changes: adding imports and making execution graph ignore output edges.


---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** • Edit file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/engine/runner.ts</summary>

</details>

</tool-use>

---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** • Edit file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/engine/runner.ts</summary>

</details>

</tool-use>

---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** • Edit file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/engine/runner.ts</summary>

</details>

</tool-use>

---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** • Edit file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/engine/runner.ts</summary>

</details>

</tool-use>

---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** • Edit file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/engine/runner.ts</summary>

</details>

</tool-use>

---





---

<tool-use data-tool-type="task" data-tool-name="todo_write">
<details><summary>Tool use: **todo_write** • Todo List</summary>

- [x] Treat output as reserved edge label in types.ts
- [x] Execution graph ignores output edges in runner.ts
- [-] ensureOutputNodeAndEdge + replace createGreenNode in runner.ts
- [ ] dismissOutput mutates data and saves; main.ts passes args
- [ ] Unit tests for output edge and findOutputNodeForSource
- [ ] Document output edge in PRD/README

</details>
</tool-use>

---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** • Edit file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/engine/runner.ts</summary>

</details>

</tool-use>

---





---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** • Edit file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/engine/runner.ts</summary>

</details>

</tool-use>

---


Ensuring we persist data after ensureOutputNodeAndEdge. Checking updateEdgeLabelsAndSave: it only saves when variable edge labels change, so we'll always persist after it (so output node/edge changes are saved).


---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** • Edit file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/engine/runner.ts</summary>

</details>

</tool-use>

---





---

<tool-use data-tool-type="task" data-tool-name="todo_write">
<details><summary>Tool use: **todo_write** • Todo List</summary>

- [x] Treat output as reserved edge label in types.ts
- [x] Execution graph ignores output edges in runner.ts
- [x] ensureOutputNodeAndEdge + replace createGreenNode in runner.ts
- [-] dismissOutput mutates data and saves; main.ts passes args
- [ ] Unit tests for output edge and findOutputNodeForSource
- [ ] Document output edge in PRD/README

</details>
</tool-use>

---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** • Edit file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/engine/runner.ts</summary>

</details>

</tool-use>

---





---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/main.ts</summary>

</details>
</tool-use>

---





---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** • Edit file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/main.ts</summary>

</details>

</tool-use>

---





---

<tool-use data-tool-type="unknown" data-tool-name="ripgrep_raw_search">
<details>
<summary>Tool use: **ripgrep_raw_search**</summary>


Parameters:

```json
{
  "pattern": "loadCanvasData",
  "path": "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/main.ts",
  "caseInsensitive": false
}
```
Result:

```json
{
  "success": {
    "pattern": "loadCanvasData",
    "path": "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/main.ts",
    "outputMode": "content",
    "workspaceResults": {
      "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board": {
        "content": {
          "matches": [
            {
              "file": "src/main.ts",
              "matches": [
                {
                  "lineNumber": 6,
                  "content": "import {loadCanvasData} from \"./canvas/nodes\";"
                }
              ]
            }
          ],
          "totalLines": 1,
          "totalMatchedLines": 1
        }
      }
    }
  }
}
```
Status: **completed**


</details>
</tool-use>

---





---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** • Edit file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/main.ts</summary>

</details>

</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="read_lints">
<details>
<summary>Tool use: **read_lints**</summary>


Parameters:

```json
{
  "paths": [
    "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/engine/runner.ts",
    "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/main.ts",
    "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/canvas/types.ts"
  ]
}
```
Result:

```json
{
  "linterErrorsByFile": [
    {
      "relativeWorkspacePath": "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/engine/runner.ts"
    },
    {
      "relativeWorkspacePath": "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/main.ts"
    },
    {
      "relativeWorkspacePath": "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/canvas/types.ts"
    }
  ]
}
```
Status: **completed**


</details>
</tool-use>

---





---

<tool-use data-tool-type="task" data-tool-name="todo_write">
<details><summary>Tool use: **todo_write** • Todo List</summary>

- [x] Treat output as reserved edge label in types.ts
- [x] Execution graph ignores output edges in runner.ts
- [x] ensureOutputNodeAndEdge + replace createGreenNode in runner.ts
- [x] dismissOutput mutates data and saves; main.ts passes args
- [-] Unit tests for output edge and findOutputNodeForSource
- [ ] Document output edge in PRD/README

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/canvas/types.test.ts</summary>

</details>
</tool-use>

---





---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** • Edit file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/canvas/types.test.ts</summary>

</details>

</tool-use>

---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** • Edit file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/canvas/types.test.ts</summary>

</details>

</tool-use>

---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** • Edit file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/canvas/types.test.ts</summary>

</details>

</tool-use>

---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** • Edit file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/canvas/types.test.ts</summary>

</details>

</tool-use>

---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** • Edit file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/canvas/types.test.ts</summary>

</details>

</tool-use>

---





---

<tool-use data-tool-type="shell" data-tool-name="run_terminal_command_v2">
<details><summary>Tool use: **run_terminal_command_v2** • Run command: cd /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board && npm run test -- --run src/canvas/types.test.ts</summary>

```bash
cd /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board && npm run test -- --run src/canvas/types.test.ts
```

```

&gt; zettel-thinking-board@1.0.0 test
&gt; vitest run --run src/canvas/types.test.ts


 RUN  v1.6.1 /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board

 ✓ src/canvas/types.test.ts  (27 tests) 5ms

 Test Files  1 passed (1)
      Tests  27 passed (27)
   Start at  15:23:56
   Duration  265ms (transform 45ms, setup 0ms, collect 45ms, tests 5ms, environment 0ms, prepare 51ms)


```
</details>
</tool-use>

---





---

<tool-use data-tool-type="task" data-tool-name="todo_write">
<details><summary>Tool use: **todo_write** • Todo List</summary>

- [x] Treat output as reserved edge label in types.ts
- [x] Execution graph ignores output edges in runner.ts
- [x] ensureOutputNodeAndEdge + replace createGreenNode in runner.ts
- [x] dismissOutput mutates data and saves; main.ts passes args
- [x] Unit tests for output edge and findOutputNodeForSource
- [-] Document output edge in PRD/README

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/PRD.md</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/README.md</summary>

</details>
</tool-use>

---





---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** • Edit file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/PRD.md</summary>

</details>

</tool-use>

---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** • Edit file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/PRD.md</summary>

</details>

</tool-use>

---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** • Edit file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/README.md</summary>

</details>

</tool-use>

---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** • Edit file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/README.md</summary>

</details>

</tool-use>

---





---

<tool-use data-tool-type="shell" data-tool-name="run_terminal_command_v2">
<details><summary>Tool use: **run_terminal_command_v2** • Run command: cd /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board && npm run build</summary>

```bash
cd /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board && npm run build
```

```

&gt; zettel-thinking-board@1.0.0 build
&gt; tsc -noEmit -skipLibCheck &amp;&amp; node esbuild.config.mjs production

src/main.ts(174,6): error TS2322: Type 'Timer' is not assignable to type 'number'.

```
</details>
</tool-use>

---





---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/main.ts</summary>

</details>
</tool-use>

---


Build error is pre-existing (setInterval return type). Verifying our changes don't introduce issues:


---

<tool-use data-tool-type="shell" data-tool-name="run_terminal_command_v2">
<details><summary>Tool use: **run_terminal_command_v2** • Run command: cd /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board && npm run test -- --run</summary>

```bash
cd /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board && npm run test -- --run
```

```

&gt; zettel-thinking-board@1.0.0 test
&gt; vitest run --run


 RUN  v1.6.1 /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board

 ✓ src/engine/state.test.ts  (6 tests) 2ms
 ✓ src/canvas/types.test.ts  (27 tests) 6ms

 Test Files  2 passed (2)
      Tests  33 passed (33)
   Start at  15:24:36
   Duration  273ms (transform 65ms, setup 0ms, collect 83ms, tests 8ms, environment 0ms, prepare 132ms)


```
</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="read_lints">
<details>
<summary>Tool use: **read_lints**</summary>


Parameters:

```json
{
  "paths": [
    "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/engine/runner.ts",
    "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/canvas/types.ts",
    "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/canvas/nodes.ts"
  ]
}
```
Result:

```json
{
  "linterErrorsByFile": [
    {
      "relativeWorkspacePath": "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/engine/runner.ts"
    },
    {
      "relativeWorkspacePath": "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/canvas/types.ts"
    },
    {
      "relativeWorkspacePath": "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/canvas/nodes.ts"
    }
  ]
}
```
Status: **completed**


</details>
</tool-use>

---





---

<tool-use data-tool-type="task" data-tool-name="todo_write">
<details><summary>Tool use: **todo_write** • Todo List</summary>

- [x] Treat output as reserved edge label in types.ts
- [x] Execution graph ignores output edges in runner.ts
- [x] ensureOutputNodeAndEdge + replace createGreenNode in runner.ts
- [x] dismissOutput mutates data and saves; main.ts passes args
- [x] Unit tests for output edge and findOutputNodeForSource
- [x] Document output edge in PRD/README

</details>
</tool-use>

---


Fixing the pre-existing build error so the project builds.


---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** • Edit file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/main.ts</summary>

</details>

</tool-use>

---





---

<tool-use data-tool-type="unknown" data-tool-name="ripgrep_raw_search">
<details>
<summary>Tool use: **ripgrep_raw_search**</summary>


Parameters:

```json
{
  "pattern": "_roleLabelsIntervalId|clearInterval",
  "path": "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/main.ts",
  "caseInsensitive": false
}
```
Result:

```json
{
  "success": {
    "pattern": "_roleLabelsIntervalId|clearInterval",
    "path": "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/main.ts",
    "outputMode": "content",
    "workspaceResults": {
      "/Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board": {
        "content": {
          "matches": [
            {
              "file": "src/main.ts",
              "matches": [
                {
                  "lineNumber": 152,
                  "content": "\t\t\t\t\t\tclearInterval(roleLabelsIntervalId);"
                },
                {
                  "lineNumber": 154,
                  "content": "\t\t\t\t\t\tdelete (this as unknown as Record&lt;string, unknown&gt;)._roleLabelsIntervalId;"
                },
                {
                  "lineNumber": 174,
                  "content": "\t\t\t\t\t(this as unknown as { _roleLabelsIntervalId: ReturnType&lt;typeof setInterval&gt; })._roleLabelsIntervalId = roleLabelsIntervalId;"
                },
                {
                  "lineNumber": 187,
                  "content": "\t\tconst id = (this as unknown as { _roleLabelsIntervalId?: number })._roleLabelsIntervalId;"
                },
                {
                  "lineNumber": 188,
                  "content": "\t\tif (id != null) clearInterval(id);"
                }
              ]
            }
          ],
          "totalLines": 5,
          "totalMatchedLines": 5
        }
      }
    }
  }
}
```
Status: **completed**


</details>
</tool-use>

---





---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** • Edit file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/main.ts</summary>

</details>

</tool-use>

---

<tool-use data-tool-type="shell" data-tool-name="run_terminal_command_v2">
<details><summary>Tool use: **run_terminal_command_v2** • Run command: cd /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board && npm run build</summary>

```bash
cd /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board && npm run build
```

```

&gt; zettel-thinking-board@1.0.0 build
&gt; tsc -noEmit -skipLibCheck &amp;&amp; node esbuild.config.mjs production

src/main.ts(168,6): error TS2322: Type 'number' is not assignable to type 'Timer'.
src/main.ts(174,6): error TS2322: Type 'Timer | null' is not assignable to type 'Timer'.
  Type 'null' is not assignable to type 'Timer'.

```
</details>
</tool-use>

---





---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/main.ts</summary>

</details>
</tool-use>

---


Reverting the interval type changes so we only keep the dismissOutput changes. The build failure appears pre-existing.


---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** • Edit file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/main.ts</summary>

</details>

</tool-use>

---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** • Edit file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/main.ts</summary>

</details>

</tool-use>

---





---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** • Edit file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/main.ts</summary>

</details>

</tool-use>

---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** • Edit file: /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board/src/main.ts</summary>

</details>

</tool-use>

---

<tool-use data-tool-type="shell" data-tool-name="run_terminal_command_v2">
<details><summary>Tool use: **run_terminal_command_v2** • Run command: cd /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board && npm run build</summary>

```bash
cd /Users/caffae/Notes/TestPlugin/.obsidian/plugins/Zettel-Thinking-Board && npm run build
```

```

&gt; zettel-thinking-board@1.0.0 build
&gt; tsc -noEmit -skipLibCheck &amp;&amp; node esbuild.config.mjs production


```
</details>
</tool-use>

---


Summary of what was implemented:

## 1. **Reserved `output` edge label** ([src/canvas/types.ts](src/canvas/types.ts))
- Added `EDGE_LABEL_OUTPUT = "output"` and `isOutputEdge(edge)`.
- `getIncomingEdgesWithLabels` and `getParentIdsSortedByY` exclude edges where `isOutputEdge(edge)`.
- `findOutputNodeForSource` first looks for an edge from the source with label `output` and returns its `toNode`; otherwise uses the existing position-based fallback.

## 2. **Execution graph ignores output edges** ([src/engine/runner.ts](src/engine/runner.ts))
- `getRootIds`: `hasIncoming` built only from edges where `!isOutputEdge(e)`.
- `canReach` and `topologicalOrderToTarget`: only traverse non-output edges.
- `updateEdgeLabelsAndSave`: skips edges where `isOutputEdge(edge)` so the label stays `"output"`. Always persists (setData + save) so output node/edge changes are saved.

## 3. **Create-or-replace green node and output edge** ([src/engine/runner.ts](src/engine/runner.ts))
- Replaced `createGreenNode(liveCanvas, ...)` with `ensureOutputNodeAndEdge(data, sourceNode, text, settings)` that only mutates `data`.
- If an output node exists (by edge or position): update its text and ensure an edge from source with label `output`; if missing, add that edge.
- If none exists: add a new text node and an edge from source with label `output`. IDs from `randomId()` (crypto.randomUUID or fallback).
- Orange, purple, and blue branches call `ensureOutputNodeAndEdge` then `updateEdgeLabelsAndSave` so the canvas file and view stay in sync.

## 4. **Dismiss output** ([src/engine/runner.ts](src/engine/runner.ts), [src/main.ts](src/main.ts))
- `dismissOutput` is now async and takes `(vault, canvasFilePath, sourceNodeId, settings, liveCanvas)`. It loads canvas data, removes the output node from `data.nodes` and the output edge from `data.edges`, then calls setData and `saveCanvasData`.
- `main.ts` calls `await runnerDismissOutput(this.app.vault, view.file.path, nodeId, this.settings, liveCanvas)` and no longer uses `loadCanvasData` for dismiss.

## 5. **Tests** ([src/canvas/types.test.ts](src/canvas/types.test.ts))
- `isOutputEdge`: true for label `output` (and trimmed), false for variable labels and empty/undefined.
- `getIncomingEdgesWithLabels`: excludes edges with label `output`.
- `getParentIdsSortedByY`: excludes edges with label `output` (e.g. `getParentIdsSortedByY("out", data)` returns `[]` when the only incoming edge is `output`).
- `findOutputNodeForSource`: returns `toNode` when an edge from source has label `output`.

## 6. **Docs** ([PRD.md](PRD.md), [README.md](README.md))
- PRD: Green node is connected by an edge labeled `output`; re-run replaces content; Run Node / Run Chain ignore `output` edges.
- README: Green note is created/updated and linked by an `output` edge; `output` is reserved and not a variable name.

## 7. **Re-exports and build**
- [src/canvas/nodes.ts](src/canvas/nodes.ts) re-exports `EDGE_LABEL_OUTPUT` and `isOutputEdge`.
- Fixed a pre-existing main.ts type (interval id as `number`) so `npm run build` succeeds.

All 33 unit tests pass and the project builds successfully.

---

